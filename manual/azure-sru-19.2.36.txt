# Manually deploy on Azure using Azure CLI client.
# Validate upgrade to proposed version of cloud-init
# Check Tracebacks or error conditions on clean boot
 
# To be adapted to the SRU to test
SRU_SERIES="xenial bionic disco"

# local values
# find region with az account list-locations -o table
REGION="eastus2"
VNET_NAME="sruVnet"
NETWORK_SECURITY_GROUP="sruNetSecGroup"
NIC_NAME="sruNic"
RESOURCE_GROUP="srugroup1"
BOOT_DIAG=""
SSH_KEY="$HOME/.ssh/id_rsa.pub"

cat > sethostname.yaml <<EOF
## template: jinja
#cloud-config
ssh_import_id : [chad.smith]
hostname: SRU-worked-{{v1.cloud_name}}
EOF

cat > setup_proposed.sh <<EOF
#/bin/bash
mirror=http://archive.ubuntu.com/ubuntu
echo deb \$mirror \$(lsb_release -sc)-proposed main | tee /etc/apt/sources.list.d/proposed.list
apt-get update -q
apt-get install -qy cloud-init
EOF

if [ -n "${BOOT_DIAG}" ]; then
    BOOT_DIAG="--boot-diagnostics-storage ${BOOT_DIAG}"
else:
    BOOT_DIAG=""
fi


az group create --name $RESOURCE_GROUP --location $REGION
az network vnet create \
    --resource-group $RESOURCE_GROUP \
    --name $VNET_NAME \
    --address-prefix 192.168.0.0/16 \
    --subnet-name sruSubnet \
    --subnet-prefix 192.168.1.0/24

az network nsg create \
    --resource-group $RESOURCE_GROUP \
    --name $NETWORK_SECURITY_GROUP

az network nsg rule create \
  --resource-group $RESOURCE_GROUP \
  --nsg-name $NETWORK_SECURITY_GROUP \
  --name Allow-SSH-Internet \
  --access Allow \
  --protocol Tcp \
  --direction Inbound \
  --priority 100 \
  --source-address-prefix Internet \
  --source-port-range "*" \
  --destination-address-prefix "*" \
  --destination-port-range 22


sshopts=( -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o LogLevel=ERROR )
for series in $SRU_SERIES; do
    echo "### BEGIN $SERIES"
    netcfg="/etc/netplan/50-cloud-init.yaml"
    case $series in
        xenial) image_version=16.04-DAILY-LTS
                netcfg="/etc/network/interfaces.d/50-cloud-init.cfg";;
        bionic) image_version=18.04-DAILY-LTS;;
        disco) image_version=19.04-DAILY;;
        *) echo "!! UPDATE FAMILY CASE STATEMENT !!"; exit 1;;
    esac
    # Note: accelerated network requires bigger size than our default DS1
    for nics in "" "--nics $NIC_NAME-$series --size Standard_DS2_v2"; do
        if [ "" = "$nics" ]; then
	    echo "Creating standard network vm"
	    name=test-sru-$series
        else
	    echo "Creating advanced network vm"
	    name=test-sru-$series-advanced
            az network public-ip create \
                --name sruPublicIp-$series \
                --resource-group $RESOURCE_GROUP

            az network nic create \
                --resource-group $RESOURCE_GROUP \
                --name $NIC_NAME-$series \
                --vnet-name $VNET_NAME \
                --subnet sruSubnet \
                --accelerated-networking true \
                --public-ip-address sruPublicIp-$series \
                --network-security-group $NETWORK_SECURITY_GROUP
        fi
	az vm create --name=$name \
	    --image=Canonical:UbuntuServer:$image_version:latest \
	    --admin-username=root --admin-username=ubuntu \
	    -g $RESOURCE_GROUP --ssh-key-value $SSH_KEY \
	    $BOOT_DIAG \
	    --custom-data sethostname.yaml $nics
	IP=$(az vm list-ip-addresses --name $name | jq -r '.[] | .virtualMachine.network.publicIpAddresses[].ipAddress'| awk '{printf "ubuntu@%s", $1}')

	ssh "${sshopts[@]}" $IP -- cloud-init status --wait --long
	ssh "${sshopts[@]}" $IP -- dpkg-query --show cloud-init
	ssh "${sshopts[@]}" $IP -- sudo cat /run/cloud-init/result.json
	ssh "${sshopts[@]}" $IP -- grep Trace /var/log/cloud-init.log
	ssh "${sshopts[@]}" $IP -- systemd-analyze
	ssh "${sshopts[@]}" $IP -- systemd-analyze blame
	ssh "${sshopts[@]}" $IP -- cloud-init analyze show
	ssh "${sshopts[@]}" $IP -- cloud-init analyze blame
	echo 'Networking config'
	ssh "${sshopts[@]}" $IP -- cat $netcfg

	scp "${sshopts[@]}" setup_proposed.sh $IP:.
	ssh "${sshopts[@]}" $IP -- sudo bash ./setup_proposed.sh 2>&1 | egrep 'cloud-init'
	ssh "${sshopts[@]}" $IP -- dpkg-query --show cloud-init
	ssh "${sshopts[@]}" $IP -- sudo hostname SRU-didnt-work
	ssh "${sshopts[@]}" $IP -- sudo rm -f $netcfg
	ssh "${sshopts[@]}" $IP -- sudo cloud-init clean --logs --reboot

	sleep 60

	ssh "${sshopts[@]}" $IP -- cloud-init status --wait --long
	ssh "${sshopts[@]}" $IP -- grep Trace /var/log/cloud-init\*
	ssh "${sshopts[@]}" $IP -- sudo cat /run/cloud-init/result.json
	ssh "${sshopts[@]}" $IP -- sudo systemd-analyze blame
	ssh "${sshopts[@]}" $IP -- cloud-init analyze show
	ssh "${sshopts[@]}" $IP -- cloud-init analyze blame
	echo 'After upgrade Networking config'
        ssh "${sshopts[@]}" $IP -- cat $netcfg
        ssh "${sshopts[@]}" $IP -- cloud-init query --format "'cloud-region: {{cloud_name}}-{{region}}'"
        echo 'Get cloud-id'
        ssh "${sshopts[@]}" $IP -- cloud-id
        ssh "${sshopts[@]}" $IP -- cloud-init query --format "'cloud-region: {{cloud_name}}-{{ds.meta_data.imds.compute.location}}'"
        echo 'Validating whether metadata is being updated per boot LP:1819913'
        ssh "${sshopts[@]}" $IP -- "grep 'Update datasource' /var/log/cloud-init.log"
        ssh "${sshopts[@]}" $IP -- sudo reboot || true
        sleep 30
	ssh "${sshopts[@]}" $IP -- cloud-init status --wait --long
        echo 'After reboot'
        ssh "${sshopts[@]}" $IP -- "grep 'Update datasource' /var/log/cloud-init.log"
    done
    echo "### END $series"
done


=== BEGIN SRU Validation ===
{
  "id": "/subscriptions/12aad61c-6de4-4e53-a6c6-5aff52a83777/resourceGroups/srugroup1",
  "location": "eastus2",
  "managedBy": null,
  "name": "srugroup1",
  "properties": {
    "provisioningState": "Succeeded"
  },
  "tags": null
}
{
  "newVNet": {
    "addressSpace": {
      "addressPrefixes": [
        "192.168.0.0/16"
      ]
    },
    "ddosProtectionPlan": null,
    "dhcpOptions": {
      "dnsServers": []
    },
    "enableDdosProtection": false,
    "enableVmProtection": false,
    "etag": "W/\"7c479499-aaec-4167-acac-80307b6c55e5\"",
    "id": "/subscriptions/12aad61c-6de4-4e53-a6c6-5aff52a83777/resourceGroups/srugroup1/providers/Microsoft.Network/virtualNetworks/sruVnet",
    "location": "eastus2",
    "name": "sruVnet",
    "provisioningState": "Succeeded",
    "resourceGroup": "srugroup1",
    "resourceGuid": "5d533861-33b8-4ac1-8716-deb6b58cb992",
    "subnets": [
      {
        "addressPrefix": "192.168.1.0/24",
        "etag": "W/\"7c479499-aaec-4167-acac-80307b6c55e5\"",
        "id": "/subscriptions/12aad61c-6de4-4e53-a6c6-5aff52a83777/resourceGroups/srugroup1/providers/Microsoft.Network/virtualNetworks/sruVnet/subnets/sruSubnet",
        "ipConfigurations": null,
        "name": "sruSubnet",
        "networkSecurityGroup": null,
        "provisioningState": "Succeeded",
        "resourceGroup": "srugroup1",
        "resourceNavigationLinks": null,
        "routeTable": null,
        "serviceEndpoints": null,
        "type": "Microsoft.Network/virtualNetworks/subnets"
      }
    ],
    "tags": {},
    "type": "Microsoft.Network/virtualNetworks",
    "virtualNetworkPeerings": []
  }
}
{
  "NewNSG": {
    "defaultSecurityRules": [
      {
        "access": "Allow",
        "description": "Allow inbound traffic from all VMs in VNET",
        "destinationAddressPrefix": "VirtualNetwork",
        "destinationAddressPrefixes": [],
        "destinationApplicationSecurityGroups": null,
        "destinationPortRange": "*",
        "destinationPortRanges": [],
        "direction": "Inbound",
        "etag": "W/\"fba4aa18-9cfc-47dd-b11a-ff6f728b4119\"",
        "id": "/subscriptions/12aad61c-6de4-4e53-a6c6-5aff52a83777/resourceGroups/srugroup1/providers/Microsoft.Network/networkSecurityGroups/sruNetSecGroup/defaultSecurityRules/AllowVnetInBound",
        "name": "AllowVnetInBound",
        "priority": 65000,
        "protocol": "*",
        "provisioningState": "Succeeded",
        "resourceGroup": "srugroup1",
        "sourceAddressPrefix": "VirtualNetwork",
        "sourceAddressPrefixes": [],
        "sourceApplicationSecurityGroups": null,
        "sourcePortRange": "*",
        "sourcePortRanges": [],
        "type": "Microsoft.Network/networkSecurityGroups/defaultSecurityRules"
      },
      {
        "access": "Allow",
        "description": "Allow inbound traffic from azure load balancer",
        "destinationAddressPrefix": "*",
        "destinationAddressPrefixes": [],
        "destinationApplicationSecurityGroups": null,
        "destinationPortRange": "*",
        "destinationPortRanges": [],
        "direction": "Inbound",
        "etag": "W/\"fba4aa18-9cfc-47dd-b11a-ff6f728b4119\"",
        "id": "/subscriptions/12aad61c-6de4-4e53-a6c6-5aff52a83777/resourceGroups/srugroup1/providers/Microsoft.Network/networkSecurityGroups/sruNetSecGroup/defaultSecurityRules/AllowAzureLoadBalancerInBound",
        "name": "AllowAzureLoadBalancerInBound",
        "priority": 65001,
        "protocol": "*",
        "provisioningState": "Succeeded",
        "resourceGroup": "srugroup1",
        "sourceAddressPrefix": "AzureLoadBalancer",
        "sourceAddressPrefixes": [],
        "sourceApplicationSecurityGroups": null,
        "sourcePortRange": "*",
        "sourcePortRanges": [],
        "type": "Microsoft.Network/networkSecurityGroups/defaultSecurityRules"
      },
      {
        "access": "Deny",
        "description": "Deny all inbound traffic",
        "destinationAddressPrefix": "*",
        "destinationAddressPrefixes": [],
        "destinationApplicationSecurityGroups": null,
        "destinationPortRange": "*",
        "destinationPortRanges": [],
        "direction": "Inbound",
        "etag": "W/\"fba4aa18-9cfc-47dd-b11a-ff6f728b4119\"",
        "id": "/subscriptions/12aad61c-6de4-4e53-a6c6-5aff52a83777/resourceGroups/srugroup1/providers/Microsoft.Network/networkSecurityGroups/sruNetSecGroup/defaultSecurityRules/DenyAllInBound",
        "name": "DenyAllInBound",
        "priority": 65500,
        "protocol": "*",
        "provisioningState": "Succeeded",
        "resourceGroup": "srugroup1",
        "sourceAddressPrefix": "*",
        "sourceAddressPrefixes": [],
        "sourceApplicationSecurityGroups": null,
        "sourcePortRange": "*",
        "sourcePortRanges": [],
        "type": "Microsoft.Network/networkSecurityGroups/defaultSecurityRules"
      },
      {
        "access": "Allow",
        "description": "Allow outbound traffic from all VMs to all VMs in VNET",
        "destinationAddressPrefix": "VirtualNetwork",
        "destinationAddressPrefixes": [],
        "destinationApplicationSecurityGroups": null,
        "destinationPortRange": "*",
        "destinationPortRanges": [],
        "direction": "Outbound",
        "etag": "W/\"fba4aa18-9cfc-47dd-b11a-ff6f728b4119\"",
        "id": "/subscriptions/12aad61c-6de4-4e53-a6c6-5aff52a83777/resourceGroups/srugroup1/providers/Microsoft.Network/networkSecurityGroups/sruNetSecGroup/defaultSecurityRules/AllowVnetOutBound",
        "name": "AllowVnetOutBound",
        "priority": 65000,
        "protocol": "*",
        "provisioningState": "Succeeded",
        "resourceGroup": "srugroup1",
        "sourceAddressPrefix": "VirtualNetwork",
        "sourceAddressPrefixes": [],
        "sourceApplicationSecurityGroups": null,
        "sourcePortRange": "*",
        "sourcePortRanges": [],
        "type": "Microsoft.Network/networkSecurityGroups/defaultSecurityRules"
      },
      {
        "access": "Allow",
        "description": "Allow outbound traffic from all VMs to Internet",
        "destinationAddressPrefix": "Internet",
        "destinationAddressPrefixes": [],
        "destinationApplicationSecurityGroups": null,
        "destinationPortRange": "*",
        "destinationPortRanges": [],
        "direction": "Outbound",
        "etag": "W/\"fba4aa18-9cfc-47dd-b11a-ff6f728b4119\"",
        "id": "/subscriptions/12aad61c-6de4-4e53-a6c6-5aff52a83777/resourceGroups/srugroup1/providers/Microsoft.Network/networkSecurityGroups/sruNetSecGroup/defaultSecurityRules/AllowInternetOutBound",
        "name": "AllowInternetOutBound",
        "priority": 65001,
        "protocol": "*",
        "provisioningState": "Succeeded",
        "resourceGroup": "srugroup1",
        "sourceAddressPrefix": "*",
        "sourceAddressPrefixes": [],
        "sourceApplicationSecurityGroups": null,
        "sourcePortRange": "*",
        "sourcePortRanges": [],
        "type": "Microsoft.Network/networkSecurityGroups/defaultSecurityRules"
      },
      {
        "access": "Deny",
        "description": "Deny all outbound traffic",
        "destinationAddressPrefix": "*",
        "destinationAddressPrefixes": [],
        "destinationApplicationSecurityGroups": null,
        "destinationPortRange": "*",
        "destinationPortRanges": [],
        "direction": "Outbound",
        "etag": "W/\"fba4aa18-9cfc-47dd-b11a-ff6f728b4119\"",
        "id": "/subscriptions/12aad61c-6de4-4e53-a6c6-5aff52a83777/resourceGroups/srugroup1/providers/Microsoft.Network/networkSecurityGroups/sruNetSecGroup/defaultSecurityRules/DenyAllOutBound",
        "name": "DenyAllOutBound",
        "priority": 65500,
        "protocol": "*",
        "provisioningState": "Succeeded",
        "resourceGroup": "srugroup1",
        "sourceAddressPrefix": "*",
        "sourceAddressPrefixes": [],
        "sourceApplicationSecurityGroups": null,
        "sourcePortRange": "*",
        "sourcePortRanges": [],
        "type": "Microsoft.Network/networkSecurityGroups/defaultSecurityRules"
      }
    ],
    "etag": "W/\"fba4aa18-9cfc-47dd-b11a-ff6f728b4119\"",
    "id": "/subscriptions/12aad61c-6de4-4e53-a6c6-5aff52a83777/resourceGroups/srugroup1/providers/Microsoft.Network/networkSecurityGroups/sruNetSecGroup",
    "location": "eastus2",
    "name": "sruNetSecGroup",
    "networkInterfaces": null,
    "provisioningState": "Succeeded",
    "resourceGroup": "srugroup1",
    "resourceGuid": "14f2d1b6-4698-4943-b8b2-5e8346533c86",
    "securityRules": [],
    "subnets": null,
    "tags": null,
    "type": "Microsoft.Network/networkSecurityGroups"
  }
}
{
  "access": "Allow",
  "description": null,
  "destinationAddressPrefix": "*",
  "destinationAddressPrefixes": [],
  "destinationApplicationSecurityGroups": null,
  "destinationPortRange": "22",
  "destinationPortRanges": [],
  "direction": "Inbound",
  "etag": "W/\"bd0dd86e-bed4-4232-b9b0-9d9b76554322\"",
  "id": "/subscriptions/12aad61c-6de4-4e53-a6c6-5aff52a83777/resourceGroups/srugroup1/providers/Microsoft.Network/networkSecurityGroups/sruNetSecGroup/securityRules/Allow-SSH-Internet",
  "name": "Allow-SSH-Internet",
  "priority": 100,
  "protocol": "Tcp",
  "provisioningState": "Succeeded",
  "resourceGroup": "srugroup1",
  "sourceAddressPrefix": "Internet",
  "sourceAddressPrefixes": [],
  "sourceApplicationSecurityGroups": null,
  "sourcePortRange": "*",
  "sourcePortRanges": [],
  "type": "Microsoft.Network/networkSecurityGroups/securityRules"
}
### BEGIN 
Creating standard network vm
{
  "fqdns": "",
  "id": "/subscriptions/12aad61c-6de4-4e53-a6c6-5aff52a83777/resourceGroups/srugroup1/providers/Microsoft.Compute/virtualMachines/test-sru-xenial",
  "location": "eastus2",
  "macAddress": "00-0D-3A-7C-52-85",
  "powerState": "VM running",
  "privateIpAddress": "192.168.1.4",
  "publicIpAddress": "40.79.71.93",
  "resourceGroup": "srugroup1",
  "zones": ""
}

status: done
time: Thu, 19 Sep 2019 12:07:31 +0000
detail:
DataSourceAzure [seed=/dev/sr0]
cloud-init	19.1-1-gbaa47854-0ubuntu1~16.04.1
sudo: unable to resolve host SRU-worked-azure
{
 "v1": {
  "datasource": "DataSourceAzure [seed=/dev/sr0]",
  "errors": []
 }
}
Startup finished in 4.896s (kernel) + 2h 6min 4.878s (userspace) = 2h 6min 9.774s
 2h 5min 41.282s cloud-init-local.service
          8.189s cloud-init.service
          6.561s snapd.service
          5.549s lxd-containers.service
          4.623s pollinate.service
          3.662s cloud-config.service
          3.065s accounts-daemon.service
          2.390s apparmor.service
          2.335s dev-sda1.device
          2.130s console-setup.service
          2.111s snapd.seeded.service
          1.683s grub-common.service
          1.479s systemd-tmpfiles-clean.service
          1.309s rsyslog.service
          1.124s ssh.service
          1.087s open-iscsi.service
          1.074s iscsid.service
          1.030s mdadm.service
           936ms systemd-logind.service
           720ms cloud-final.service
           646ms networking.service
           406ms lvm2-monitor.service
           287ms apport.service
           275ms irqbalance.service
           273ms polkitd.service
           245ms systemd-udev-trigger.service
           237ms systemd-modules-load.service
           232ms resolvconf.service
           231ms systemd-journald.service
           189ms keyboard-setup.service
           188ms systemd-remount-fs.service
           173ms systemd-journal-flush.service
           167ms dev-hugepages.mount
           159ms ufw.service
           158ms kmod-static-nodes.service
           157ms systemd-user-sessions.service
           149ms systemd-udevd.service
           144ms systemd-tmpfiles-setup-dev.service
            97ms systemd-sysctl.service
            87ms rc-local.service
            86ms setvtrgb.service
            79ms sys-kernel-config.mount
            77ms dev-mqueue.mount
            75ms lxd.socket
            73ms systemd-timesyncd.service
            67ms systemd-machine-id-commit.service
            67ms sys-fs-fuse-connections.mount
            65ms systemd-random-seed.service
            62ms plymouth-read-write.service
            59ms snapd.socket
            53ms systemd-update-utmp.service
            44ms systemd-tmpfiles-setup.service
            44ms user@1000.service
            39ms ondemand.service
            25ms plymouth-quit.service
            24ms plymouth-quit-wait.service
            21ms ephemeral-disk-warning.service
            15ms systemd-update-utmp-runlevel.service
             9ms sys-kernel-debug.mount
-- Boot Record 01 --
The total time elapsed since completing an event is printed after the "@" character.
The time the event takes is printed after the "+" character.

Starting stage: init-local
|`->no cache found @00.00500s +00.00100s
|`->no local data found from DataSourceNoCloud @00.19800s +00.06300s
|`->no local data found from DataSourceConfigDrive @00.26100s +00.01900s
|`->no local data found from DataSourceOpenNebula @00.28000s +00.00900s
|`->no local data found from DataSourceDigitalOcean @00.28900s +00.00800s
Starting stage: init-local/search-Azure
Starting stage: azure-ds/_get_data
|`->found azure asset tag @00.29800s +00.00600s
Starting stage: azure-ds/crawl_metadata
|`->list_possible_azure_ds_devs @00.30500s +00.00600s
|`->load_azure_ds_dir @00.31100s +00.00000s
Starting stage: azure-ds/load_azure_ds_dir
Starting stage: azure-ds/read_azure_ovf
|`->_extract_preprovisioned_vm_setting @00.43300s +00.00000s
Finished stage: (azure-ds/read_azure_ovf) 00.00600 seconds 

Finished stage: (azure-ds/load_azure_ds_dir) 00.01100 seconds 

Starting stage: azure-ds/_report_ready
Starting stage: azure-ds/get_metadata_from_fabric
Starting stage: azure-ds/register_with_azure_and_fetch_data
|`->generate_certificate @00.70200s +00.25700s
|`->find_endpoint @00.95900s +00.00100s
Total Time: 0.01700 seconds

-- Boot Record 02 --
The total time elapsed since completing an event is printed after the "@" character.
The time the event takes is printed after the "+" character.

|`->_report_ready @00.00000s +02.36800s
Finished stage: (azure-ds/register_with_azure_and_fetch_data) 02.64600 seconds 

Finished stage: (azure-ds/get_metadata_from_fabric) 02.64700 seconds 

Finished stage: (azure-ds/_report_ready) 02.64700 seconds 

Starting stage: azure-ds/reprovisioning-read-azure-ovf
Starting stage: azure-ds/read_azure_ovf
|`->load_azure_ovf_pubkeys @7536.37600s +00.00000s
|`->_extract_preprovisioned_vm_setting @7536.37700s +00.00000s
Finished stage: (azure-ds/read_azure_ovf) 00.00400 seconds 

Finished stage: (azure-ds/reprovisioning-read-azure-ovf) 00.00400 seconds 

Starting stage: azure-ds/get_metadata_from_imds
|`->_get_metadata_from_imds @7536.39900s +00.02100s
Finished stage: (azure-ds/get_metadata_from_imds) 00.02300 seconds 

|`->_get_random_seed @7536.42200s +00.00000s
Starting stage: azure-ds/_report_ready
Starting stage: azure-ds/get_metadata_from_fabric
Starting stage: azure-ds/register_with_azure_and_fetch_data
|`->generate_certificate @7536.43700s +00.11800s
|`->find_endpoint @7536.55500s +00.00100s
Total Time: 7.97100 seconds

-- Boot Record 03 --
The total time elapsed since completing an event is printed after the "@" character.
The time the event takes is printed after the "+" character.

|`->_report_ready @00.00000s +00.21900s
Finished stage: (azure-ds/register_with_azure_and_fetch_data) 00.35400 seconds 

Finished stage: (azure-ds/get_metadata_from_fabric) 00.35600 seconds 

Finished stage: (azure-ds/_report_ready) 00.35600 seconds 

Finished stage: (azure-ds/crawl_metadata) 7537.48500 seconds 

|`->write_files @00.24100s +00.00200s
Finished stage: (azure-ds/_get_data) 7537.49500 seconds 

Finished stage: (init-local/search-Azure) 7537.49800 seconds 

|`->network config from fallback @00.31300s +00.01700s
Finished stage: (init-local) 7537.90000 seconds 

Starting stage: init-network
|`->restored from cache with run check: DataSourceAzure [seed=/dev/sr0] @01.42000s +00.02200s
|`->network config from fallback @01.50700s +00.02000s
Starting stage: init-network/setup-datasource
Starting stage: azure-ds/setup
Starting stage: azure-ds/_negotiate
Starting stage: azure-ds/get_metadata_from_agent
Starting stage: azure-ds/bounce_network_with_azure_hostname
|`->temporary_hostname @01.53600s +00.00000s
Finished stage: (azure-ds/bounce_network_with_azure_hostname) 00.00300 seconds 

|`->invoke_agent @01.53900s +00.17000s
|`->wait for agents to retrieve ssh keys @01.70900s +00.50300s
Starting stage: azure-ds/pubkeys_from_crt_files
|`->crtfile_to_pubkey @02.21200s +00.02500s
Finished stage: (azure-ds/pubkeys_from_crt_files) 00.02500 seconds 

Finished stage: (azure-ds/get_metadata_from_agent) 00.70100 seconds 

Finished stage: (azure-ds/_negotiate) 00.70100 seconds 

Finished stage: (azure-ds/setup) 00.70200 seconds 

Finished stage: (init-network/setup-datasource) 00.70200 seconds 

|`->reading and applying user-data @02.24600s +00.00800s
|`->reading and applying vendor-data @02.25400s +00.00000s
Starting stage: init-network/activate-datasource
Starting stage: azure-ds/activate
Starting stage: azure-ds/address_ephemeral_resize
|`->wait for ephemeral disk @02.28600s +00.00000s
Starting stage: azure-ds/can_dev_be_reformatted
|`->_has_ntfs_filesystem @02.28600s +00.09100s
Starting stage: azure-ds/mount-ntfs-and-count
|`->count_files @02.42100s +00.00200s
Finished stage: (azure-ds/mount-ntfs-and-count) 00.05100 seconds 

Finished stage: (azure-ds/can_dev_be_reformatted) 00.14300 seconds 

Finished stage: (azure-ds/address_ephemeral_resize) 00.14300 seconds 

Finished stage: (azure-ds/activate) 00.14300 seconds 

Finished stage: (init-network/activate-datasource) 00.14600 seconds 

|`->config-migrator ran successfully @02.46900s +00.00100s
|`->config-seed_random ran successfully @02.47100s +00.00100s
|`->config-bootcmd ran successfully @02.47300s +00.00000s
|`->config-write-files ran successfully @02.47400s +00.00100s
|`->config-growpart ran successfully @02.47600s +00.72300s
|`->config-resizefs ran successfully @03.19900s +00.59500s
|`->config-disk_setup ran successfully @03.79500s +04.41100s
|`->config-mounts ran successfully @08.20700s +00.13300s
|`->config-set_hostname ran successfully @08.34000s +00.00800s
|`->config-update_hostname ran successfully @08.34900s +00.00100s
|`->config-update_etc_hosts ran successfully @08.35100s +00.00000s
|`->config-ca-certs ran successfully @08.35200s +00.00100s
|`->config-rsyslog ran successfully @08.35300s +00.00100s
|`->config-users-groups ran successfully @08.35500s +00.54900s
|`->config-ssh ran successfully @08.90400s +00.29300s
Finished stage: (init-network) 07.79100 seconds 

Starting stage: modules-config
|`->config-emit_upstart ran successfully @18.69700s +00.00100s
|`->config-snap ran successfully @18.69800s +00.00100s
|`->config-snap_config ran successfully @18.70000s +00.00100s
|`->config-ssh-import-id ran successfully @18.70100s +00.85500s
|`->config-locale ran successfully @19.55700s +00.99800s
|`->config-set-passwords ran successfully @20.55600s +00.00200s
|`->config-grub-dpkg ran successfully @20.55900s +01.16200s
|`->config-apt-pipelining ran successfully @21.72300s +00.00100s
|`->config-apt-configure ran successfully @21.72400s +00.13300s
|`->config-ubuntu-advantage ran successfully @21.85800s +00.00200s
|`->config-ntp ran successfully @21.86000s +00.00100s
|`->config-timezone ran successfully @21.86200s +00.00100s
|`->config-disable-ec2-metadata ran successfully @21.86300s +00.00000s
|`->config-runcmd ran successfully @21.86400s +00.00100s
|`->config-byobu ran successfully @21.86500s +00.00100s
Finished stage: (modules-config) 03.21900 seconds 

Starting stage: modules-final
|`->config-snappy ran successfully @22.38100s +00.00200s
|`->config-package-update-upgrade-install ran successfully @22.38300s +00.00100s
|`->config-fan ran successfully @22.38600s +00.00100s
|`->config-landscape ran successfully @22.38800s +00.00100s
|`->config-lxd ran successfully @22.38900s +00.00100s
|`->config-ubuntu-drivers ran successfully @22.39100s +00.00100s
|`->config-puppet ran successfully @22.39200s +00.00100s
|`->config-chef ran successfully @22.39400s +00.00100s
|`->config-mcollective ran successfully @22.39500s +00.00100s
|`->config-salt-minion ran successfully @22.39700s +00.00100s
|`->config-rightscale_userdata ran successfully @22.39800s +00.00100s
|`->config-scripts-vendor ran successfully @22.40000s +00.00200s
|`->config-scripts-per-once ran successfully @22.40300s +00.00100s
|`->config-scripts-per-boot ran successfully @22.40400s +00.00100s
|`->config-scripts-per-instance ran successfully @22.40500s +00.00100s
|`->config-scripts-user ran successfully @22.40700s +00.00100s
|`->config-ssh-authkey-fingerprints ran successfully @22.40800s +00.05500s
|`->config-keys-to-console ran successfully @22.46300s +00.12100s
|`->config-phone-home ran successfully @22.58600s +00.00100s
|`->config-final-message ran successfully @22.58800s +00.00400s
|`->config-power-state-change ran successfully @22.59300s +00.00100s
Finished stage: (modules-final) 00.23900 seconds 

Total Time: 30166.15300 seconds

3 boot records analyzed
-- Boot Record 01 --
     00.25700s (azure-ds/generate_certificate)
     00.06300s (init-local/search-NoCloud)
     00.01900s (init-local/search-ConfigDrive)
     00.00900s (init-local/search-OpenNebula)
     00.00800s (init-local/search-DigitalOcean)
     00.00600s (azure-ds/list_possible_azure_ds_devs)
     00.00600s (azure-ds/check-platform-viability)
     00.00100s (init-local/check-cache)
     00.00100s (azure-ds/find_endpoint)
     00.00000s (azure-ds/load_azure_ds_dir)
     00.00000s (azure-ds/_extract_preprovisioned_vm_setting)

-- Boot Record 02 --
     02.36800s (azure-ds/_report_ready)
     00.11800s (azure-ds/generate_certificate)
     00.02100s (azure-ds/_get_metadata_from_imds)
     00.00100s (azure-ds/find_endpoint)
     00.00000s (azure-ds/load_azure_ovf_pubkeys)
     00.00000s (azure-ds/_get_random_seed)
     00.00000s (azure-ds/_extract_preprovisioned_vm_setting)

-- Boot Record 03 --
     04.41100s (init-network/config-disk_setup)
     01.16200s (modules-config/config-grub-dpkg)
     00.99800s (modules-config/config-locale)
     00.85500s (modules-config/config-ssh-import-id)
     00.72300s (init-network/config-growpart)
     00.59500s (init-network/config-resizefs)
     00.54900s (init-network/config-users-groups)
     00.50300s (azure-ds/waiting-for-ssh-public-key)
     00.29300s (init-network/config-ssh)
     00.21900s (azure-ds/_report_ready)
     00.17000s (azure-ds/invoke_agent)
     00.13300s (modules-config/config-apt-configure)
     00.13300s (init-network/config-mounts)
     00.12100s (modules-final/config-keys-to-console)
     00.09100s (azure-ds/_has_ntfs_filesystem)
     00.05500s (modules-final/config-ssh-authkey-fingerprints)
     00.02500s (azure-ds/crtfile_to_pubkey)
     00.02200s (init-network/check-cache)
     00.02000s (azure-ds/parse_network_config)
     00.01700s (azure-ds/parse_network_config)
     00.00800s (init-network/consume-user-data)
     00.00800s (init-network/config-set_hostname)
     00.00400s (modules-final/config-final-message)
     00.00200s (modules-final/config-snappy)
     00.00200s (modules-final/config-scripts-vendor)
     00.00200s (modules-config/config-ubuntu-advantage)
     00.00200s (modules-config/config-set-passwords)
     00.00200s (azure-ds/write_files)
     00.00200s (azure-ds/count_files)
     00.00100s (modules-final/config-ubuntu-drivers)
     00.00100s (modules-final/config-scripts-user)
     00.00100s (modules-final/config-scripts-per-once)
     00.00100s (modules-final/config-scripts-per-instance)
     00.00100s (modules-final/config-scripts-per-boot)
     00.00100s (modules-final/config-salt-minion)
     00.00100s (modules-final/config-rightscale_userdata)
     00.00100s (modules-final/config-puppet)
     00.00100s (modules-final/config-power-state-change)
     00.00100s (modules-final/config-phone-home)
     00.00100s (modules-final/config-package-update-upgrade-install)
     00.00100s (modules-final/config-mcollective)
     00.00100s (modules-final/config-lxd)
     00.00100s (modules-final/config-landscape)
     00.00100s (modules-final/config-fan)
     00.00100s (modules-final/config-chef)
     00.00100s (modules-config/config-timezone)
     00.00100s (modules-config/config-snap_config)
     00.00100s (modules-config/config-snap)
     00.00100s (modules-config/config-runcmd)
     00.00100s (modules-config/config-ntp)
     00.00100s (modules-config/config-emit_upstart)
     00.00100s (modules-config/config-byobu)
     00.00100s (modules-config/config-apt-pipelining)
     00.00100s (init-network/config-write-files)
     00.00100s (init-network/config-update_hostname)
     00.00100s (init-network/config-seed_random)
     00.00100s (init-network/config-rsyslog)
     00.00100s (init-network/config-migrator)
     00.00100s (init-network/config-ca-certs)
     00.00000s (modules-config/config-disable-ec2-metadata)
     00.00000s (init-network/consume-vendor-data)
     00.00000s (init-network/config-update_etc_hosts)
     00.00000s (init-network/config-bootcmd)
     00.00000s (azure-ds/wait-for-ephemeral-disk)
     00.00000s (azure-ds/temporary_hostname)

3 boot records analyzed
Networking config
# This file is generated from information provided by
# the datasource.  Changes to it will not persist across an instance.
# To disable cloud-init's network configuration capabilities, write a file
# /etc/cloud/cloud.cfg.d/99-disable-network-config.cfg with the following:
# network: {config: disabled}
auto lo
iface lo inet loopback

auto eth0
iface eth0 inet dhcp
  cloud-init
Get:1 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 cloud-init all 19.2-36-g059d049c-0ubuntu1~16.04.1 [408 kB]
Preparing to unpack .../cloud-init_19.2-36-g059d049c-0ubuntu1~16.04.1_all.deb ...
Unpacking cloud-init (19.2-36-g059d049c-0ubuntu1~16.04.1) over (19.1-1-gbaa47854-0ubuntu1~16.04.1) ...
Setting up cloud-init (19.2-36-g059d049c-0ubuntu1~16.04.1) ...
Leaving 'diversion of /etc/init/ureadahead.conf to /etc/init/ureadahead.conf.disabled by cloud-init'
cloud-init	19.2-36-g059d049c-0ubuntu1~16.04.1
sudo: unable to resolve host SRU-worked-azure
sudo: unable to resolve host SRU-didnt-work
sudo: unable to resolve host SRU-didnt-work
Connection to 40.79.71.93 closed by remote host.

status: done
time: Thu, 19 Sep 2019 12:08:48 +0000
detail:
DataSourceAzure [seed=/var/lib/waagent]
sudo: unable to resolve host SRU-worked-azure
{
 "v1": {
  "datasource": "DataSourceAzure [seed=/var/lib/waagent]",
  "errors": []
 }
}
sudo: unable to resolve host SRU-worked-azure
          2.860s cloud-init-local.service
          2.251s cloud-init.service
          1.881s cloud-config.service
          1.652s dev-sda1.device
          1.092s snapd.service
           958ms lxd-containers.service
           877ms grub-common.service
           796ms lvm2-monitor.service
           679ms cloud-final.service
           599ms accounts-daemon.service
           559ms networking.service
           539ms iscsid.service
           521ms apparmor.service
           500ms mdadm.service
           445ms ssh.service
           418ms systemd-logind.service
           401ms open-iscsi.service
           376ms console-setup.service
           335ms apport.service
           319ms rsyslog.service
           290ms polkitd.service
           178ms setvtrgb.service
           177ms irqbalance.service
           169ms resolvconf.service
           164ms ufw.service
           160ms keyboard-setup.service
           156ms snapd.socket
           152ms systemd-modules-load.service
           147ms systemd-udev-trigger.service
           138ms systemd-remount-fs.service
           129ms kmod-static-nodes.service
           121ms systemd-journald.service
           119ms systemd-journal-flush.service
           111ms rc-local.service
           105ms dev-hugepages.mount
            99ms systemd-timesyncd.service
            91ms ondemand.service
            88ms sys-kernel-config.mount
            87ms sys-fs-fuse-connections.mount
            86ms systemd-sysctl.service
            83ms dev-mqueue.mount
            82ms systemd-update-utmp.service
            76ms systemd-tmpfiles-setup-dev.service
            73ms lxd.socket
            73ms systemd-tmpfiles-setup.service
            53ms plymouth-quit-wait.service
            52ms snapd.seeded.service
            50ms systemd-udevd.service
            46ms systemd-user-sessions.service
            45ms systemd-fsck@dev-disk-cloud-azure_resource\x2dpart1.service
            38ms systemd-random-seed.service
            32ms plymouth-quit.service
            32ms sys-kernel-debug.mount
            24ms plymouth-read-write.service
            22ms user@1000.service
            14ms ephemeral-disk-warning.service
            14ms systemd-update-utmp-runlevel.service
-- Boot Record 01 --
The total time elapsed since completing an event is printed after the "@" character.
The time the event takes is printed after the "+" character.

Starting stage: init-local
|`->no cache found @00.00500s +00.00100s
|`->no local data found from DataSourceNoCloud @00.06000s +00.39900s
|`->no local data found from DataSourceConfigDrive @00.45900s +00.40000s
|`->no local data found from DataSourceOpenNebula @00.85900s +00.24400s
|`->no local data found from DataSourceDigitalOcean @01.10300s +00.00900s
Starting stage: init-local/search-Azure
Starting stage: azure-ds/_get_data
|`->found azure asset tag @01.11300s +00.00700s
|`->get_boot_telemetry @01.12000s +00.01000s
|`->get_system_info @01.13000s +00.00200s
Starting stage: azure-ds/crawl_metadata
|`->list_possible_azure_ds_devs @01.13200s +00.15900s
|`->load_azure_ds_dir @01.29100s +00.00000s
Starting stage: azure-ds/load_azure_ds_dir
Starting stage: azure-ds/read_azure_ovf
|`->load_azure_ovf_pubkeys @01.29500s +00.00000s
|`->_extract_preprovisioned_vm_setting @01.29600s +00.00000s
Finished stage: (azure-ds/read_azure_ovf) 00.00300 seconds 

Finished stage: (azure-ds/load_azure_ds_dir) 00.00600 seconds 

Starting stage: azure-ds/get_metadata_from_imds
|`->obtain dhcp lease @01.31700s +00.12100s
|`->_get_metadata_from_imds @01.43800s +00.01400s
Finished stage: (azure-ds/get_metadata_from_imds) 00.15800 seconds 

|`->_get_random_seed @01.47400s +00.00100s
Finished stage: (azure-ds/crawl_metadata) 00.35000 seconds 

|`->write_files @01.48200s +00.00300s
Finished stage: (azure-ds/_get_data) 00.37200 seconds 

Finished stage: (init-local/search-Azure) 00.37500 seconds 

|`->network config from fallback @01.55300s +00.02000s
Finished stage: (init-local) 01.58800 seconds 

Starting stage: init-network
|`->restored from cache with run check: DataSourceAzure [seed=/var/lib/waagent] @02.57700s +00.02300s
|`->network config from fallback @02.65900s +00.02100s
Starting stage: init-network/setup-datasource
Starting stage: azure-ds/setup
Starting stage: azure-ds/_negotiate
Starting stage: azure-ds/get_metadata_from_agent
Starting stage: azure-ds/bounce_network_with_azure_hostname
|`->temporary_hostname @02.69000s +00.00100s
Finished stage: (azure-ds/bounce_network_with_azure_hostname) 00.00300 seconds 

|`->invoke_agent @02.69300s +00.17200s
|`->wait for agents to retrieve ssh keys @02.86500s +00.00000s
Starting stage: azure-ds/pubkeys_from_crt_files
|`->crtfile_to_pubkey @02.86600s +00.02200s
Finished stage: (azure-ds/pubkeys_from_crt_files) 00.02200 seconds 

Finished stage: (azure-ds/get_metadata_from_agent) 00.19800 seconds 

Finished stage: (azure-ds/_negotiate) 00.19800 seconds 

Finished stage: (azure-ds/setup) 00.19900 seconds 

Finished stage: (init-network/setup-datasource) 00.20000 seconds 

|`->reading and applying user-data @02.90400s +00.01400s
|`->reading and applying vendor-data @02.92100s +00.00000s
Starting stage: init-network/activate-datasource
Starting stage: azure-ds/activate
Starting stage: azure-ds/address_ephemeral_resize
|`->wait for ephemeral disk @02.98300s +00.00400s
Starting stage: azure-ds/can_dev_be_reformatted
|`->_has_ntfs_filesystem @02.98800s +00.07800s
Finished stage: (azure-ds/can_dev_be_reformatted) 00.07900 seconds 

Finished stage: (azure-ds/address_ephemeral_resize) 00.08400 seconds 

Finished stage: (azure-ds/activate) 00.08500 seconds 

Finished stage: (init-network/activate-datasource) 00.08700 seconds 

|`->config-migrator ran successfully @03.09600s +00.00100s
|`->config-seed_random ran successfully @03.09900s +00.00100s
|`->config-bootcmd ran successfully @03.10100s +00.00200s
|`->config-write-files ran successfully @03.10400s +00.00100s
|`->config-growpart ran successfully @03.10600s +00.09100s
|`->config-resizefs ran successfully @03.19800s +00.02600s
|`->config-disk_setup ran successfully @03.22600s +00.25800s
|`->config-mounts ran successfully @03.48400s +00.19200s
|`->config-set_hostname ran successfully @03.67700s +00.01100s
|`->config-update_hostname ran successfully @03.69100s +00.00200s
|`->config-update_etc_hosts ran successfully @03.69500s +00.00100s
|`->config-ca-certs ran successfully @03.69600s +00.00400s
|`->config-rsyslog ran successfully @03.70000s +00.00100s
|`->config-users-groups ran successfully @03.70300s +00.18100s
|`->config-ssh ran successfully @03.88500s +00.46300s
Finished stage: (init-network) 01.78400 seconds 

Starting stage: modules-config
|`->config-emit_upstart ran successfully @06.85900s +00.00100s
|`->config-snap ran successfully @06.86100s +00.00100s
|`->config-snap_config ran successfully @06.86200s +00.00100s
|`->config-ssh-import-id ran successfully @06.86400s +00.57200s
|`->config-locale ran successfully @07.43700s +00.01000s
|`->config-set-passwords ran successfully @07.44800s +00.00100s
|`->config-grub-dpkg ran successfully @07.45000s +00.41200s
|`->config-apt-pipelining ran successfully @07.86300s +00.00100s
|`->config-apt-configure ran successfully @07.86500s +00.09800s
|`->config-ubuntu-advantage ran successfully @07.96400s +00.00100s
|`->config-ntp ran successfully @07.96600s +00.00100s
|`->config-timezone ran successfully @07.96700s +00.00100s
|`->config-disable-ec2-metadata ran successfully @07.96900s +00.00000s
|`->config-runcmd ran successfully @07.97000s +00.00100s
|`->config-byobu ran successfully @07.97100s +00.00100s
Finished stage: (modules-config) 01.13100 seconds 

Starting stage: modules-final
|`->config-snappy ran successfully @08.50300s +00.00200s
|`->config-package-update-upgrade-install ran successfully @08.50600s +00.00000s
|`->config-fan ran successfully @08.50700s +00.00100s
|`->config-landscape ran successfully @08.50900s +00.00100s
|`->config-lxd ran successfully @08.51000s +00.00100s
|`->config-ubuntu-drivers ran successfully @08.51200s +00.00100s
|`->config-puppet ran successfully @08.51300s +00.00100s
|`->config-chef ran successfully @08.51500s +00.00100s
|`->config-mcollective ran successfully @08.51600s +00.00100s
|`->config-salt-minion ran successfully @08.51800s +00.00100s
|`->config-rightscale_userdata ran successfully @08.52100s +00.00100s
|`->config-scripts-vendor ran successfully @08.52300s +00.00100s
|`->config-scripts-per-once ran successfully @08.52400s +00.00100s
|`->config-scripts-per-boot ran successfully @08.52600s +00.00000s
|`->config-scripts-per-instance ran successfully @08.52700s +00.00100s
|`->config-scripts-user ran successfully @08.52900s +00.00200s
|`->config-ssh-authkey-fingerprints ran successfully @08.53200s +00.07200s
|`->config-keys-to-console ran successfully @08.60500s +00.07800s
|`->config-phone-home ran successfully @08.68400s +00.00100s
|`->config-final-message ran successfully @08.68600s +00.00400s
|`->config-power-state-change ran successfully @08.69100s +00.00100s
Finished stage: (modules-final) 00.21200 seconds 

Total Time: 7.13400 seconds

1 boot records analyzed
-- Boot Record 01 --
     00.57200s (modules-config/config-ssh-import-id)
     00.46300s (init-network/config-ssh)
     00.41200s (modules-config/config-grub-dpkg)
     00.40000s (init-local/search-ConfigDrive)
     00.39900s (init-local/search-NoCloud)
     00.25800s (init-network/config-disk_setup)
     00.24400s (init-local/search-OpenNebula)
     00.19200s (init-network/config-mounts)
     00.18100s (init-network/config-users-groups)
     00.17200s (azure-ds/invoke_agent)
     00.15900s (azure-ds/list_possible_azure_ds_devs)
     00.12100s (azure-ds/obtain-dhcp-lease)
     00.09800s (modules-config/config-apt-configure)
     00.09100s (init-network/config-growpart)
     00.07800s (modules-final/config-keys-to-console)
     00.07800s (azure-ds/_has_ntfs_filesystem)
     00.07200s (modules-final/config-ssh-authkey-fingerprints)
     00.02600s (init-network/config-resizefs)
     00.02300s (init-network/check-cache)
     00.02200s (azure-ds/crtfile_to_pubkey)
     00.02100s (azure-ds/parse_network_config)
     00.02000s (azure-ds/parse_network_config)
     00.01400s (init-network/consume-user-data)
     00.01400s (azure-ds/_get_metadata_from_imds)
     00.01100s (init-network/config-set_hostname)
     00.01000s (modules-config/config-locale)
     00.01000s (azure-ds/get_boot_telemetry)
     00.00900s (init-local/search-DigitalOcean)
     00.00700s (azure-ds/check-platform-viability)
     00.00400s (modules-final/config-final-message)
     00.00400s (init-network/config-ca-certs)
     00.00400s (azure-ds/wait-for-ephemeral-disk)
     00.00300s (azure-ds/write_files)
     00.00200s (modules-final/config-snappy)
     00.00200s (modules-final/config-scripts-user)
     00.00200s (init-network/config-update_hostname)
     00.00200s (init-network/config-bootcmd)
     00.00200s (azure-ds/get_system_info)
     00.00100s (modules-final/config-ubuntu-drivers)
     00.00100s (modules-final/config-scripts-vendor)
     00.00100s (modules-final/config-scripts-per-once)
     00.00100s (modules-final/config-scripts-per-instance)
     00.00100s (modules-final/config-salt-minion)
     00.00100s (modules-final/config-rightscale_userdata)
     00.00100s (modules-final/config-puppet)
     00.00100s (modules-final/config-power-state-change)
     00.00100s (modules-final/config-phone-home)
     00.00100s (modules-final/config-mcollective)
     00.00100s (modules-final/config-lxd)
     00.00100s (modules-final/config-landscape)
     00.00100s (modules-final/config-fan)
     00.00100s (modules-final/config-chef)
     00.00100s (modules-config/config-ubuntu-advantage)
     00.00100s (modules-config/config-timezone)
     00.00100s (modules-config/config-snap_config)
     00.00100s (modules-config/config-snap)
     00.00100s (modules-config/config-set-passwords)
     00.00100s (modules-config/config-runcmd)
     00.00100s (modules-config/config-ntp)
     00.00100s (modules-config/config-emit_upstart)
     00.00100s (modules-config/config-byobu)
     00.00100s (modules-config/config-apt-pipelining)
     00.00100s (init-network/config-write-files)
     00.00100s (init-network/config-update_etc_hosts)
     00.00100s (init-network/config-seed_random)
     00.00100s (init-network/config-rsyslog)
     00.00100s (init-network/config-migrator)
     00.00100s (init-local/check-cache)
     00.00100s (azure-ds/temporary_hostname)
     00.00100s (azure-ds/_get_random_seed)
     00.00000s (modules-final/config-scripts-per-boot)
     00.00000s (modules-final/config-package-update-upgrade-install)
     00.00000s (modules-config/config-disable-ec2-metadata)
     00.00000s (init-network/consume-vendor-data)
     00.00000s (azure-ds/waiting-for-ssh-public-key)
     00.00000s (azure-ds/load_azure_ovf_pubkeys)
     00.00000s (azure-ds/load_azure_ds_dir)
     00.00000s (azure-ds/_extract_preprovisioned_vm_setting)

1 boot records analyzed
After upgrade Networking config
# This file is generated from information provided by
# the datasource.  Changes to it will not persist across an instance.
# To disable cloud-init's network configuration capabilities, write a file
# /etc/cloud/cloud.cfg.d/99-disable-network-config.cfg with the following:
# network: {config: disabled}
auto lo
iface lo inet loopback

auto eth0
iface eth0 inet dhcp
cloud-region: azure-eastus2
Get cloud-id
azure
cloud-region: azure-eastus2
Validating whether metadata is being updated per boot LP:1819913
2019-09-19 12:08:39,837 - __init__.py[DEBUG]: Update datasource metadata and network config due to events: New instance first boot
2019-09-19 12:08:40,236 - __init__.py[DEBUG]: Update datasource metadata and network config due to events: New instance first boot
2019-09-19 12:08:40,636 - __init__.py[DEBUG]: Update datasource metadata and network config due to events: New instance first boot
2019-09-19 12:08:40,880 - __init__.py[DEBUG]: Update datasource metadata and network config due to events: New instance first boot
2019-09-19 12:08:40,889 - __init__.py[DEBUG]: Update datasource metadata and network config due to events: New instance first boot
sudo: unable to resolve host SRU-worked-azure
Connection to 40.79.71.93 closed by remote host.
After reboot
2019-09-19 12:08:39,837 - __init__.py[DEBUG]: Update datasource metadata and network config due to events: New instance first boot
2019-09-19 12:08:40,236 - __init__.py[DEBUG]: Update datasource metadata and network config due to events: New instance first boot
2019-09-19 12:08:40,636 - __init__.py[DEBUG]: Update datasource metadata and network config due to events: New instance first boot
2019-09-19 12:08:40,880 - __init__.py[DEBUG]: Update datasource metadata and network config due to events: New instance first boot
2019-09-19 12:08:40,889 - __init__.py[DEBUG]: Update datasource metadata and network config due to events: New instance first boot
2019-09-19 12:09:48,098 - __init__.py[DEBUG]: Update datasource metadata and network config due to events: New instance first boot
2019-09-19 12:09:48,517 - __init__.py[DEBUG]: Update datasource metadata and network config due to events: New instance first boot
2019-09-19 12:09:48,918 - __init__.py[DEBUG]: Update datasource metadata and network config due to events: New instance first boot
2019-09-19 12:09:49,150 - __init__.py[DEBUG]: Update datasource metadata and network config due to events: New instance first boot
2019-09-19 12:09:49,159 - __init__.py[DEBUG]: Update datasource metadata and network config due to events: New instance first boot
2019-09-19 12:09:49,790 - __init__.py[DEBUG]: Update datasource metadata and network config due to events: System boot
Creating advanced network vm
{
  "publicIp": {
    "dnsSettings": null,
    "etag": "W/\"6d4d6021-fd7e-42e0-afe2-2a13762803a7\"",
    "id": "/subscriptions/12aad61c-6de4-4e53-a6c6-5aff52a83777/resourceGroups/srugroup1/providers/Microsoft.Network/publicIPAddresses/sruPublicIp-xenial",
    "idleTimeoutInMinutes": 4,
    "ipAddress": null,
    "ipConfiguration": null,
    "ipTags": [],
    "location": "eastus2",
    "name": "sruPublicIp-xenial",
    "provisioningState": "Succeeded",
    "publicIpAddressVersion": "IPv4",
    "publicIpAllocationMethod": "Dynamic",
    "resourceGroup": "srugroup1",
    "resourceGuid": "f9b5bc77-da1a-4a58-8b80-6a3a222784b3",
    "sku": {
      "name": "Basic",
      "tier": "Regional"
    },
    "tags": null,
    "type": "Microsoft.Network/publicIPAddresses",
    "zones": null
  }
}
{
  "NewNIC": {
    "dnsSettings": {
      "appliedDnsServers": [],
      "dnsServers": [],
      "internalDnsNameLabel": null,
      "internalDomainNameSuffix": "me2fgxnygpauvbyw101lldfzsc.cx.internal.cloudapp.net",
      "internalFqdn": null
    },
    "enableAcceleratedNetworking": true,
    "enableIpForwarding": false,
    "etag": "W/\"c1504f0f-2d51-42ca-9d25-d309fe3b51d9\"",
    "id": "/subscriptions/12aad61c-6de4-4e53-a6c6-5aff52a83777/resourceGroups/srugroup1/providers/Microsoft.Network/networkInterfaces/sruNic-xenial",
    "ipConfigurations": [
      {
        "applicationGatewayBackendAddressPools": null,
        "applicationSecurityGroups": null,
        "etag": "W/\"c1504f0f-2d51-42ca-9d25-d309fe3b51d9\"",
        "id": "/subscriptions/12aad61c-6de4-4e53-a6c6-5aff52a83777/resourceGroups/srugroup1/providers/Microsoft.Network/networkInterfaces/sruNic-xenial/ipConfigurations/ipconfig1",
        "loadBalancerBackendAddressPools": null,
        "loadBalancerInboundNatRules": null,
        "name": "ipconfig1",
        "primary": true,
        "privateIpAddress": "192.168.1.5",
        "privateIpAddressVersion": "IPv4",
        "privateIpAllocationMethod": "Dynamic",
        "provisioningState": "Succeeded",
        "publicIpAddress": {
          "dnsSettings": null,
          "etag": null,
          "id": "/subscriptions/12aad61c-6de4-4e53-a6c6-5aff52a83777/resourceGroups/srugroup1/providers/Microsoft.Network/publicIPAddresses/sruPublicIp-xenial",
          "idleTimeoutInMinutes": null,
          "ipAddress": null,
          "ipConfiguration": null,
          "ipTags": null,
          "location": null,
          "name": null,
          "provisioningState": null,
          "publicIpAddressVersion": null,
          "publicIpAllocationMethod": null,
          "resourceGroup": "srugroup1",
          "resourceGuid": null,
          "sku": null,
          "tags": null,
          "type": null,
          "zones": null
        },
        "resourceGroup": "srugroup1",
        "subnet": {
          "addressPrefix": null,
          "etag": null,
          "id": "/subscriptions/12aad61c-6de4-4e53-a6c6-5aff52a83777/resourceGroups/srugroup1/providers/Microsoft.Network/virtualNetworks/sruVnet/subnets/sruSubnet",
          "ipConfigurations": null,
          "name": null,
          "networkSecurityGroup": null,
          "provisioningState": null,
          "resourceGroup": "srugroup1",
          "resourceNavigationLinks": null,
          "routeTable": null,
          "serviceEndpoints": null
        },
        "type": "Microsoft.Network/networkInterfaces/ipConfigurations"
      }
    ],
    "location": "eastus2",
    "macAddress": null,
    "name": "sruNic-xenial",
    "networkSecurityGroup": {
      "defaultSecurityRules": null,
      "etag": null,
      "id": "/subscriptions/12aad61c-6de4-4e53-a6c6-5aff52a83777/resourceGroups/srugroup1/providers/Microsoft.Network/networkSecurityGroups/sruNetSecGroup",
      "location": null,
      "name": null,
      "networkInterfaces": null,
      "provisioningState": null,
      "resourceGroup": "srugroup1",
      "resourceGuid": null,
      "securityRules": null,
      "subnets": null,
      "tags": null,
      "type": null
    },
    "primary": null,
    "provisioningState": "Succeeded",
    "resourceGroup": "srugroup1",
    "resourceGuid": "0d1a09d4-5401-406f-b29f-259397c9c912",
    "tags": null,
    "type": "Microsoft.Network/networkInterfaces",
    "virtualMachine": null
  }
}
{
  "fqdns": "",
  "id": "/subscriptions/12aad61c-6de4-4e53-a6c6-5aff52a83777/resourceGroups/srugroup1/providers/Microsoft.Compute/virtualMachines/test-sru-xenial-advanced",
  "location": "eastus2",
  "macAddress": "00-0D-3A-7D-41-F7",
  "powerState": "VM running",
  "privateIpAddress": "192.168.1.5",
  "publicIpAddress": "104.208.235.47",
  "resourceGroup": "srugroup1",
  "zones": ""
}

status: done
time: Thu, 19 Sep 2019 12:12:03 +0000
detail:
DataSourceAzure [seed=/dev/sr0]
cloud-init	19.1-1-gbaa47854-0ubuntu1~16.04.1
sudo: unable to resolve host SRU-worked-azure
{
 "v1": {
  "datasource": "DataSourceAzure [seed=/dev/sr0]",
  "errors": []
 }
}
Startup finished in 5.368s (kernel) + 22.360s (userspace) = 27.729s
          5.652s cloud-init.service
          4.443s cloud-init-local.service
          3.802s cloud-config.service
          2.501s snapd.service
          2.367s dev-sda1.device
          2.291s lxd-containers.service
          2.034s snapd.seeded.service
          2.018s pollinate.service
          1.676s console-setup.service
          1.321s apparmor.service
          1.056s accounts-daemon.service
           816ms networking.service
           715ms cloud-final.service
           654ms mdadm.service
           489ms iscsid.service
           462ms rsyslog.service
           461ms lvm2-monitor.service
           388ms systemd-logind.service
           314ms rc-local.service
           297ms open-iscsi.service
           284ms ssh.service
           271ms grub-common.service
           263ms systemd-modules-load.service
           228ms systemd-tmpfiles-setup-dev.service
           215ms systemd-udev-trigger.service
           194ms polkitd.service
           190ms kmod-static-nodes.service
           188ms ufw.service
           185ms resolvconf.service
           176ms systemd-journal-flush.service
           159ms apport.service
           130ms irqbalance.service
           127ms dev-mqueue.mount
           111ms sys-kernel-debug.mount
           108ms systemd-random-seed.service
           105ms systemd-journald.service
           100ms keyboard-setup.service
            97ms systemd-udevd.service
            78ms systemd-user-sessions.service
            70ms systemd-machine-id-commit.service
            67ms dev-hugepages.mount
            56ms systemd-remount-fs.service
            52ms systemd-tmpfiles-setup.service
            41ms systemd-timesyncd.service
            40ms lxd.socket
            38ms ephemeral-disk-warning.service
            37ms snapd.socket
            37ms user@1000.service
            34ms plymouth-read-write.service
            27ms systemd-update-utmp.service
            26ms plymouth-quit.service
            26ms systemd-sysctl.service
            22ms sys-fs-fuse-connections.mount
            20ms ondemand.service
            16ms setvtrgb.service
            15ms plymouth-quit-wait.service
            12ms systemd-update-utmp-runlevel.service
            10ms sys-kernel-config.mount
-- Boot Record 01 --
The total time elapsed since completing an event is printed after the "@" character.
The time the event takes is printed after the "+" character.

Starting stage: init-local
|`->no cache found @00.00500s +00.00100s
|`->no local data found from DataSourceNoCloud @00.22000s +00.06800s
|`->no local data found from DataSourceConfigDrive @00.28800s +00.02000s
|`->no local data found from DataSourceOpenNebula @00.30800s +00.00800s
|`->no local data found from DataSourceDigitalOcean @00.31600s +00.00800s
Starting stage: init-local/search-Azure
Starting stage: azure-ds/_get_data
|`->found azure asset tag @00.32500s +00.00800s
Starting stage: azure-ds/crawl_metadata
|`->list_possible_azure_ds_devs @00.33300s +00.00600s
|`->load_azure_ds_dir @00.33900s +00.00100s
Starting stage: azure-ds/load_azure_ds_dir
Starting stage: azure-ds/read_azure_ovf
|`->load_azure_ovf_pubkeys @00.48300s +00.00000s
|`->_extract_preprovisioned_vm_setting @00.48300s +00.00100s
Finished stage: (azure-ds/read_azure_ovf) 00.00400 seconds 

Finished stage: (azure-ds/load_azure_ds_dir) 00.00900 seconds 

Starting stage: azure-ds/get_metadata_from_imds
|`->_get_metadata_from_imds @00.77600s +00.04500s
Finished stage: (azure-ds/get_metadata_from_imds) 00.34600 seconds 

|`->_get_random_seed @00.87000s +00.00100s
Finished stage: (azure-ds/crawl_metadata) 00.54600 seconds 

|`->write_files @00.88000s +00.00200s
Finished stage: (azure-ds/_get_data) 00.55700 seconds 

Finished stage: (init-local/search-Azure) 00.56000 seconds 

|`->network config from fallback @00.96200s +00.02000s
Finished stage: (init-local) 01.00600 seconds 

Starting stage: init-network
|`->restored from cache with run check: DataSourceAzure [seed=/dev/sr0] @02.22100s +00.02600s
|`->network config from fallback @02.30800s +00.01400s
Starting stage: init-network/setup-datasource
Starting stage: azure-ds/setup
Starting stage: azure-ds/_negotiate
Starting stage: azure-ds/get_metadata_from_agent
Starting stage: azure-ds/bounce_network_with_azure_hostname
|`->temporary_hostname @02.33500s +00.00000s
Finished stage: (azure-ds/bounce_network_with_azure_hostname) 00.00300 seconds 

|`->invoke_agent @02.33900s +00.21400s
|`->wait for agents to retrieve ssh keys @02.55300s +01.00300s
Starting stage: azure-ds/pubkeys_from_crt_files
|`->crtfile_to_pubkey @03.55700s +00.04000s
Finished stage: (azure-ds/pubkeys_from_crt_files) 00.04000 seconds 

Finished stage: (azure-ds/get_metadata_from_agent) 01.26400 seconds 

Finished stage: (azure-ds/_negotiate) 01.26400 seconds 

Finished stage: (azure-ds/setup) 01.26500 seconds 

Finished stage: (init-network/setup-datasource) 01.26500 seconds 

|`->reading and applying user-data @03.60700s +00.00800s
|`->reading and applying vendor-data @03.61600s +00.00000s
Starting stage: init-network/activate-datasource
Starting stage: azure-ds/activate
Starting stage: azure-ds/address_ephemeral_resize
|`->wait for ephemeral disk @03.64900s +00.00100s
Starting stage: azure-ds/can_dev_be_reformatted
|`->_has_ntfs_filesystem @03.65100s +00.04900s
Starting stage: azure-ds/mount-ntfs-and-count
|`->count_files @03.76000s +00.00200s
Finished stage: (azure-ds/mount-ntfs-and-count) 00.08600 seconds 

Finished stage: (azure-ds/can_dev_be_reformatted) 00.13600 seconds 

Finished stage: (azure-ds/address_ephemeral_resize) 00.13800 seconds 

Finished stage: (azure-ds/activate) 00.13800 seconds 

Finished stage: (init-network/activate-datasource) 00.14000 seconds 

|`->config-migrator ran successfully @03.84000s +00.00100s
|`->config-seed_random ran successfully @03.84200s +00.00100s
|`->config-bootcmd ran successfully @03.84400s +00.00000s
|`->config-write-files ran successfully @03.84400s +00.00200s
|`->config-growpart ran successfully @03.84700s +00.36100s
|`->config-resizefs ran successfully @04.20900s +00.19200s
|`->config-disk_setup ran successfully @04.40100s +02.44800s
|`->config-mounts ran successfully @06.85000s +00.09400s
|`->config-set_hostname ran successfully @06.94400s +00.00900s
|`->config-update_hostname ran successfully @06.95400s +00.00100s
|`->config-update_etc_hosts ran successfully @06.95600s +00.00100s
|`->config-ca-certs ran successfully @06.95700s +00.00200s
|`->config-rsyslog ran successfully @06.95900s +00.00200s
|`->config-users-groups ran successfully @06.96100s +00.31600s
|`->config-ssh ran successfully @07.27800s +00.22700s
Finished stage: (init-network) 05.29900 seconds 

Starting stage: modules-config
|`->config-emit_upstart ran successfully @13.43300s +00.00100s
|`->config-snap ran successfully @13.43400s +00.00100s
|`->config-snap_config ran successfully @13.43600s +00.00100s
|`->config-ssh-import-id ran successfully @13.43700s +00.71900s
|`->config-locale ran successfully @14.15700s +01.08800s
|`->config-set-passwords ran successfully @15.24600s +00.00300s
|`->config-grub-dpkg ran successfully @15.24900s +01.17300s
|`->config-apt-pipelining ran successfully @16.42300s +00.00200s
|`->config-apt-configure ran successfully @16.42600s +00.26100s
|`->config-ubuntu-advantage ran successfully @16.68800s +00.00200s
|`->config-ntp ran successfully @16.69000s +00.00200s
|`->config-timezone ran successfully @16.69200s +00.00200s
|`->config-disable-ec2-metadata ran successfully @16.69400s +00.00100s
|`->config-runcmd ran successfully @16.69500s +00.00200s
|`->config-byobu ran successfully @16.69700s +00.00100s
Finished stage: (modules-config) 03.32800 seconds 

Starting stage: modules-final
|`->config-snappy ran successfully @17.25100s +00.00200s
|`->config-package-update-upgrade-install ran successfully @17.25400s +00.00100s
|`->config-fan ran successfully @17.25600s +00.00100s
|`->config-landscape ran successfully @17.25700s +00.00200s
|`->config-lxd ran successfully @17.25900s +00.00200s
|`->config-ubuntu-drivers ran successfully @17.26100s +00.00200s
|`->config-puppet ran successfully @17.26300s +00.00200s
|`->config-chef ran successfully @17.26500s +00.00100s
|`->config-mcollective ran successfully @17.26700s +00.00100s
|`->config-salt-minion ran successfully @17.26900s +00.00100s
|`->config-rightscale_userdata ran successfully @17.27000s +00.00200s
|`->config-scripts-vendor ran successfully @17.27200s +00.00100s
|`->config-scripts-per-once ran successfully @17.27400s +00.00100s
|`->config-scripts-per-boot ran successfully @17.27500s +00.00100s
|`->config-scripts-per-instance ran successfully @17.27700s +00.00300s
|`->config-scripts-user ran successfully @17.28100s +00.00100s
|`->config-ssh-authkey-fingerprints ran successfully @17.28300s +00.00800s
|`->config-keys-to-console ran successfully @17.29100s +00.15400s
|`->config-phone-home ran successfully @17.44700s +00.00200s
|`->config-final-message ran successfully @17.44900s +00.00900s
|`->config-power-state-change ran successfully @17.45800s +00.00200s
Finished stage: (modules-final) 00.26300 seconds 

Total Time: 17.65700 seconds

1 boot records analyzed
-- Boot Record 01 --
     02.44800s (init-network/config-disk_setup)
     01.17300s (modules-config/config-grub-dpkg)
     01.08800s (modules-config/config-locale)
     01.00300s (azure-ds/waiting-for-ssh-public-key)
     00.71900s (modules-config/config-ssh-import-id)
     00.36100s (init-network/config-growpart)
     00.31600s (init-network/config-users-groups)
     00.26100s (modules-config/config-apt-configure)
     00.22700s (init-network/config-ssh)
     00.21400s (azure-ds/invoke_agent)
     00.19200s (init-network/config-resizefs)
     00.15400s (modules-final/config-keys-to-console)
     00.09400s (init-network/config-mounts)
     00.06800s (init-local/search-NoCloud)
     00.04900s (azure-ds/_has_ntfs_filesystem)
     00.04500s (azure-ds/_get_metadata_from_imds)
     00.04000s (azure-ds/crtfile_to_pubkey)
     00.02600s (init-network/check-cache)
     00.02000s (init-local/search-ConfigDrive)
     00.02000s (azure-ds/parse_network_config)
     00.01400s (azure-ds/parse_network_config)
     00.00900s (modules-final/config-final-message)
     00.00900s (init-network/config-set_hostname)
     00.00800s (modules-final/config-ssh-authkey-fingerprints)
     00.00800s (init-network/consume-user-data)
     00.00800s (init-local/search-OpenNebula)
     00.00800s (init-local/search-DigitalOcean)
     00.00800s (azure-ds/check-platform-viability)
     00.00600s (azure-ds/list_possible_azure_ds_devs)
     00.00300s (modules-final/config-scripts-per-instance)
     00.00300s (modules-config/config-set-passwords)
     00.00200s (modules-final/config-ubuntu-drivers)
     00.00200s (modules-final/config-snappy)
     00.00200s (modules-final/config-rightscale_userdata)
     00.00200s (modules-final/config-puppet)
     00.00200s (modules-final/config-power-state-change)
     00.00200s (modules-final/config-phone-home)
     00.00200s (modules-final/config-lxd)
     00.00200s (modules-final/config-landscape)
     00.00200s (modules-config/config-ubuntu-advantage)
     00.00200s (modules-config/config-timezone)
     00.00200s (modules-config/config-runcmd)
     00.00200s (modules-config/config-ntp)
     00.00200s (modules-config/config-apt-pipelining)
     00.00200s (init-network/config-write-files)
     00.00200s (init-network/config-rsyslog)
     00.00200s (init-network/config-ca-certs)
     00.00200s (azure-ds/write_files)
     00.00200s (azure-ds/count_files)
     00.00100s (modules-final/config-scripts-vendor)
     00.00100s (modules-final/config-scripts-user)
     00.00100s (modules-final/config-scripts-per-once)
     00.00100s (modules-final/config-scripts-per-boot)
     00.00100s (modules-final/config-salt-minion)
     00.00100s (modules-final/config-package-update-upgrade-install)
     00.00100s (modules-final/config-mcollective)
     00.00100s (modules-final/config-fan)
     00.00100s (modules-final/config-chef)
     00.00100s (modules-config/config-snap_config)
     00.00100s (modules-config/config-snap)
     00.00100s (modules-config/config-emit_upstart)
     00.00100s (modules-config/config-disable-ec2-metadata)
     00.00100s (modules-config/config-byobu)
     00.00100s (init-network/config-update_hostname)
     00.00100s (init-network/config-update_etc_hosts)
     00.00100s (init-network/config-seed_random)
     00.00100s (init-network/config-migrator)
     00.00100s (init-local/check-cache)
     00.00100s (azure-ds/wait-for-ephemeral-disk)
     00.00100s (azure-ds/load_azure_ds_dir)
     00.00100s (azure-ds/_get_random_seed)
     00.00100s (azure-ds/_extract_preprovisioned_vm_setting)
     00.00000s (init-network/consume-vendor-data)
     00.00000s (init-network/config-bootcmd)
     00.00000s (azure-ds/temporary_hostname)
     00.00000s (azure-ds/load_azure_ovf_pubkeys)

1 boot records analyzed
Networking config
# This file is generated from information provided by
# the datasource.  Changes to it will not persist across an instance.
# To disable cloud-init's network configuration capabilities, write a file
# /etc/cloud/cloud.cfg.d/99-disable-network-config.cfg with the following:
# network: {config: disabled}
auto lo
iface lo inet loopback

auto eth0
iface eth0 inet dhcp
  cloud-init
Get:1 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 cloud-init all 19.2-36-g059d049c-0ubuntu1~16.04.1 [408 kB]
Preparing to unpack .../cloud-init_19.2-36-g059d049c-0ubuntu1~16.04.1_all.deb ...
Unpacking cloud-init (19.2-36-g059d049c-0ubuntu1~16.04.1) over (19.1-1-gbaa47854-0ubuntu1~16.04.1) ...
Setting up cloud-init (19.2-36-g059d049c-0ubuntu1~16.04.1) ...
Leaving 'diversion of /etc/init/ureadahead.conf to /etc/init/ureadahead.conf.disabled by cloud-init'
cloud-init	19.2-36-g059d049c-0ubuntu1~16.04.1
sudo: unable to resolve host SRU-worked-azure
sudo: unable to resolve host SRU-didnt-work
sudo: unable to resolve host SRU-didnt-work
Connection to 104.208.235.47 closed by remote host.

status: done
time: Thu, 19 Sep 2019 12:13:37 +0000
detail:
DataSourceAzure [seed=/var/lib/waagent]
sudo: unable to resolve host SRU-worked-azure
{
 "v1": {
  "datasource": "DataSourceAzure [seed=/var/lib/waagent]",
  "errors": []
 }
}
sudo: unable to resolve host SRU-worked-azure
          2.773s cloud-init-local.service
          1.658s cloud-init.service
          1.549s cloud-config.service
          1.300s dev-sda1.device
           822ms snapd.service
           693ms accounts-daemon.service
           660ms cloud-final.service
           630ms networking.service
           609ms lxd-containers.service
           548ms grub-common.service
           452ms iscsid.service
           330ms lvm2-monitor.service
           323ms mdadm.service
           235ms apparmor.service
           210ms console-setup.service
           208ms open-iscsi.service
           200ms kmod-static-nodes.service
           199ms systemd-remount-fs.service
           181ms resolvconf.service
           173ms ufw.service
           162ms irqbalance.service
           161ms polkitd.service
           153ms keyboard-setup.service
           152ms apport.service
           149ms dev-mqueue.mount
           145ms systemd-logind.service
           141ms sys-kernel-debug.mount
           136ms ondemand.service
           122ms ssh.service
           111ms rsyslog.service
           103ms systemd-udev-trigger.service
            96ms snapd.socket
            91ms systemd-modules-load.service
            87ms systemd-journald.service
            66ms systemd-journal-flush.service
            60ms sys-fs-fuse-connections.mount
            56ms systemd-sysctl.service
            56ms systemd-tmpfiles-setup-dev.service
            55ms systemd-user-sessions.service
            52ms systemd-random-seed.service
            48ms lxd.socket
            45ms sys-kernel-config.mount
            44ms systemd-tmpfiles-setup.service
            41ms plymouth-quit.service
            40ms rc-local.service
            33ms systemd-fsck@dev-disk-cloud-azure_resource\x2dpart1.service
            33ms systemd-update-utmp.service
            30ms setvtrgb.service
            30ms plymouth-quit-wait.service
            28ms systemd-udevd.service
            21ms snapd.seeded.service
            19ms plymouth-read-write.service
            19ms systemd-update-utmp-runlevel.service
            18ms user@1000.service
            18ms dev-hugepages.mount
            18ms systemd-timesyncd.service
            12ms ephemeral-disk-warning.service
-- Boot Record 01 --
The total time elapsed since completing an event is printed after the "@" character.
The time the event takes is printed after the "+" character.

Starting stage: init-local
|`->no cache found @00.00600s +00.00100s
|`->no local data found from DataSourceNoCloud @00.07500s +00.49500s
|`->no local data found from DataSourceConfigDrive @00.57100s +00.49500s
|`->no local data found from DataSourceOpenNebula @01.06600s +00.28000s
|`->no local data found from DataSourceDigitalOcean @01.34700s +00.00900s
Starting stage: init-local/search-Azure
Starting stage: azure-ds/_get_data
|`->found azure asset tag @01.35700s +00.00800s
|`->get_boot_telemetry @01.36600s +00.01100s
|`->get_system_info @01.37800s +00.00100s
Starting stage: azure-ds/crawl_metadata
|`->list_possible_azure_ds_devs @01.38000s +00.21000s
|`->load_azure_ds_dir @01.59000s +00.00000s
Starting stage: azure-ds/load_azure_ds_dir
Starting stage: azure-ds/read_azure_ovf
|`->load_azure_ovf_pubkeys @01.59400s +00.00000s
|`->_extract_preprovisioned_vm_setting @01.59500s +00.00000s
Finished stage: (azure-ds/read_azure_ovf) 00.00400 seconds 

Finished stage: (azure-ds/load_azure_ds_dir) 00.00400 seconds 

Starting stage: azure-ds/get_metadata_from_imds
|`->obtain dhcp lease @01.60900s +00.13000s
|`->_get_metadata_from_imds @01.73900s +00.01200s
Finished stage: (azure-ds/get_metadata_from_imds) 00.19500 seconds 

|`->_get_random_seed @01.80300s +00.00100s
Finished stage: (azure-ds/crawl_metadata) 00.43300 seconds 

|`->write_files @01.81300s +00.00300s
Finished stage: (azure-ds/_get_data) 00.45900 seconds 

Finished stage: (init-local/search-Azure) 00.46200 seconds 

|`->network config from fallback @01.88900s +00.02300s
Finished stage: (init-local) 01.93100 seconds 

Starting stage: init-network
|`->restored from cache with run check: DataSourceAzure [seed=/var/lib/waagent] @02.98100s +00.02400s
|`->network config from fallback @03.06500s +00.01800s
Starting stage: init-network/setup-datasource
Starting stage: azure-ds/setup
Starting stage: azure-ds/_negotiate
Starting stage: azure-ds/get_metadata_from_agent
Starting stage: azure-ds/bounce_network_with_azure_hostname
|`->temporary_hostname @03.09400s +00.00000s
Finished stage: (azure-ds/bounce_network_with_azure_hostname) 00.00300 seconds 

|`->invoke_agent @03.09800s +00.18200s
|`->wait for agents to retrieve ssh keys @03.28000s +00.00100s
Starting stage: azure-ds/pubkeys_from_crt_files
|`->crtfile_to_pubkey @03.28200s +00.01400s
Finished stage: (azure-ds/pubkeys_from_crt_files) 00.01500 seconds 

Finished stage: (azure-ds/get_metadata_from_agent) 00.20300 seconds 

Finished stage: (azure-ds/_negotiate) 00.20400 seconds 

Finished stage: (azure-ds/setup) 00.20400 seconds 

Finished stage: (init-network/setup-datasource) 00.20400 seconds 

|`->reading and applying user-data @03.30600s +00.00800s
|`->reading and applying vendor-data @03.31500s +00.00000s
Starting stage: init-network/activate-datasource
Starting stage: azure-ds/activate
Starting stage: azure-ds/address_ephemeral_resize
|`->wait for ephemeral disk @03.34700s +00.00100s
Starting stage: azure-ds/can_dev_be_reformatted
|`->_has_ntfs_filesystem @03.34800s +00.12300s
Finished stage: (azure-ds/can_dev_be_reformatted) 00.12300 seconds 

Finished stage: (azure-ds/address_ephemeral_resize) 00.12400 seconds 

Finished stage: (azure-ds/activate) 00.12400 seconds 

Finished stage: (init-network/activate-datasource) 00.12600 seconds 

|`->config-migrator ran successfully @03.49900s +00.00100s
|`->config-seed_random ran successfully @03.50000s +00.00600s
|`->config-bootcmd ran successfully @03.50700s +00.00000s
|`->config-write-files ran successfully @03.50700s +00.00100s
|`->config-growpart ran successfully @03.50800s +00.05000s
|`->config-resizefs ran successfully @03.55800s +00.01800s
|`->config-disk_setup ran successfully @03.57600s +00.20100s
|`->config-mounts ran successfully @03.77700s +00.14600s
|`->config-set_hostname ran successfully @03.92400s +00.00600s
|`->config-update_hostname ran successfully @03.93100s +00.00100s
|`->config-update_etc_hosts ran successfully @03.93300s +00.00000s
|`->config-ca-certs ran successfully @03.93300s +00.00100s
|`->config-rsyslog ran successfully @03.93500s +00.00100s
|`->config-users-groups ran successfully @03.93600s +00.15800s
|`->config-ssh ran successfully @04.09500s +00.14300s
Finished stage: (init-network) 01.27200 seconds 

Starting stage: modules-config
|`->config-emit_upstart ran successfully @05.93200s +00.00100s
|`->config-snap ran successfully @05.93300s +00.00200s
|`->config-snap_config ran successfully @05.93500s +00.00200s
|`->config-ssh-import-id ran successfully @05.93700s +00.60500s
|`->config-locale ran successfully @06.54300s +00.00200s
|`->config-set-passwords ran successfully @06.54500s +00.00200s
|`->config-grub-dpkg ran successfully @06.54700s +00.36700s
|`->config-apt-pipelining ran successfully @06.91500s +00.00100s
|`->config-apt-configure ran successfully @06.91600s +00.10800s
|`->config-ubuntu-advantage ran successfully @07.02400s +00.00200s
|`->config-ntp ran successfully @07.02700s +00.00100s
|`->config-timezone ran successfully @07.02900s +00.00100s
|`->config-disable-ec2-metadata ran successfully @07.03100s +00.00000s
|`->config-runcmd ran successfully @07.03200s +00.00100s
|`->config-byobu ran successfully @07.03300s +00.00200s
Finished stage: (modules-config) 01.12200 seconds 

Starting stage: modules-final
|`->config-snappy ran successfully @07.54900s +00.00200s
|`->config-package-update-upgrade-install ran successfully @07.55100s +00.00200s
|`->config-fan ran successfully @07.55300s +00.00200s
|`->config-landscape ran successfully @07.55600s +00.00100s
|`->config-lxd ran successfully @07.55700s +00.00200s
|`->config-ubuntu-drivers ran successfully @07.55900s +00.00100s
|`->config-puppet ran successfully @07.56100s +00.00100s
|`->config-chef ran successfully @07.56200s +00.00200s
|`->config-mcollective ran successfully @07.56400s +00.00200s
|`->config-salt-minion ran successfully @07.56600s +00.00100s
|`->config-rightscale_userdata ran successfully @07.56800s +00.00100s
|`->config-scripts-vendor ran successfully @07.57000s +00.00100s
|`->config-scripts-per-once ran successfully @07.57100s +00.00200s
|`->config-scripts-per-boot ran successfully @07.57300s +00.00100s
|`->config-scripts-per-instance ran successfully @07.57400s +00.00200s
|`->config-scripts-user ran successfully @07.57600s +00.00100s
|`->config-ssh-authkey-fingerprints ran successfully @07.57800s +00.06000s
|`->config-keys-to-console ran successfully @07.63800s +00.09400s
|`->config-phone-home ran successfully @07.73300s +00.00200s
|`->config-final-message ran successfully @07.73500s +00.00500s
|`->config-power-state-change ran successfully @07.74000s +00.00200s
Finished stage: (modules-final) 00.21400 seconds 

Total Time: 7.42600 seconds

1 boot records analyzed
-- Boot Record 01 --
     00.60500s (modules-config/config-ssh-import-id)
     00.49500s (init-local/search-NoCloud)
     00.49500s (init-local/search-ConfigDrive)
     00.36700s (modules-config/config-grub-dpkg)
     00.28000s (init-local/search-OpenNebula)
     00.21000s (azure-ds/list_possible_azure_ds_devs)
     00.20100s (init-network/config-disk_setup)
     00.18200s (azure-ds/invoke_agent)
     00.15800s (init-network/config-users-groups)
     00.14600s (init-network/config-mounts)
     00.14300s (init-network/config-ssh)
     00.13000s (azure-ds/obtain-dhcp-lease)
     00.12300s (azure-ds/_has_ntfs_filesystem)
     00.10800s (modules-config/config-apt-configure)
     00.09400s (modules-final/config-keys-to-console)
     00.06000s (modules-final/config-ssh-authkey-fingerprints)
     00.05000s (init-network/config-growpart)
     00.02400s (init-network/check-cache)
     00.02300s (azure-ds/parse_network_config)
     00.01800s (init-network/config-resizefs)
     00.01800s (azure-ds/parse_network_config)
     00.01400s (azure-ds/crtfile_to_pubkey)
     00.01200s (azure-ds/_get_metadata_from_imds)
     00.01100s (azure-ds/get_boot_telemetry)
     00.00900s (init-local/search-DigitalOcean)
     00.00800s (init-network/consume-user-data)
     00.00800s (azure-ds/check-platform-viability)
     00.00600s (init-network/config-set_hostname)
     00.00600s (init-network/config-seed_random)
     00.00500s (modules-final/config-final-message)
     00.00300s (azure-ds/write_files)
     00.00200s (modules-final/config-snappy)
     00.00200s (modules-final/config-scripts-per-once)
     00.00200s (modules-final/config-scripts-per-instance)
     00.00200s (modules-final/config-power-state-change)
     00.00200s (modules-final/config-phone-home)
     00.00200s (modules-final/config-package-update-upgrade-install)
     00.00200s (modules-final/config-mcollective)
     00.00200s (modules-final/config-lxd)
     00.00200s (modules-final/config-fan)
     00.00200s (modules-final/config-chef)
     00.00200s (modules-config/config-ubuntu-advantage)
     00.00200s (modules-config/config-snap_config)
     00.00200s (modules-config/config-snap)
     00.00200s (modules-config/config-set-passwords)
     00.00200s (modules-config/config-locale)
     00.00200s (modules-config/config-byobu)
     00.00100s (modules-final/config-ubuntu-drivers)
     00.00100s (modules-final/config-scripts-vendor)
     00.00100s (modules-final/config-scripts-user)
     00.00100s (modules-final/config-scripts-per-boot)
     00.00100s (modules-final/config-salt-minion)
     00.00100s (modules-final/config-rightscale_userdata)
     00.00100s (modules-final/config-puppet)
     00.00100s (modules-final/config-landscape)
     00.00100s (modules-config/config-timezone)
     00.00100s (modules-config/config-runcmd)
     00.00100s (modules-config/config-ntp)
     00.00100s (modules-config/config-emit_upstart)
     00.00100s (modules-config/config-apt-pipelining)
     00.00100s (init-network/config-write-files)
     00.00100s (init-network/config-update_hostname)
     00.00100s (init-network/config-rsyslog)
     00.00100s (init-network/config-migrator)
     00.00100s (init-network/config-ca-certs)
     00.00100s (init-local/check-cache)
     00.00100s (azure-ds/waiting-for-ssh-public-key)
     00.00100s (azure-ds/wait-for-ephemeral-disk)
     00.00100s (azure-ds/get_system_info)
     00.00100s (azure-ds/_get_random_seed)
     00.00000s (modules-config/config-disable-ec2-metadata)
     00.00000s (init-network/consume-vendor-data)
     00.00000s (init-network/config-update_etc_hosts)
     00.00000s (init-network/config-bootcmd)
     00.00000s (azure-ds/temporary_hostname)
     00.00000s (azure-ds/load_azure_ovf_pubkeys)
     00.00000s (azure-ds/load_azure_ds_dir)
     00.00000s (azure-ds/_extract_preprovisioned_vm_setting)

1 boot records analyzed
After upgrade Networking config
# This file is generated from information provided by
# the datasource.  Changes to it will not persist across an instance.
# To disable cloud-init's network configuration capabilities, write a file
# /etc/cloud/cloud.cfg.d/99-disable-network-config.cfg with the following:
# network: {config: disabled}
auto lo
iface lo inet loopback

auto eth0
iface eth0 inet dhcp
cloud-region: azure-eastus2
Get cloud-id
azure
cloud-region: azure-eastus2
Validating whether metadata is being updated per boot LP:1819913
2019-09-19 12:13:29,652 - __init__.py[DEBUG]: Update datasource metadata and network config due to events: New instance first boot
2019-09-19 12:13:30,149 - __init__.py[DEBUG]: Update datasource metadata and network config due to events: New instance first boot
2019-09-19 12:13:30,644 - __init__.py[DEBUG]: Update datasource metadata and network config due to events: New instance first boot
2019-09-19 12:13:30,924 - __init__.py[DEBUG]: Update datasource metadata and network config due to events: New instance first boot
2019-09-19 12:13:30,934 - __init__.py[DEBUG]: Update datasource metadata and network config due to events: New instance first boot
sudo: unable to resolve host SRU-worked-azure
Connection to 104.208.235.47 closed by remote host.
After reboot
2019-09-19 12:13:29,652 - __init__.py[DEBUG]: Update datasource metadata and network config due to events: New instance first boot
2019-09-19 12:13:30,149 - __init__.py[DEBUG]: Update datasource metadata and network config due to events: New instance first boot
2019-09-19 12:13:30,644 - __init__.py[DEBUG]: Update datasource metadata and network config due to events: New instance first boot
2019-09-19 12:13:30,924 - __init__.py[DEBUG]: Update datasource metadata and network config due to events: New instance first boot
2019-09-19 12:13:30,934 - __init__.py[DEBUG]: Update datasource metadata and network config due to events: New instance first boot
2019-09-19 12:14:40,185 - __init__.py[DEBUG]: Update datasource metadata and network config due to events: New instance first boot
2019-09-19 12:14:40,691 - __init__.py[DEBUG]: Update datasource metadata and network config due to events: New instance first boot
2019-09-19 12:14:41,176 - __init__.py[DEBUG]: Update datasource metadata and network config due to events: New instance first boot
2019-09-19 12:14:41,488 - __init__.py[DEBUG]: Update datasource metadata and network config due to events: New instance first boot
2019-09-19 12:14:41,497 - __init__.py[DEBUG]: Update datasource metadata and network config due to events: New instance first boot
2019-09-19 12:14:42,144 - __init__.py[DEBUG]: Update datasource metadata and network config due to events: System boot
### END xenial
### BEGIN bionic
Creating standard network vm
{
  "fqdns": "",
  "id": "/subscriptions/12aad61c-6de4-4e53-a6c6-5aff52a83777/resourceGroups/srugroup1/providers/Microsoft.Compute/virtualMachines/test-sru-bionic",
  "location": "eastus2",
  "macAddress": "00-0D-3A-7D-10-CD",
  "powerState": "VM running",
  "privateIpAddress": "192.168.1.4",
  "publicIpAddress": "104.209.133.61",
  "resourceGroup": "srugroup1",
  "zones": ""
}

status: done
time: Fri, 20 Sep 2019 07:37:53 +0000
detail:
DataSourceAzure [seed=/dev/sr0]
cloud-init	19.2-24-ge7881d5c-0ubuntu1~18.04.1
{
 "v1": {
  "datasource": "DataSourceAzure [seed=/dev/sr0]",
  "errors": []
 }
}
Startup finished in 6.187s (kernel) + 31.395s (userspace) = 37.582s
graphical.target reached after 30.477s in userspace
          9.213s cloud-init.service
          4.443s cloud-init-local.service
          3.577s snapd.seeded.service
          3.125s cloud-config.service
          2.644s lxd-containers.service
          2.436s snapd.service
          2.345s pollinate.service
          2.205s dev-sda1.device
          1.796s systemd-networkd-wait-online.service
          1.426s apparmor.service
          1.181s networkd-dispatcher.service
           907ms cloud-final.service
           832ms accounts-daemon.service
           632ms grub-common.service
           506ms systemd-udev-trigger.service
           496ms keyboard-setup.service
           460ms systemd-timesyncd.service
           430ms apport.service
           403ms systemd-user-sessions.service
           362ms lvm2-monitor.service
           357ms systemd-modules-load.service
           349ms polkit.service
           345ms systemd-journald.service
           318ms rsyslog.service
           261ms systemd-logind.service
           189ms snapd.socket
           174ms user@1000.service
           170ms ebtables.service
           169ms ufw.service
           166ms kmod-static-nodes.service
           165ms dev-hugepages.mount
           164ms dev-mqueue.mount
           159ms ephemeral-disk-warning.service
           154ms systemd-udevd.service
           148ms systemd-networkd.service
           145ms systemd-tmpfiles-setup-dev.service
           134ms ssh.service
           117ms systemd-journal-flush.service
           106ms systemd-resolved.service
           106ms lxd.socket
            98ms setvtrgb.service
            89ms systemd-remount-fs.service
            83ms sys-kernel-debug.mount
            78ms systemd-sysctl.service
            77ms systemd-machine-id-commit.service
            74ms systemd-tmpfiles-setup.service
            62ms plymouth-read-write.service
            57ms blk-availability.service
            54ms systemd-random-seed.service
            52ms console-setup.service
            51ms sys-kernel-config.mount
            49ms sys-fs-fuse-connections.mount
            31ms systemd-update-utmp.service
            27ms boot-efi.mount
            27ms plymouth-quit-wait.service
            27ms plymouth-quit.service
            17ms systemd-update-utmp-runlevel.service
-- Boot Record 01 --
The total time elapsed since completing an event is printed after the "@" character.
The time the event takes is printed after the "+" character.

Starting stage: init-local
|`->no cache found @00.00700s +00.00100s
Starting stage: init-local/search-Azure
Starting stage: azure-ds/_get_data
|`->found azure asset tag @00.12200s +00.00900s
|`->get_boot_telemetry @00.13100s +00.01500s
|`->get_system_info @00.14700s +00.00000s
Starting stage: azure-ds/crawl_metadata
|`->list_possible_azure_ds_devs @00.14800s +00.04100s
|`->load_azure_ds_dir @00.18900s +00.00000s
Starting stage: azure-ds/load_azure_ds_dir
Starting stage: azure-ds/read_azure_ovf
|`->load_azure_ovf_pubkeys @00.30800s +00.00000s
|`->_extract_preprovisioned_vm_setting @00.30800s +00.00000s
Finished stage: (azure-ds/read_azure_ovf) 00.01100 seconds 

Finished stage: (azure-ds/load_azure_ds_dir) 00.01500 seconds 

Starting stage: azure-ds/get_metadata_from_imds
|`->obtain dhcp lease @00.34000s +00.39500s
|`->_get_metadata_from_imds @00.73600s +00.02500s
Finished stage: (azure-ds/get_metadata_from_imds) 00.44500 seconds 

|`->_get_random_seed @00.78600s +00.00000s
Finished stage: (azure-ds/crawl_metadata) 00.64800 seconds 

|`->maybe_remove_ubuntu_network_config_scripts @00.79700s +00.00000s
|`->write_files @00.79800s +00.00300s
Finished stage: (azure-ds/_get_data) 00.67900 seconds 

Finished stage: (init-local/search-Azure) 00.68200 seconds 

|`->network config from imds @00.87600s +00.00100s
Finished stage: (init-local) 01.10600 seconds 

Starting stage: init-network
|`->restored from cache with run check: DataSourceAzure [seed=/dev/sr0] @03.68300s +00.03100s
|`->network config from imds @03.76700s +00.00100s
Starting stage: init-network/setup-datasource
Starting stage: azure-ds/setup
Starting stage: azure-ds/_negotiate
Starting stage: azure-ds/bounce_network_with_azure_hostname
|`->temporary_hostname @03.77900s +00.00000s
Finished stage: (azure-ds/bounce_network_with_azure_hostname) 00.00300 seconds 

Starting stage: azure-ds/get_metadata_from_fabric
Starting stage: azure-ds/register_with_azure_and_fetch_data
|`->generate_certificate @03.78300s +00.22900s
Starting stage: azure-ds/find_endpoint
|`->_networkd_get_value_from_leases @04.01200s +00.00100s
Finished stage: (azure-ds/find_endpoint) 00.00100 seconds 

Starting stage: azure-ds/parse_certificates
|`->_decrypt_certs_from_xml @04.03600s +00.01600s
Starting stage: azure-ds/_get_ssh_key_from_cert
|`->_run_x509_action @04.05500s +00.00700s
Finished stage: (azure-ds/_get_ssh_key_from_cert) 00.14800 seconds 

Starting stage: azure-ds/_get_fingerprint_from_cert
|`->_run_x509_action @04.20100s +00.01100s
Finished stage: (azure-ds/_get_fingerprint_from_cert) 00.01100 seconds 

Finished stage: (azure-ds/parse_certificates) 00.17600 seconds 

|`->_report_ready @04.21200s +02.62100s
Finished stage: (azure-ds/register_with_azure_and_fetch_data) 03.05000 seconds 

Finished stage: (azure-ds/get_metadata_from_fabric) 03.05100 seconds 

Finished stage: (azure-ds/_negotiate) 03.05600 seconds 

Finished stage: (azure-ds/setup) 03.05700 seconds 

Finished stage: (init-network/setup-datasource) 03.05700 seconds 

|`->reading and applying user-data @06.84400s +00.01300s
|`->reading and applying vendor-data @06.85700s +00.00100s
Starting stage: init-network/activate-datasource
Starting stage: azure-ds/activate
Starting stage: azure-ds/address_ephemeral_resize
|`->wait for ephemeral disk @06.90100s +00.00000s
Starting stage: azure-ds/can_dev_be_reformatted
|`->_has_ntfs_filesystem @06.90100s +00.12700s
Starting stage: azure-ds/mount-ntfs-and-count
|`->count_files @07.11700s +00.00300s
Finished stage: (azure-ds/mount-ntfs-and-count) 00.11000 seconds 

Finished stage: (azure-ds/can_dev_be_reformatted) 00.23800 seconds 

Finished stage: (azure-ds/address_ephemeral_resize) 00.23800 seconds 

Finished stage: (azure-ds/activate) 00.23900 seconds 

Finished stage: (init-network/activate-datasource) 00.24100 seconds 

|`->config-migrator ran successfully @07.20900s +00.00100s
|`->config-seed_random ran successfully @07.21100s +00.00100s
|`->config-bootcmd ran successfully @07.21200s +00.00100s
|`->config-write-files ran successfully @07.21300s +00.00200s
|`->config-growpart ran successfully @07.21500s +00.64200s
|`->config-resizefs ran successfully @07.85800s +01.32800s
|`->config-disk_setup ran successfully @09.18700s +02.41000s
|`->config-mounts ran successfully @11.59900s +00.19200s
|`->config-set_hostname ran successfully @11.79200s +00.00700s
|`->config-update_hostname ran successfully @11.80000s +00.00100s
|`->config-update_etc_hosts ran successfully @11.80200s +00.00000s
|`->config-ca-certs ran successfully @11.80300s +00.00100s
|`->config-rsyslog ran successfully @11.80400s +00.00100s
|`->config-users-groups ran successfully @11.80600s +00.28400s
|`->config-ssh ran successfully @12.09000s +00.18600s
Finished stage: (init-network) 08.60900 seconds 

Starting stage: modules-config
|`->config-emit_upstart ran successfully @19.72700s +00.00100s
|`->config-snap ran successfully @19.72800s +00.00100s
|`->config-snap_config ran successfully @19.73000s +00.00200s
|`->config-ssh-import-id ran successfully @19.73200s +00.80900s
|`->config-locale ran successfully @20.54300s +00.00100s
|`->config-set-passwords ran successfully @20.54500s +00.00300s
|`->config-grub-dpkg ran successfully @20.54800s +01.29300s
|`->config-apt-pipelining ran successfully @21.84200s +00.00100s
|`->config-apt-configure ran successfully @21.84400s +00.27200s
|`->config-ubuntu-advantage ran successfully @22.11600s +00.00100s
|`->config-ntp ran successfully @22.11800s +00.00100s
|`->config-timezone ran successfully @22.11900s +00.00100s
|`->config-disable-ec2-metadata ran successfully @22.12100s +00.00000s
|`->config-runcmd ran successfully @22.12200s +00.00100s
|`->config-byobu ran successfully @22.12300s +00.00100s
Finished stage: (modules-config) 02.45700 seconds 

Starting stage: modules-final
|`->config-snappy ran successfully @22.99800s +00.00200s
|`->config-package-update-upgrade-install ran successfully @23.00100s +00.00100s
|`->config-fan ran successfully @23.00200s +00.00100s
|`->config-landscape ran successfully @23.00400s +00.00100s
|`->config-lxd ran successfully @23.00500s +00.00100s
|`->config-ubuntu-drivers ran successfully @23.00700s +00.00100s
|`->config-puppet ran successfully @23.00800s +00.00100s
|`->config-chef ran successfully @23.01000s +00.00100s
|`->config-mcollective ran successfully @23.01100s +00.00100s
|`->config-salt-minion ran successfully @23.01300s +00.00100s
|`->config-rightscale_userdata ran successfully @23.01500s +00.00000s
|`->config-scripts-vendor ran successfully @23.01600s +00.00100s
|`->config-scripts-per-once ran successfully @23.01700s +00.00100s
|`->config-scripts-per-boot ran successfully @23.01900s +00.00000s
|`->config-scripts-per-instance ran successfully @23.02000s +00.00100s
|`->config-scripts-user ran successfully @23.02100s +00.00100s
|`->config-ssh-authkey-fingerprints ran successfully @23.02200s +00.05100s
|`->config-keys-to-console ran successfully @23.07400s +00.10100s
|`->config-phone-home ran successfully @23.17600s +00.00200s
|`->config-final-message ran successfully @23.17900s +00.00600s
|`->config-power-state-change ran successfully @23.18600s +00.00100s
Finished stage: (modules-final) 00.23100 seconds 

Total Time: 31.55900 seconds

1 boot records analyzed
-- Boot Record 01 --
     02.62100s (azure-ds/_report_ready)
     02.41000s (init-network/config-disk_setup)
     01.32800s (init-network/config-resizefs)
     01.29300s (modules-config/config-grub-dpkg)
     00.80900s (modules-config/config-ssh-import-id)
     00.64200s (init-network/config-growpart)
     00.39500s (azure-ds/obtain-dhcp-lease)
     00.28400s (init-network/config-users-groups)
     00.27200s (modules-config/config-apt-configure)
     00.22900s (azure-ds/generate_certificate)
     00.19200s (init-network/config-mounts)
     00.18600s (init-network/config-ssh)
     00.12700s (azure-ds/_has_ntfs_filesystem)
     00.10100s (modules-final/config-keys-to-console)
     00.05100s (modules-final/config-ssh-authkey-fingerprints)
     00.04100s (azure-ds/list_possible_azure_ds_devs)
     00.03100s (init-network/check-cache)
     00.02500s (azure-ds/_get_metadata_from_imds)
     00.01600s (azure-ds/_decrypt_certs_from_xml)
     00.01500s (azure-ds/get_boot_telemetry)
     00.01300s (init-network/consume-user-data)
     00.01100s (azure-ds/_run_x509_action)
     00.00900s (azure-ds/check-platform-viability)
     00.00700s (init-network/config-set_hostname)
     00.00700s (azure-ds/_run_x509_action)
     00.00600s (modules-final/config-final-message)
     00.00300s (modules-config/config-set-passwords)
     00.00300s (azure-ds/write_files)
     00.00300s (azure-ds/count_files)
     00.00200s (modules-final/config-snappy)
     00.00200s (modules-final/config-phone-home)
     00.00200s (modules-config/config-snap_config)
     00.00200s (init-network/config-write-files)
     00.00100s (modules-final/config-ubuntu-drivers)
     00.00100s (modules-final/config-scripts-vendor)
     00.00100s (modules-final/config-scripts-user)
     00.00100s (modules-final/config-scripts-per-once)
     00.00100s (modules-final/config-scripts-per-instance)
     00.00100s (modules-final/config-salt-minion)
     00.00100s (modules-final/config-puppet)
     00.00100s (modules-final/config-power-state-change)
     00.00100s (modules-final/config-package-update-upgrade-install)
     00.00100s (modules-final/config-mcollective)
     00.00100s (modules-final/config-lxd)
     00.00100s (modules-final/config-landscape)
     00.00100s (modules-final/config-fan)
     00.00100s (modules-final/config-chef)
     00.00100s (modules-config/config-ubuntu-advantage)
     00.00100s (modules-config/config-timezone)
     00.00100s (modules-config/config-snap)
     00.00100s (modules-config/config-runcmd)
     00.00100s (modules-config/config-ntp)
     00.00100s (modules-config/config-locale)
     00.00100s (modules-config/config-emit_upstart)
     00.00100s (modules-config/config-byobu)
     00.00100s (modules-config/config-apt-pipelining)
     00.00100s (init-network/consume-vendor-data)
     00.00100s (init-network/config-update_hostname)
     00.00100s (init-network/config-seed_random)
     00.00100s (init-network/config-rsyslog)
     00.00100s (init-network/config-migrator)
     00.00100s (init-network/config-ca-certs)
     00.00100s (init-network/config-bootcmd)
     00.00100s (init-local/check-cache)
     00.00100s (azure-ds/parse_network_config)
     00.00100s (azure-ds/parse_network_config)
     00.00100s (azure-ds/_networkd_get_value_from_leases)
     00.00000s (modules-final/config-scripts-per-boot)
     00.00000s (modules-final/config-rightscale_userdata)
     00.00000s (modules-config/config-disable-ec2-metadata)
     00.00000s (init-network/config-update_etc_hosts)
     00.00000s (azure-ds/wait-for-ephemeral-disk)
     00.00000s (azure-ds/temporary_hostname)
     00.00000s (azure-ds/maybe_remove_ubuntu_network_config_scripts)
     00.00000s (azure-ds/load_azure_ovf_pubkeys)
     00.00000s (azure-ds/load_azure_ds_dir)
     00.00000s (azure-ds/get_system_info)
     00.00000s (azure-ds/_get_random_seed)
     00.00000s (azure-ds/_extract_preprovisioned_vm_setting)

1 boot records analyzed
Networking config
# This file is generated from information provided by
# the datasource.  Changes to it will not persist across an instance.
# To disable cloud-init's network configuration capabilities, write a file
# /etc/cloud/cloud.cfg.d/99-disable-network-config.cfg with the following:
# network: {config: disabled}
network:
    ethernets:
        eth0:
            dhcp4: true
            dhcp4-overrides:
                route-metric: 100
            match:
                macaddress: 00:0d:3a:7d:10:cd
            set-name: eth0
    version: 2
  cloud-init
Get:1 http://archive.ubuntu.com/ubuntu bionic-proposed/main amd64 cloud-init all 19.2-36-g059d049c-0ubuntu1~18.04.1 [404 kB]
Preparing to unpack .../cloud-init_19.2-36-g059d049c-0ubuntu1~18.04.1_all.deb ...
Unpacking cloud-init (19.2-36-g059d049c-0ubuntu1~18.04.1) over (19.2-24-ge7881d5c-0ubuntu1~18.04.1) ...
Setting up cloud-init (19.2-36-g059d049c-0ubuntu1~18.04.1) ...
cloud-init	19.2-36-g059d049c-0ubuntu1~18.04.1
Connection to 104.209.133.61 closed by remote host.

status: done
time: Fri, 20 Sep 2019 07:39:49 +0000
detail:
DataSourceAzure [seed=/var/lib/waagent]
{
 "v1": {
  "datasource": "DataSourceAzure [seed=/var/lib/waagent]",
  "errors": []
 }
}
          2.938s cloud-config.service
          1.945s cloud-init.service
          1.866s systemd-networkd-wait-online.service
          1.744s cloud-init-local.service
          1.599s dev-sda1.device
          1.147s snapd.service
          1.128s lxd-containers.service
           983ms networkd-dispatcher.service
           910ms cloud-final.service
           645ms grub-common.service
           609ms apparmor.service
           550ms accounts-daemon.service
           544ms apport.service
           414ms systemd-timesyncd.service
           398ms systemd-udev-trigger.service
           391ms keyboard-setup.service
           388ms lvm2-monitor.service
           300ms systemd-logind.service
           298ms polkit.service
           291ms ssh.service
           290ms systemd-journald.service
           288ms ebtables.service
           224ms ufw.service
           223ms systemd-user-sessions.service
           222ms systemd-modules-load.service
           221ms dev-mqueue.mount
           217ms blk-availability.service
           186ms dev-hugepages.mount
           174ms sys-kernel-debug.mount
           133ms systemd-random-seed.service
           128ms snapd.socket
           128ms systemd-remount-fs.service
           127ms kmod-static-nodes.service
           125ms systemd-sysctl.service
           122ms rsyslog.service
           121ms sys-fs-fuse-connections.mount
           118ms sys-kernel-config.mount
           115ms systemd-tmpfiles-setup-dev.service
           107ms systemd-journal-flush.service
           103ms lxd.socket
            82ms systemd-tmpfiles-setup.service
            76ms setvtrgb.service
            66ms systemd-update-utmp.service
            65ms systemd-resolved.service
            55ms console-setup.service
            55ms systemd-fsck@dev-disk-cloud-azure_resource\x2dpart1.service
            53ms systemd-networkd.service
            53ms snapd.seeded.service
            50ms user@1000.service
            47ms boot-efi.mount
            37ms systemd-udevd.service
            32ms systemd-update-utmp-runlevel.service
            29ms plymouth-read-write.service
            22ms plymouth-quit.service
            20ms plymouth-quit-wait.service
            18ms ephemeral-disk-warning.service
-- Boot Record 01 --
The total time elapsed since completing an event is printed after the "@" character.
The time the event takes is printed after the "+" character.

Starting stage: init-local
|`->no cache found @00.00500s +00.00200s
Starting stage: init-local/search-Azure
Starting stage: azure-ds/_get_data
|`->found azure asset tag @00.04600s +00.00900s
|`->get_boot_telemetry @00.05500s +00.01500s
|`->get_system_info @00.07000s +00.00100s
Starting stage: azure-ds/crawl_metadata
|`->list_possible_azure_ds_devs @00.07100s +00.16600s
|`->load_azure_ds_dir @00.23800s +00.00000s
Starting stage: azure-ds/load_azure_ds_dir
Starting stage: azure-ds/read_azure_ovf
|`->load_azure_ovf_pubkeys @00.24300s +00.00000s
|`->_extract_preprovisioned_vm_setting @00.24300s +00.00100s
Finished stage: (azure-ds/read_azure_ovf) 00.00500 seconds 

Finished stage: (azure-ds/load_azure_ds_dir) 00.00600 seconds 

Starting stage: azure-ds/get_metadata_from_imds
|`->obtain dhcp lease @00.26700s +00.35500s
|`->_get_metadata_from_imds @00.62200s +00.01000s
Finished stage: (azure-ds/get_metadata_from_imds) 00.39100 seconds 

|`->_get_random_seed @00.65900s +00.00000s
Finished stage: (azure-ds/crawl_metadata) 00.60000 seconds 

|`->maybe_remove_ubuntu_network_config_scripts @00.67200s +00.00000s
|`->write_files @00.67200s +00.00300s
Finished stage: (azure-ds/_get_data) 00.63000 seconds 

Finished stage: (init-local/search-Azure) 00.63200 seconds 

|`->network config from imds @00.73600s +00.00000s
Finished stage: (init-local) 00.87400 seconds 

Starting stage: init-network
|`->restored from cache with run check: DataSourceAzure [seed=/var/lib/waagent] @03.40700s +00.04300s
|`->network config from imds @03.50700s +00.00000s
Starting stage: init-network/setup-datasource
Starting stage: azure-ds/setup
Starting stage: azure-ds/_negotiate
Starting stage: azure-ds/bounce_network_with_azure_hostname
|`->temporary_hostname @03.51800s +00.00000s
Finished stage: (azure-ds/bounce_network_with_azure_hostname) 00.00400 seconds 

Starting stage: azure-ds/get_metadata_from_fabric
Starting stage: azure-ds/register_with_azure_and_fetch_data
|`->generate_certificate @03.52300s +00.03200s
Starting stage: azure-ds/find_endpoint
|`->_networkd_get_value_from_leases @03.55600s +00.00100s
Finished stage: (azure-ds/find_endpoint) 00.00200 seconds 

Starting stage: azure-ds/parse_certificates
|`->_decrypt_certs_from_xml @03.57900s +00.01200s
Starting stage: azure-ds/_get_ssh_key_from_cert
|`->_run_x509_action @03.59200s +00.00600s
Finished stage: (azure-ds/_get_ssh_key_from_cert) 00.02800 seconds 

Starting stage: azure-ds/_get_fingerprint_from_cert
|`->_run_x509_action @03.62100s +00.00600s
Finished stage: (azure-ds/_get_fingerprint_from_cert) 00.00600 seconds 

Finished stage: (azure-ds/parse_certificates) 00.04800 seconds 

|`->_report_ready @03.62800s +00.00600s
Finished stage: (azure-ds/register_with_azure_and_fetch_data) 00.11200 seconds 

Finished stage: (azure-ds/get_metadata_from_fabric) 00.11300 seconds 

Finished stage: (azure-ds/_negotiate) 00.11700 seconds 

Finished stage: (azure-ds/setup) 00.11800 seconds 

Finished stage: (init-network/setup-datasource) 00.11900 seconds 

|`->reading and applying user-data @03.64300s +00.00900s
|`->reading and applying vendor-data @03.65200s +00.00100s
Starting stage: init-network/activate-datasource
Starting stage: azure-ds/activate
Starting stage: azure-ds/address_ephemeral_resize
|`->wait for ephemeral disk @03.68700s +00.00000s
Starting stage: azure-ds/can_dev_be_reformatted
|`->_has_ntfs_filesystem @03.68800s +00.13800s
Finished stage: (azure-ds/can_dev_be_reformatted) 00.14000 seconds 

Finished stage: (azure-ds/address_ephemeral_resize) 00.14000 seconds 

Finished stage: (azure-ds/activate) 00.14100 seconds 

Finished stage: (init-network/activate-datasource) 00.14900 seconds 

|`->config-migrator ran successfully @03.87300s +00.00100s
|`->config-seed_random ran successfully @03.87500s +00.00100s
|`->config-bootcmd ran successfully @03.88300s +00.00000s
|`->config-write-files ran successfully @03.88300s +00.00100s
|`->config-growpart ran successfully @03.88500s +00.12900s
|`->config-resizefs ran successfully @04.01500s +00.02700s
|`->config-disk_setup ran successfully @04.04300s +00.18400s
|`->config-mounts ran successfully @04.23800s +00.18200s
|`->config-set_hostname ran successfully @04.42100s +00.00700s
|`->config-update_hostname ran successfully @04.42800s +00.00200s
|`->config-update_etc_hosts ran successfully @04.43000s +00.00100s
|`->config-ca-certs ran successfully @04.43100s +00.00100s
|`->config-rsyslog ran successfully @04.43300s +00.00100s
|`->config-users-groups ran successfully @04.43400s +00.17800s
|`->config-ssh ran successfully @04.61300s +00.11400s
Finished stage: (init-network) 01.33700 seconds 

Starting stage: modules-config
|`->config-emit_upstart ran successfully @07.86400s +00.00000s
|`->config-snap ran successfully @07.86800s +00.00100s
|`->config-snap_config ran successfully @07.87000s +00.00200s
|`->config-ssh-import-id ran successfully @07.87300s +01.04700s
|`->config-locale ran successfully @08.92200s +00.00200s
|`->config-set-passwords ran successfully @08.92500s +00.01000s
|`->config-grub-dpkg ran successfully @08.93500s +00.54200s
|`->config-apt-pipelining ran successfully @09.47800s +00.00200s
|`->config-apt-configure ran successfully @09.48000s +00.14300s
|`->config-ubuntu-advantage ran successfully @09.62400s +00.00100s
|`->config-ntp ran successfully @09.62500s +00.00100s
|`->config-timezone ran successfully @09.62700s +00.00100s
|`->config-disable-ec2-metadata ran successfully @09.62800s +00.00100s
|`->config-runcmd ran successfully @09.62900s +00.00100s
|`->config-byobu ran successfully @09.63100s +00.00100s
Finished stage: (modules-config) 01.79300 seconds 

Starting stage: modules-final
|`->config-snappy ran successfully @10.37500s +00.00200s
|`->config-package-update-upgrade-install ran successfully @10.37700s +00.00100s
|`->config-fan ran successfully @10.37900s +00.00100s
|`->config-landscape ran successfully @10.38100s +00.00100s
|`->config-lxd ran successfully @10.38200s +00.00100s
|`->config-ubuntu-drivers ran successfully @10.38400s +00.00100s
|`->config-puppet ran successfully @10.38500s +00.00100s
|`->config-chef ran successfully @10.38700s +00.00100s
|`->config-mcollective ran successfully @10.38800s +00.00100s
|`->config-salt-minion ran successfully @10.39000s +00.00100s
|`->config-rightscale_userdata ran successfully @10.39100s +00.00100s
|`->config-scripts-vendor ran successfully @10.39200s +00.00100s
|`->config-scripts-per-once ran successfully @10.39400s +00.00100s
|`->config-scripts-per-boot ran successfully @10.39500s +00.00100s
|`->config-scripts-per-instance ran successfully @10.39600s +00.00100s
|`->config-scripts-user ran successfully @10.39800s +00.00100s
|`->config-ssh-authkey-fingerprints ran successfully @10.39900s +00.07100s
|`->config-keys-to-console ran successfully @10.47100s +00.12600s
|`->config-phone-home ran successfully @10.59800s +00.00100s
|`->config-final-message ran successfully @10.59900s +00.00600s
|`->config-power-state-change ran successfully @10.60600s +00.00100s
Finished stage: (modules-final) 00.25100 seconds 

Total Time: 7.75600 seconds

1 boot records analyzed
-- Boot Record 01 --
     01.04700s (modules-config/config-ssh-import-id)
     00.54200s (modules-config/config-grub-dpkg)
     00.35500s (azure-ds/obtain-dhcp-lease)
     00.18400s (init-network/config-disk_setup)
     00.18200s (init-network/config-mounts)
     00.17800s (init-network/config-users-groups)
     00.16600s (azure-ds/list_possible_azure_ds_devs)
     00.14300s (modules-config/config-apt-configure)
     00.13800s (azure-ds/_has_ntfs_filesystem)
     00.12900s (init-network/config-growpart)
     00.12600s (modules-final/config-keys-to-console)
     00.11400s (init-network/config-ssh)
     00.07100s (modules-final/config-ssh-authkey-fingerprints)
     00.04300s (init-network/check-cache)
     00.03200s (azure-ds/generate_certificate)
     00.02700s (init-network/config-resizefs)
     00.01500s (azure-ds/get_boot_telemetry)
     00.01200s (azure-ds/_decrypt_certs_from_xml)
     00.01000s (modules-config/config-set-passwords)
     00.01000s (azure-ds/_get_metadata_from_imds)
     00.00900s (init-network/consume-user-data)
     00.00900s (azure-ds/check-platform-viability)
     00.00700s (init-network/config-set_hostname)
     00.00600s (modules-final/config-final-message)
     00.00600s (azure-ds/_run_x509_action)
     00.00600s (azure-ds/_run_x509_action)
     00.00600s (azure-ds/_report_ready)
     00.00300s (azure-ds/write_files)
     00.00200s (modules-final/config-snappy)
     00.00200s (modules-config/config-snap_config)
     00.00200s (modules-config/config-locale)
     00.00200s (modules-config/config-apt-pipelining)
     00.00200s (init-network/config-update_hostname)
     00.00200s (init-local/check-cache)
     00.00100s (modules-final/config-ubuntu-drivers)
     00.00100s (modules-final/config-scripts-vendor)
     00.00100s (modules-final/config-scripts-user)
     00.00100s (modules-final/config-scripts-per-once)
     00.00100s (modules-final/config-scripts-per-instance)
     00.00100s (modules-final/config-scripts-per-boot)
     00.00100s (modules-final/config-salt-minion)
     00.00100s (modules-final/config-rightscale_userdata)
     00.00100s (modules-final/config-puppet)
     00.00100s (modules-final/config-power-state-change)
     00.00100s (modules-final/config-phone-home)
     00.00100s (modules-final/config-package-update-upgrade-install)
     00.00100s (modules-final/config-mcollective)
     00.00100s (modules-final/config-lxd)
     00.00100s (modules-final/config-landscape)
     00.00100s (modules-final/config-fan)
     00.00100s (modules-final/config-chef)
     00.00100s (modules-config/config-ubuntu-advantage)
     00.00100s (modules-config/config-timezone)
     00.00100s (modules-config/config-snap)
     00.00100s (modules-config/config-runcmd)
     00.00100s (modules-config/config-ntp)
     00.00100s (modules-config/config-disable-ec2-metadata)
     00.00100s (modules-config/config-byobu)
     00.00100s (init-network/consume-vendor-data)
     00.00100s (init-network/config-write-files)
     00.00100s (init-network/config-update_etc_hosts)
     00.00100s (init-network/config-seed_random)
     00.00100s (init-network/config-rsyslog)
     00.00100s (init-network/config-migrator)
     00.00100s (init-network/config-ca-certs)
     00.00100s (azure-ds/get_system_info)
     00.00100s (azure-ds/_networkd_get_value_from_leases)
     00.00100s (azure-ds/_extract_preprovisioned_vm_setting)
     00.00000s (modules-config/config-emit_upstart)
     00.00000s (init-network/config-bootcmd)
     00.00000s (azure-ds/wait-for-ephemeral-disk)
     00.00000s (azure-ds/temporary_hostname)
     00.00000s (azure-ds/parse_network_config)
     00.00000s (azure-ds/parse_network_config)
     00.00000s (azure-ds/maybe_remove_ubuntu_network_config_scripts)
     00.00000s (azure-ds/load_azure_ovf_pubkeys)
     00.00000s (azure-ds/load_azure_ds_dir)
     00.00000s (azure-ds/_get_random_seed)

1 boot records analyzed
After upgrade Networking config
# This file is generated from information provided by
# the datasource.  Changes to it will not persist across an instance.
# To disable cloud-init's network configuration capabilities, write a file
# /etc/cloud/cloud.cfg.d/99-disable-network-config.cfg with the following:
# network: {config: disabled}
network:
    ethernets:
        eth0:
            dhcp4: true
            dhcp4-overrides:
                route-metric: 100
            match:
                macaddress: 00:0d:3a:7d:10:cd
            set-name: eth0
    version: 2
cloud-region: azure-eastus2
Get cloud-id
azure
cloud-region: azure-eastus2
Validating whether metadata is being updated per boot LP:1819913
2019-09-20 07:39:38,600 - __init__.py[DEBUG]: Update datasource metadata and network config due to events: New instance first boot
Connection to 104.209.133.61 closed by remote host.
After reboot
2019-09-20 07:39:38,600 - __init__.py[DEBUG]: Update datasource metadata and network config due to events: New instance first boot
2019-09-20 07:40:52,346 - __init__.py[DEBUG]: Update datasource metadata and network config due to events: New instance first boot
2019-09-20 07:40:52,837 - __init__.py[DEBUG]: Update datasource metadata and network config due to events: System boot
Creating advanced network vm
{
  "publicIp": {
    "dnsSettings": null,
    "etag": "W/\"aab6e18a-3bb7-4d08-8c72-5ef7ca286e22\"",
    "id": "/subscriptions/12aad61c-6de4-4e53-a6c6-5aff52a83777/resourceGroups/srugroup1/providers/Microsoft.Network/publicIPAddresses/sruPublicIp-bionic",
    "idleTimeoutInMinutes": 4,
    "ipAddress": null,
    "ipConfiguration": null,
    "ipTags": [],
    "location": "eastus2",
    "name": "sruPublicIp-bionic",
    "provisioningState": "Succeeded",
    "publicIpAddressVersion": "IPv4",
    "publicIpAllocationMethod": "Dynamic",
    "resourceGroup": "srugroup1",
    "resourceGuid": "e8c7b866-50fa-4c26-a068-9d73e65fea38",
    "sku": {
      "name": "Basic",
      "tier": "Regional"
    },
    "tags": null,
    "type": "Microsoft.Network/publicIPAddresses",
    "zones": null
  }
}
{
  "NewNIC": {
    "dnsSettings": {
      "appliedDnsServers": [],
      "dnsServers": [],
      "internalDnsNameLabel": null,
      "internalDomainNameSuffix": "5x2bho5cdvuufcvyufj4g1exbe.cx.internal.cloudapp.net",
      "internalFqdn": null
    },
    "enableAcceleratedNetworking": true,
    "enableIpForwarding": false,
    "etag": "W/\"5d7e9dea-2b0a-4c0e-b46b-e56683280a89\"",
    "id": "/subscriptions/12aad61c-6de4-4e53-a6c6-5aff52a83777/resourceGroups/srugroup1/providers/Microsoft.Network/networkInterfaces/sruNic-bionic",
    "ipConfigurations": [
      {
        "applicationGatewayBackendAddressPools": null,
        "applicationSecurityGroups": null,
        "etag": "W/\"5d7e9dea-2b0a-4c0e-b46b-e56683280a89\"",
        "id": "/subscriptions/12aad61c-6de4-4e53-a6c6-5aff52a83777/resourceGroups/srugroup1/providers/Microsoft.Network/networkInterfaces/sruNic-bionic/ipConfigurations/ipconfig1",
        "loadBalancerBackendAddressPools": null,
        "loadBalancerInboundNatRules": null,
        "name": "ipconfig1",
        "primary": true,
        "privateIpAddress": "192.168.1.5",
        "privateIpAddressVersion": "IPv4",
        "privateIpAllocationMethod": "Dynamic",
        "provisioningState": "Succeeded",
        "publicIpAddress": {
          "dnsSettings": null,
          "etag": null,
          "id": "/subscriptions/12aad61c-6de4-4e53-a6c6-5aff52a83777/resourceGroups/srugroup1/providers/Microsoft.Network/publicIPAddresses/sruPublicIp-bionic",
          "idleTimeoutInMinutes": null,
          "ipAddress": null,
          "ipConfiguration": null,
          "ipTags": null,
          "location": null,
          "name": null,
          "provisioningState": null,
          "publicIpAddressVersion": null,
          "publicIpAllocationMethod": null,
          "resourceGroup": "srugroup1",
          "resourceGuid": null,
          "sku": null,
          "tags": null,
          "type": null,
          "zones": null
        },
        "resourceGroup": "srugroup1",
        "subnet": {
          "addressPrefix": null,
          "etag": null,
          "id": "/subscriptions/12aad61c-6de4-4e53-a6c6-5aff52a83777/resourceGroups/srugroup1/providers/Microsoft.Network/virtualNetworks/sruVnet/subnets/sruSubnet",
          "ipConfigurations": null,
          "name": null,
          "networkSecurityGroup": null,
          "provisioningState": null,
          "resourceGroup": "srugroup1",
          "resourceNavigationLinks": null,
          "routeTable": null,
          "serviceEndpoints": null
        },
        "type": "Microsoft.Network/networkInterfaces/ipConfigurations"
      }
    ],
    "location": "eastus2",
    "macAddress": null,
    "name": "sruNic-bionic",
    "networkSecurityGroup": {
      "defaultSecurityRules": null,
      "etag": null,
      "id": "/subscriptions/12aad61c-6de4-4e53-a6c6-5aff52a83777/resourceGroups/srugroup1/providers/Microsoft.Network/networkSecurityGroups/sruNetSecGroup",
      "location": null,
      "name": null,
      "networkInterfaces": null,
      "provisioningState": null,
      "resourceGroup": "srugroup1",
      "resourceGuid": null,
      "securityRules": null,
      "subnets": null,
      "tags": null,
      "type": null
    },
    "primary": null,
    "provisioningState": "Succeeded",
    "resourceGroup": "srugroup1",
    "resourceGuid": "115026a5-8278-4e3e-8e24-ba58d9cbd29c",
    "tags": null,
    "type": "Microsoft.Network/networkInterfaces",
    "virtualMachine": null
  }
}
{
  "fqdns": "",
  "id": "/subscriptions/12aad61c-6de4-4e53-a6c6-5aff52a83777/resourceGroups/srugroup1/providers/Microsoft.Compute/virtualMachines/test-sru-bionic-advanced",
  "location": "eastus2",
  "macAddress": "00-0D-3A-7A-A6-52",
  "powerState": "VM running",
  "privateIpAddress": "192.168.1.5",
  "publicIpAddress": "104.209.238.4",
  "resourceGroup": "srugroup1",
  "zones": ""
}

status: done
time: Fri, 20 Sep 2019 07:43:18 +0000
detail:
DataSourceAzure [seed=/dev/sr0]
cloud-init	19.2-24-ge7881d5c-0ubuntu1~18.04.1
{
 "v1": {
  "datasource": "DataSourceAzure [seed=/dev/sr0]",
  "errors": []
 }
}
Startup finished in 9.701s (kernel) + 30.860s (userspace) = 40.561s
graphical.target reached after 29.970s in userspace
         11.548s cloud-init.service
          4.414s cloud-init-local.service
          3.098s snapd.seeded.service
          3.087s cloud-config.service
          2.521s lxd-containers.service
          2.328s snapd.service
          2.320s pollinate.service
          1.803s dev-sda1.device
          1.241s systemd-networkd-wait-online.service
           958ms networkd-dispatcher.service
           885ms cloud-final.service
           805ms accounts-daemon.service
           779ms apparmor.service
           540ms grub-common.service
           353ms systemd-modules-load.service
           315ms lvm2-monitor.service
           261ms systemd-timesyncd.service
           241ms blk-availability.service
           223ms systemd-logind.service
           222ms keyboard-setup.service
           218ms systemd-user-sessions.service
           204ms rsyslog.service
           199ms systemd-udev-trigger.service
           193ms polkit.service
           186ms systemd-journal-flush.service
           160ms systemd-tmpfiles-setup-dev.service
           142ms systemd-udevd.service
           139ms systemd-networkd.service
           132ms systemd-journald.service
           121ms ebtables.service
           119ms apport.service
           113ms systemd-machine-id-commit.service
           105ms ssh.service
            83ms sys-kernel-debug.mount
            81ms ufw.service
            79ms dev-mqueue.mount
            72ms systemd-resolved.service
            72ms systemd-remount-fs.service
            64ms plymouth-read-write.service
            59ms systemd-random-seed.service
            56ms dev-hugepages.mount
            53ms systemd-tmpfiles-setup.service
            51ms snapd.socket
            46ms kmod-static-nodes.service
            45ms systemd-sysctl.service
            38ms lxd.socket
            36ms user@1000.service
            34ms console-setup.service
            28ms setvtrgb.service
            26ms sys-fs-fuse-connections.mount
            25ms plymouth-quit.service
            25ms ephemeral-disk-warning.service
            25ms boot-efi.mount
            24ms systemd-update-utmp.service
            20ms sys-kernel-config.mount
            10ms systemd-update-utmp-runlevel.service
             9ms plymouth-quit-wait.service
-- Boot Record 01 --
The total time elapsed since completing an event is printed after the "@" character.
The time the event takes is printed after the "+" character.

Starting stage: init-local
|`->no cache found @00.00500s +00.00100s
Starting stage: init-local/search-Azure
Starting stage: azure-ds/_get_data
|`->found azure asset tag @00.11600s +00.01300s
|`->get_boot_telemetry @00.12900s +00.01600s
|`->get_system_info @00.14600s +00.00100s
Starting stage: azure-ds/crawl_metadata
|`->list_possible_azure_ds_devs @00.14700s +00.05100s
|`->load_azure_ds_dir @00.19800s +00.00100s
Starting stage: azure-ds/load_azure_ds_dir
Starting stage: azure-ds/read_azure_ovf
|`->load_azure_ovf_pubkeys @00.32800s +00.00000s
|`->_extract_preprovisioned_vm_setting @00.32800s +00.00000s
Finished stage: (azure-ds/read_azure_ovf) 00.01000 seconds 

Finished stage: (azure-ds/load_azure_ds_dir) 00.01500 seconds 

Starting stage: azure-ds/get_metadata_from_imds
|`->obtain dhcp lease @00.35500s +00.43100s
|`->_get_metadata_from_imds @00.78700s +00.02800s
Finished stage: (azure-ds/get_metadata_from_imds) 00.48500 seconds 

|`->_get_random_seed @00.84100s +00.00100s
Finished stage: (azure-ds/crawl_metadata) 00.70800 seconds 

|`->maybe_remove_ubuntu_network_config_scripts @00.85600s +00.00100s
|`->write_files @00.85700s +00.00300s
Finished stage: (azure-ds/_get_data) 00.74400 seconds 

Finished stage: (init-local/search-Azure) 00.74600 seconds 

|`->network config from imds @00.93700s +00.00000s
Finished stage: (init-local) 01.16100 seconds 

Starting stage: init-network
|`->restored from cache with run check: DataSourceAzure [seed=/dev/sr0] @03.14000s +00.04000s
|`->network config from imds @03.23900s +00.00100s
Starting stage: init-network/setup-datasource
Starting stage: azure-ds/setup
Starting stage: azure-ds/_negotiate
Starting stage: azure-ds/bounce_network_with_azure_hostname
|`->temporary_hostname @03.25300s +00.00000s
Finished stage: (azure-ds/bounce_network_with_azure_hostname) 00.00400 seconds 

Starting stage: azure-ds/get_metadata_from_fabric
Starting stage: azure-ds/register_with_azure_and_fetch_data
|`->generate_certificate @03.25800s +00.17100s
Starting stage: azure-ds/find_endpoint
|`->_networkd_get_value_from_leases @03.43000s +00.00100s
Finished stage: (azure-ds/find_endpoint) 00.00200 seconds 

Starting stage: azure-ds/parse_certificates
|`->_decrypt_certs_from_xml @03.45400s +00.01100s
Starting stage: azure-ds/_get_ssh_key_from_cert
|`->_run_x509_action @03.46600s +00.00600s
Finished stage: (azure-ds/_get_ssh_key_from_cert) 00.14200 seconds 

Starting stage: azure-ds/_get_fingerprint_from_cert
|`->_run_x509_action @03.60800s +00.00700s
Finished stage: (azure-ds/_get_fingerprint_from_cert) 00.00800 seconds 

Finished stage: (azure-ds/parse_certificates) 00.16200 seconds 

|`->_report_ready @03.61600s +06.01300s
Finished stage: (azure-ds/register_with_azure_and_fetch_data) 06.37300 seconds 

Finished stage: (azure-ds/get_metadata_from_fabric) 06.37300 seconds 

Finished stage: (azure-ds/_negotiate) 06.37900 seconds 

Finished stage: (azure-ds/setup) 06.37900 seconds 

Finished stage: (init-network/setup-datasource) 06.37900 seconds 

|`->reading and applying user-data @09.63900s +00.00800s
|`->reading and applying vendor-data @09.64800s +00.00000s
Starting stage: init-network/activate-datasource
Starting stage: azure-ds/activate
Starting stage: azure-ds/address_ephemeral_resize
|`->wait for ephemeral disk @09.67700s +00.00100s
Starting stage: azure-ds/can_dev_be_reformatted
|`->_has_ntfs_filesystem @09.67800s +00.13300s
Starting stage: azure-ds/mount-ntfs-and-count
|`->count_files @09.89000s +00.00300s
Finished stage: (azure-ds/mount-ntfs-and-count) 00.09200 seconds 

Finished stage: (azure-ds/can_dev_be_reformatted) 00.22600 seconds 

Finished stage: (azure-ds/address_ephemeral_resize) 00.22800 seconds 

Finished stage: (azure-ds/activate) 00.22800 seconds 

Finished stage: (init-network/activate-datasource) 00.23000 seconds 

|`->config-migrator ran successfully @09.96100s +00.00100s
|`->config-seed_random ran successfully @09.96200s +00.00100s
|`->config-bootcmd ran successfully @09.96400s +00.00000s
|`->config-write-files ran successfully @09.96400s +00.00200s
|`->config-growpart ran successfully @09.96600s +00.65400s
|`->config-resizefs ran successfully @10.62100s +01.43100s
|`->config-disk_setup ran successfully @12.05300s +01.40300s
|`->config-mounts ran successfully @13.45600s +00.18400s
|`->config-set_hostname ran successfully @13.64000s +00.00800s
|`->config-update_hostname ran successfully @13.64900s +00.00200s
|`->config-update_etc_hosts ran successfully @13.65100s +00.00100s
|`->config-ca-certs ran successfully @13.65200s +00.00100s
|`->config-rsyslog ran successfully @13.65400s +00.00100s
|`->config-users-groups ran successfully @13.65500s +00.30000s
|`->config-ssh ran successfully @13.95500s +00.18100s
Finished stage: (init-network) 11.01500 seconds 

Starting stage: modules-config
|`->config-emit_upstart ran successfully @20.53500s +00.00000s
|`->config-snap ran successfully @20.53500s +00.00200s
|`->config-snap_config ran successfully @20.53800s +00.00100s
|`->config-ssh-import-id ran successfully @20.54000s +00.78500s
|`->config-locale ran successfully @21.32600s +00.00100s
|`->config-set-passwords ran successfully @21.32800s +00.00200s
|`->config-grub-dpkg ran successfully @21.33000s +01.32500s
|`->config-apt-pipelining ran successfully @22.65600s +00.00200s
|`->config-apt-configure ran successfully @22.65800s +00.27800s
|`->config-ubuntu-advantage ran successfully @22.93700s +00.00100s
|`->config-ntp ran successfully @22.93900s +00.00100s
|`->config-timezone ran successfully @22.94100s +00.00100s
|`->config-disable-ec2-metadata ran successfully @22.94200s +00.00100s
|`->config-runcmd ran successfully @22.94300s +00.00100s
|`->config-byobu ran successfully @22.94400s +00.00200s
Finished stage: (modules-config) 02.46700 seconds 

Starting stage: modules-final
|`->config-snappy ran successfully @23.65600s +00.00300s
|`->config-package-update-upgrade-install ran successfully @23.66000s +00.00100s
|`->config-fan ran successfully @23.66100s +00.00100s
|`->config-landscape ran successfully @23.66300s +00.00200s
|`->config-lxd ran successfully @23.66500s +00.00200s
|`->config-ubuntu-drivers ran successfully @23.66700s +00.00100s
|`->config-puppet ran successfully @23.66900s +00.00100s
|`->config-chef ran successfully @23.67100s +00.00100s
|`->config-mcollective ran successfully @23.67300s +00.00100s
|`->config-salt-minion ran successfully @23.67400s +00.00100s
|`->config-rightscale_userdata ran successfully @23.67600s +00.00100s
|`->config-scripts-vendor ran successfully @23.67700s +00.00100s
|`->config-scripts-per-once ran successfully @23.67900s +00.00100s
|`->config-scripts-per-boot ran successfully @23.68100s +00.00000s
|`->config-scripts-per-instance ran successfully @23.68100s +00.00100s
|`->config-scripts-user ran successfully @23.68200s +00.00100s
|`->config-ssh-authkey-fingerprints ran successfully @23.68300s +00.00900s
|`->config-keys-to-console ran successfully @23.69200s +00.15200s
|`->config-phone-home ran successfully @23.84500s +00.00100s
|`->config-final-message ran successfully @23.84700s +00.00500s
|`->config-power-state-change ran successfully @23.85300s +00.00100s
Finished stage: (modules-final) 00.23900 seconds 

Total Time: 50.79500 seconds

1 boot records analyzed
-- Boot Record 01 --
     06.01300s (azure-ds/_report_ready)
     01.43100s (init-network/config-resizefs)
     01.40300s (init-network/config-disk_setup)
     01.32500s (modules-config/config-grub-dpkg)
     00.78500s (modules-config/config-ssh-import-id)
     00.65400s (init-network/config-growpart)
     00.43100s (azure-ds/obtain-dhcp-lease)
     00.30000s (init-network/config-users-groups)
     00.27800s (modules-config/config-apt-configure)
     00.18400s (init-network/config-mounts)
     00.18100s (init-network/config-ssh)
     00.17100s (azure-ds/generate_certificate)
     00.15200s (modules-final/config-keys-to-console)
     00.13300s (azure-ds/_has_ntfs_filesystem)
     00.05100s (azure-ds/list_possible_azure_ds_devs)
     00.04000s (init-network/check-cache)
     00.02800s (azure-ds/_get_metadata_from_imds)
     00.01600s (azure-ds/get_boot_telemetry)
     00.01300s (azure-ds/check-platform-viability)
     00.01100s (azure-ds/_decrypt_certs_from_xml)
     00.00900s (modules-final/config-ssh-authkey-fingerprints)
     00.00800s (init-network/consume-user-data)
     00.00800s (init-network/config-set_hostname)
     00.00700s (azure-ds/_run_x509_action)
     00.00600s (azure-ds/_run_x509_action)
     00.00500s (modules-final/config-final-message)
     00.00300s (modules-final/config-snappy)
     00.00300s (azure-ds/write_files)
     00.00300s (azure-ds/count_files)
     00.00200s (modules-final/config-lxd)
     00.00200s (modules-final/config-landscape)
     00.00200s (modules-config/config-snap)
     00.00200s (modules-config/config-set-passwords)
     00.00200s (modules-config/config-byobu)
     00.00200s (modules-config/config-apt-pipelining)
     00.00200s (init-network/config-write-files)
     00.00200s (init-network/config-update_hostname)
     00.00100s (modules-final/config-ubuntu-drivers)
     00.00100s (modules-final/config-scripts-vendor)
     00.00100s (modules-final/config-scripts-user)
     00.00100s (modules-final/config-scripts-per-once)
     00.00100s (modules-final/config-scripts-per-instance)
     00.00100s (modules-final/config-salt-minion)
     00.00100s (modules-final/config-rightscale_userdata)
     00.00100s (modules-final/config-puppet)
     00.00100s (modules-final/config-power-state-change)
     00.00100s (modules-final/config-phone-home)
     00.00100s (modules-final/config-package-update-upgrade-install)
     00.00100s (modules-final/config-mcollective)
     00.00100s (modules-final/config-fan)
     00.00100s (modules-final/config-chef)
     00.00100s (modules-config/config-ubuntu-advantage)
     00.00100s (modules-config/config-timezone)
     00.00100s (modules-config/config-snap_config)
     00.00100s (modules-config/config-runcmd)
     00.00100s (modules-config/config-ntp)
     00.00100s (modules-config/config-locale)
     00.00100s (modules-config/config-disable-ec2-metadata)
     00.00100s (init-network/config-update_etc_hosts)
     00.00100s (init-network/config-seed_random)
     00.00100s (init-network/config-rsyslog)
     00.00100s (init-network/config-migrator)
     00.00100s (init-network/config-ca-certs)
     00.00100s (init-local/check-cache)
     00.00100s (azure-ds/wait-for-ephemeral-disk)
     00.00100s (azure-ds/parse_network_config)
     00.00100s (azure-ds/maybe_remove_ubuntu_network_config_scripts)
     00.00100s (azure-ds/load_azure_ds_dir)
     00.00100s (azure-ds/get_system_info)
     00.00100s (azure-ds/_networkd_get_value_from_leases)
     00.00100s (azure-ds/_get_random_seed)
     00.00000s (modules-final/config-scripts-per-boot)
     00.00000s (modules-config/config-emit_upstart)
     00.00000s (init-network/consume-vendor-data)
     00.00000s (init-network/config-bootcmd)
     00.00000s (azure-ds/temporary_hostname)
     00.00000s (azure-ds/parse_network_config)
     00.00000s (azure-ds/load_azure_ovf_pubkeys)
     00.00000s (azure-ds/_extract_preprovisioned_vm_setting)

1 boot records analyzed
Networking config
# This file is generated from information provided by
# the datasource.  Changes to it will not persist across an instance.
# To disable cloud-init's network configuration capabilities, write a file
# /etc/cloud/cloud.cfg.d/99-disable-network-config.cfg with the following:
# network: {config: disabled}
network:
    ethernets:
        eth0:
            dhcp4: true
            dhcp4-overrides:
                route-metric: 100
            match:
                macaddress: 00:0d:3a:7a:a6:52
            set-name: eth0
    version: 2
  cloud-init
Get:1 http://archive.ubuntu.com/ubuntu bionic-proposed/main amd64 cloud-init all 19.2-36-g059d049c-0ubuntu1~18.04.1 [404 kB]
Preparing to unpack .../cloud-init_19.2-36-g059d049c-0ubuntu1~18.04.1_all.deb ...
Unpacking cloud-init (19.2-36-g059d049c-0ubuntu1~18.04.1) over (19.2-24-ge7881d5c-0ubuntu1~18.04.1) ...
Setting up cloud-init (19.2-36-g059d049c-0ubuntu1~18.04.1) ...
cloud-init	19.2-36-g059d049c-0ubuntu1~18.04.1
Connection to 104.209.238.4 closed by remote host.

status: done
time: Fri, 20 Sep 2019 07:44:59 +0000
detail:
DataSourceAzure [seed=/var/lib/waagent]
{
 "v1": {
  "datasource": "DataSourceAzure [seed=/var/lib/waagent]",
  "errors": []
 }
}
          3.066s systemd-networkd-wait-online.service
          2.470s cloud-init.service
          2.204s cloud-config.service
          1.729s cloud-init-local.service
          1.106s dev-sda1.device
           772ms cloud-final.service
           747ms snapd.service
           647ms lxd-containers.service
           641ms grub-common.service
           535ms accounts-daemon.service
           500ms networkd-dispatcher.service
           314ms apparmor.service
           302ms systemd-logind.service
           300ms systemd-user-sessions.service
           284ms ssh.service
           267ms keyboard-setup.service
           253ms rsyslog.service
           240ms systemd-udev-trigger.service
           233ms apport.service
           204ms systemd-timesyncd.service
           192ms systemd-modules-load.service
           151ms kmod-static-nodes.service
           148ms systemd-remount-fs.service
           147ms sys-kernel-debug.mount
           147ms ufw.service
           146ms lvm2-monitor.service
           144ms dev-mqueue.mount
           140ms systemd-journald.service
           132ms systemd-journal-flush.service
           109ms polkit.service
            98ms ebtables.service
            86ms dev-hugepages.mount
            67ms setvtrgb.service
            54ms systemd-networkd.service
            48ms systemd-resolved.service
            47ms systemd-udevd.service
            43ms systemd-random-seed.service
            39ms systemd-tmpfiles-setup-dev.service
            38ms user@1000.service
            38ms systemd-tmpfiles-setup.service
            37ms console-setup.service
            36ms snapd.socket
            34ms sys-kernel-config.mount
            30ms lxd.socket
            30ms systemd-fsck@dev-disk-cloud-azure_resource\x2dpart1.service
            29ms snapd.seeded.service
            28ms plymouth-quit.service
            28ms systemd-sysctl.service
            26ms sys-fs-fuse-connections.mount
            25ms systemd-update-utmp-runlevel.service
            20ms boot-efi.mount
            17ms systemd-update-utmp.service
            14ms ephemeral-disk-warning.service
            12ms plymouth-read-write.service
             7ms blk-availability.service
             5ms plymouth-quit-wait.service
-- Boot Record 01 --
The total time elapsed since completing an event is printed after the "@" character.
The time the event takes is printed after the "+" character.

Starting stage: init-local
|`->no cache found @00.00600s +00.00000s
Starting stage: init-local/search-Azure
Starting stage: azure-ds/_get_data
|`->found azure asset tag @00.05500s +00.01200s
|`->get_boot_telemetry @00.06700s +00.01700s
|`->get_system_info @00.08400s +00.00100s
Starting stage: azure-ds/crawl_metadata
|`->list_possible_azure_ds_devs @00.08500s +00.23100s
|`->load_azure_ds_dir @00.31600s +00.00100s
Starting stage: azure-ds/load_azure_ds_dir
Starting stage: azure-ds/read_azure_ovf
|`->load_azure_ovf_pubkeys @00.32100s +00.00000s
|`->_extract_preprovisioned_vm_setting @00.32100s +00.00100s
Finished stage: (azure-ds/read_azure_ovf) 00.00400 seconds 

Finished stage: (azure-ds/load_azure_ds_dir) 00.00500 seconds 

Starting stage: azure-ds/get_metadata_from_imds
|`->obtain dhcp lease @00.33400s +00.14900s
|`->_get_metadata_from_imds @00.48300s +00.01400s
Finished stage: (azure-ds/get_metadata_from_imds) 00.22900 seconds 

|`->_get_random_seed @00.56300s +00.00100s
Finished stage: (azure-ds/crawl_metadata) 00.49200 seconds 

|`->maybe_remove_ubuntu_network_config_scripts @00.57700s +00.00000s
|`->write_files @00.57800s +00.00300s
Finished stage: (azure-ds/_get_data) 00.52600 seconds 

Finished stage: (init-local/search-Azure) 00.52900 seconds 

|`->network config from imds @00.64500s +00.00100s
Finished stage: (init-local) 00.80500 seconds 

Starting stage: init-network
|`->restored from cache with run check: DataSourceAzure [seed=/var/lib/waagent] @04.51500s +00.03600s
|`->network config from imds @04.60400s +00.00000s
Starting stage: init-network/setup-datasource
Starting stage: azure-ds/setup
Starting stage: azure-ds/_negotiate
Starting stage: azure-ds/bounce_network_with_azure_hostname
|`->temporary_hostname @04.61700s +00.00000s
Finished stage: (azure-ds/bounce_network_with_azure_hostname) 00.00400 seconds 

Starting stage: azure-ds/get_metadata_from_fabric
Starting stage: azure-ds/register_with_azure_and_fetch_data
|`->generate_certificate @04.62200s +00.15200s
Starting stage: azure-ds/find_endpoint
|`->_networkd_get_value_from_leases @04.77500s +00.00100s
Finished stage: (azure-ds/find_endpoint) 00.00200 seconds 

Starting stage: azure-ds/parse_certificates
|`->_decrypt_certs_from_xml @04.79700s +00.01400s
Starting stage: azure-ds/_get_ssh_key_from_cert
|`->_run_x509_action @04.81200s +00.00600s
Finished stage: (azure-ds/_get_ssh_key_from_cert) 00.02200 seconds 

Starting stage: azure-ds/_get_fingerprint_from_cert
|`->_run_x509_action @04.83500s +00.00600s
Finished stage: (azure-ds/_get_fingerprint_from_cert) 00.00700 seconds 

Finished stage: (azure-ds/parse_certificates) 00.04500 seconds 

|`->_report_ready @04.84200s +00.00700s
Finished stage: (azure-ds/register_with_azure_and_fetch_data) 00.22700 seconds 

Finished stage: (azure-ds/get_metadata_from_fabric) 00.22800 seconds 

Finished stage: (azure-ds/_negotiate) 00.23400 seconds 

Finished stage: (azure-ds/setup) 00.23400 seconds 

Finished stage: (init-network/setup-datasource) 00.23400 seconds 

|`->reading and applying user-data @04.85900s +00.00900s
|`->reading and applying vendor-data @04.86800s +00.00000s
Starting stage: init-network/activate-datasource
Starting stage: azure-ds/activate
Starting stage: azure-ds/address_ephemeral_resize
|`->wait for ephemeral disk @04.90000s +00.00000s
Starting stage: azure-ds/can_dev_be_reformatted
|`->_has_ntfs_filesystem @04.90100s +00.16400s
Finished stage: (azure-ds/can_dev_be_reformatted) 00.16500 seconds 

Finished stage: (azure-ds/address_ephemeral_resize) 00.16500 seconds 

Finished stage: (azure-ds/activate) 00.16500 seconds 

Finished stage: (init-network/activate-datasource) 00.16800 seconds 

|`->config-migrator ran successfully @05.08600s +00.00100s
|`->config-seed_random ran successfully @05.08800s +00.00100s
|`->config-bootcmd ran successfully @05.09000s +00.00000s
|`->config-write-files ran successfully @05.09000s +00.00100s
|`->config-growpart ran successfully @05.09200s +00.05700s
|`->config-resizefs ran successfully @05.15000s +00.03200s
|`->config-disk_setup ran successfully @05.18300s +00.12300s
|`->config-mounts ran successfully @05.30700s +00.17100s
|`->config-set_hostname ran successfully @05.47800s +00.00900s
|`->config-update_hostname ran successfully @05.48700s +00.00200s
|`->config-update_etc_hosts ran successfully @05.49000s +00.00000s
|`->config-ca-certs ran successfully @05.49000s +00.00200s
|`->config-rsyslog ran successfully @05.49200s +00.00200s
|`->config-users-groups ran successfully @05.49400s +00.67000s
|`->config-ssh ran successfully @06.16400s +00.27200s
Finished stage: (init-network) 01.93700 seconds 

Starting stage: modules-config
|`->config-emit_upstart ran successfully @08.14100s +00.00100s
|`->config-snap ran successfully @08.14200s +00.03000s
|`->config-snap_config ran successfully @08.17400s +00.01600s
|`->config-ssh-import-id ran successfully @08.19000s +00.81100s
|`->config-locale ran successfully @09.00200s +00.00100s
|`->config-set-passwords ran successfully @09.00400s +00.00200s
|`->config-grub-dpkg ran successfully @09.00700s +00.47100s
|`->config-apt-pipelining ran successfully @09.47900s +00.00200s
|`->config-apt-configure ran successfully @09.48100s +00.13100s
|`->config-ubuntu-advantage ran successfully @09.61300s +00.00200s
|`->config-ntp ran successfully @09.61500s +00.00100s
|`->config-timezone ran successfully @09.61700s +00.00100s
|`->config-disable-ec2-metadata ran successfully @09.61800s +00.00000s
|`->config-runcmd ran successfully @09.61900s +00.00100s
|`->config-byobu ran successfully @09.62000s +00.00100s
Finished stage: (modules-config) 01.50600 seconds 

Starting stage: modules-final
|`->config-snappy ran successfully @10.27600s +00.00200s
|`->config-package-update-upgrade-install ran successfully @10.27900s +00.00100s
|`->config-fan ran successfully @10.28000s +00.00100s
|`->config-landscape ran successfully @10.28200s +00.00300s
|`->config-lxd ran successfully @10.28600s +00.00100s
|`->config-ubuntu-drivers ran successfully @10.28800s +00.00100s
|`->config-puppet ran successfully @10.28900s +00.00100s
|`->config-chef ran successfully @10.29100s +00.00100s
|`->config-mcollective ran successfully @10.29200s +00.00100s
|`->config-salt-minion ran successfully @10.29400s +00.00100s
|`->config-rightscale_userdata ran successfully @10.29500s +00.00200s
|`->config-scripts-vendor ran successfully @10.29700s +00.00100s
|`->config-scripts-per-once ran successfully @10.29800s +00.00200s
|`->config-scripts-per-boot ran successfully @10.30000s +00.00100s
|`->config-scripts-per-instance ran successfully @10.30100s +00.00100s
|`->config-scripts-user ran successfully @10.30200s +00.00200s
|`->config-ssh-authkey-fingerprints ran successfully @10.30400s +00.02400s
|`->config-keys-to-console ran successfully @10.32900s +00.05900s
|`->config-phone-home ran successfully @10.38900s +00.00100s
|`->config-final-message ran successfully @10.39000s +00.00700s
|`->config-power-state-change ran successfully @10.39700s +00.00100s
Finished stage: (modules-final) 00.14600 seconds 

Total Time: 8.07900 seconds

1 boot records analyzed
-- Boot Record 01 --
     00.81100s (modules-config/config-ssh-import-id)
     00.67000s (init-network/config-users-groups)
     00.47100s (modules-config/config-grub-dpkg)
     00.27200s (init-network/config-ssh)
     00.23100s (azure-ds/list_possible_azure_ds_devs)
     00.17100s (init-network/config-mounts)
     00.16400s (azure-ds/_has_ntfs_filesystem)
     00.15200s (azure-ds/generate_certificate)
     00.14900s (azure-ds/obtain-dhcp-lease)
     00.13100s (modules-config/config-apt-configure)
     00.12300s (init-network/config-disk_setup)
     00.05900s (modules-final/config-keys-to-console)
     00.05700s (init-network/config-growpart)
     00.03600s (init-network/check-cache)
     00.03200s (init-network/config-resizefs)
     00.03000s (modules-config/config-snap)
     00.02400s (modules-final/config-ssh-authkey-fingerprints)
     00.01700s (azure-ds/get_boot_telemetry)
     00.01600s (modules-config/config-snap_config)
     00.01400s (azure-ds/_get_metadata_from_imds)
     00.01400s (azure-ds/_decrypt_certs_from_xml)
     00.01200s (azure-ds/check-platform-viability)
     00.00900s (init-network/consume-user-data)
     00.00900s (init-network/config-set_hostname)
     00.00700s (modules-final/config-final-message)
     00.00700s (azure-ds/_report_ready)
     00.00600s (azure-ds/_run_x509_action)
     00.00600s (azure-ds/_run_x509_action)
     00.00300s (modules-final/config-landscape)
     00.00300s (azure-ds/write_files)
     00.00200s (modules-final/config-snappy)
     00.00200s (modules-final/config-scripts-user)
     00.00200s (modules-final/config-scripts-per-once)
     00.00200s (modules-final/config-rightscale_userdata)
     00.00200s (modules-config/config-ubuntu-advantage)
     00.00200s (modules-config/config-set-passwords)
     00.00200s (modules-config/config-apt-pipelining)
     00.00200s (init-network/config-update_hostname)
     00.00200s (init-network/config-rsyslog)
     00.00200s (init-network/config-ca-certs)
     00.00100s (modules-final/config-ubuntu-drivers)
     00.00100s (modules-final/config-scripts-vendor)
     00.00100s (modules-final/config-scripts-per-instance)
     00.00100s (modules-final/config-scripts-per-boot)
     00.00100s (modules-final/config-salt-minion)
     00.00100s (modules-final/config-puppet)
     00.00100s (modules-final/config-power-state-change)
     00.00100s (modules-final/config-phone-home)
     00.00100s (modules-final/config-package-update-upgrade-install)
     00.00100s (modules-final/config-mcollective)
     00.00100s (modules-final/config-lxd)
     00.00100s (modules-final/config-fan)
     00.00100s (modules-final/config-chef)
     00.00100s (modules-config/config-timezone)
     00.00100s (modules-config/config-runcmd)
     00.00100s (modules-config/config-ntp)
     00.00100s (modules-config/config-locale)
     00.00100s (modules-config/config-emit_upstart)
     00.00100s (modules-config/config-byobu)
     00.00100s (init-network/config-write-files)
     00.00100s (init-network/config-seed_random)
     00.00100s (init-network/config-migrator)
     00.00100s (azure-ds/parse_network_config)
     00.00100s (azure-ds/load_azure_ds_dir)
     00.00100s (azure-ds/get_system_info)
     00.00100s (azure-ds/_networkd_get_value_from_leases)
     00.00100s (azure-ds/_get_random_seed)
     00.00100s (azure-ds/_extract_preprovisioned_vm_setting)
     00.00000s (modules-config/config-disable-ec2-metadata)
     00.00000s (init-network/consume-vendor-data)
     00.00000s (init-network/config-update_etc_hosts)
     00.00000s (init-network/config-bootcmd)
     00.00000s (init-local/check-cache)
     00.00000s (azure-ds/wait-for-ephemeral-disk)
     00.00000s (azure-ds/temporary_hostname)
     00.00000s (azure-ds/parse_network_config)
     00.00000s (azure-ds/maybe_remove_ubuntu_network_config_scripts)
     00.00000s (azure-ds/load_azure_ovf_pubkeys)

1 boot records analyzed
After upgrade Networking config
# This file is generated from information provided by
# the datasource.  Changes to it will not persist across an instance.
# To disable cloud-init's network configuration capabilities, write a file
# /etc/cloud/cloud.cfg.d/99-disable-network-config.cfg with the following:
# network: {config: disabled}
network:
    ethernets:
        eth0:
            dhcp4: true
            dhcp4-overrides:
                route-metric: 100
            match:
                macaddress: 00:0d:3a:7a:a6:52
            set-name: eth0
    version: 2
cloud-region: azure-eastus2
Get cloud-id
azure
cloud-region: azure-eastus2
Validating whether metadata is being updated per boot LP:1819913
2019-09-20 07:44:49,524 - __init__.py[DEBUG]: Update datasource metadata and network config due to events: New instance first boot
Connection to 104.209.238.4 closed by remote host.
After reboot
2019-09-20 07:39:38,600 - __init__.py[DEBUG]: Update datasource metadata and network config due to events: New instance first boot
2019-09-20 07:40:52,346 - __init__.py[DEBUG]: Update datasource metadata and network config due to events: New instance first boot
2019-09-20 07:40:52,837 - __init__.py[DEBUG]: Update datasource metadata and network config due to events: System boot
### END bionic
### BEGIN disco
Creating standard network vm
{
  "fqdns": "",
  "id": "/subscriptions/12aad61c-6de4-4e53-a6c6-5aff52a83777/resourceGroups/srugroup1/providers/Microsoft.Compute/virtualMachines/test-sru-disco",
  "location": "eastus2",
  "macAddress": "00-0D-3A-7B-2E-4E",
  "powerState": "VM running",
  "privateIpAddress": "192.168.1.6",
  "publicIpAddress": "40.84.39.31",
  "resourceGroup": "srugroup1",
  "zones": ""
}
..........................................................
status: done
time: Fri, 20 Sep 2019 07:57:56 +0000
detail:
DataSourceAzure [seed=/dev/sr0]
cloud-init	19.1-1-gbaa47854-0ubuntu1~19.04.1
{
 "v1": {
  "datasource": "DataSourceAzure [seed=/dev/sr0]",
  "errors": []
 }
}
Startup finished in 2.699s (kernel) + 1min 1.765s (userspace) = 1min 4.465s 
graphical.target reached after 1min 990ms in userspace
         27.903s snapd.seeded.service
          9.194s cloud-init.service
          8.517s cloud-config.service
          4.202s cloud-init-local.service
          2.863s lvm2-monitor.service
          2.752s dev-sda1.device
          2.359s pollinate.service
          2.145s systemd-udev-settle.service
          1.918s systemd-networkd-wait-online.service
          1.376s accounts-daemon.service
          1.215s apparmor.service
          1.155s snapd.service
           867ms networkd-dispatcher.service
           847ms systemd-timesyncd.service
           828ms systemd-logind.service
           729ms cloud-final.service
           656ms systemd-journald.service
           632ms rsyslog.service
           618ms snap.lxd.activate.service
           563ms grub-common.service
           497ms systemd-resolved.service
           367ms systemd-networkd.service
           358ms systemd-udev-trigger.service
           342ms keyboard-setup.service
           291ms systemd-modules-load.service
           262ms apport.service
           215ms systemd-user-sessions.service
           194ms systemd-sysusers.service
           193ms sys-kernel-debug.mount
           188ms multipathd.service
           184ms systemd-remount-fs.service
           179ms dev-hugepages.mount
           177ms user@1000.service
           175ms kmod-static-nodes.service
           170ms snapd.socket
           161ms ufw.service
           154ms grub-initrd-fallback.service
           126ms systemd-udevd.service
           118ms dev-mqueue.mount
           115ms ssh.service
           114ms atd.service
           104ms systemd-machine-id-commit.service
           104ms console-setup.service
           101ms systemd-tmpfiles-setup.service
            95ms finalrd.service
            90ms plymouth-read-write.service
            73ms sys-kernel-config.mount
            70ms plymouth-quit.service
            68ms systemd-journal-flush.service
            60ms systemd-tmpfiles-setup-dev.service
            59ms plymouth-quit-wait.service
            56ms systemd-sysctl.service
            54ms systemd-random-seed.service
            54ms sys-fs-fuse-connections.mount
            54ms blk-availability.service
            46ms setvtrgb.service
            45ms systemd-update-utmp-runlevel.service
            41ms dev-loop1.device
            39ms snap-core-7396.mount
            37ms snap-lxd-11684.mount
            35ms systemd-update-utmp.service
            35ms boot-efi.mount
            35ms dev-loop0.device
            30ms ephemeral-disk-warning.service
            30ms user-runtime-dir@1000.service
-- Boot Record 01 --
The total time elapsed since completing an event is printed after the "@" character.
The time the event takes is printed after the "+" character.

Starting stage: init-local
|`->no cache found @00.00500s +00.00000s
Starting stage: init-local/search-Azure
Starting stage: azure-ds/_get_data
|`->found azure asset tag @00.08300s +00.01000s
Starting stage: azure-ds/crawl_metadata
|`->list_possible_azure_ds_devs @00.09300s +00.03900s
|`->load_azure_ds_dir @00.13200s +00.00000s
Starting stage: azure-ds/load_azure_ds_dir
Starting stage: azure-ds/read_azure_ovf
|`->load_azure_ovf_pubkeys @00.25000s +00.00000s
|`->_extract_preprovisioned_vm_setting @00.25000s +00.00100s
Finished stage: (azure-ds/read_azure_ovf) 00.01000 seconds 

Finished stage: (azure-ds/load_azure_ds_dir) 00.02000 seconds 

Starting stage: azure-ds/get_metadata_from_imds
|`->_get_metadata_from_imds @00.63000s +00.10000s
Finished stage: (azure-ds/get_metadata_from_imds) 00.47000 seconds 

|`->_get_random_seed @00.75200s +00.00000s
Finished stage: (azure-ds/crawl_metadata) 00.67000 seconds 

|`->maybe_remove_ubuntu_network_config_scripts @00.76300s +00.00100s
|`->write_files @00.76400s +00.00900s
Finished stage: (azure-ds/_get_data) 00.69000 seconds 

Finished stage: (init-local/search-Azure) 00.69300 seconds 

|`->network config from imds @00.84400s +00.00100s
Finished stage: (init-local) 01.01100 seconds 

Starting stage: init-network
|`->restored from cache with run check: DataSourceAzure [seed=/dev/sr0] @03.79300s +00.02200s
|`->network config from imds @03.85900s +00.00100s
Starting stage: init-network/setup-datasource
Starting stage: azure-ds/setup
Starting stage: azure-ds/_negotiate
Starting stage: azure-ds/bounce_network_with_azure_hostname
|`->temporary_hostname @03.87000s +00.00000s
Finished stage: (azure-ds/bounce_network_with_azure_hostname) 00.00400 seconds 

Starting stage: azure-ds/get_metadata_from_fabric
Starting stage: azure-ds/register_with_azure_and_fetch_data
|`->generate_certificate @03.87300s +00.15700s
Starting stage: azure-ds/find_endpoint
|`->_networkd_get_value_from_leases @04.03000s +00.00100s
Finished stage: (azure-ds/find_endpoint) 00.00100 seconds 

Starting stage: azure-ds/parse_certificates
|`->_decrypt_certs_from_xml @04.06900s +00.01100s
Starting stage: azure-ds/_get_ssh_key_from_cert
|`->_run_x509_action @04.08100s +00.00600s
Finished stage: (azure-ds/_get_ssh_key_from_cert) 00.04000 seconds 

Starting stage: azure-ds/_get_fingerprint_from_cert
|`->_run_x509_action @04.12100s +00.00600s
Finished stage: (azure-ds/_get_fingerprint_from_cert) 00.00600 seconds 

Finished stage: (azure-ds/parse_certificates) 00.05900 seconds 

|`->_report_ready @04.12800s +02.72500s
Finished stage: (azure-ds/register_with_azure_and_fetch_data) 02.98000 seconds 

Finished stage: (azure-ds/get_metadata_from_fabric) 02.98100 seconds 

Finished stage: (azure-ds/_negotiate) 02.98500 seconds 

Finished stage: (azure-ds/setup) 02.98500 seconds 

Finished stage: (init-network/setup-datasource) 02.98600 seconds 

|`->reading and applying user-data @06.86100s +00.01800s
|`->reading and applying vendor-data @06.87900s +00.00000s
Starting stage: init-network/activate-datasource
Starting stage: azure-ds/activate
Starting stage: azure-ds/address_ephemeral_resize
|`->wait for ephemeral disk @06.91100s +00.00000s
Starting stage: azure-ds/can_dev_be_reformatted
|`->_has_ntfs_filesystem @06.91100s +00.12400s
Starting stage: azure-ds/mount-ntfs-and-count
|`->count_files @07.10100s +00.00100s
Finished stage: (azure-ds/mount-ntfs-and-count) 00.07400 seconds 

Finished stage: (azure-ds/can_dev_be_reformatted) 00.19900 seconds 

Finished stage: (azure-ds/address_ephemeral_resize) 00.19900 seconds 

Finished stage: (azure-ds/activate) 00.19900 seconds 

Finished stage: (init-network/activate-datasource) 00.20200 seconds 

|`->config-migrator ran successfully @07.15000s +00.00100s
|`->config-seed_random ran successfully @07.15100s +00.00200s
|`->config-bootcmd ran successfully @07.15300s +00.00000s
|`->config-write-files ran successfully @07.15400s +00.00100s
|`->config-growpart ran successfully @07.15500s +00.83100s
|`->config-resizefs ran successfully @07.98700s +01.07700s
|`->config-disk_setup ran successfully @09.06500s +02.44800s
|`->config-mounts ran successfully @11.51300s +00.33900s
|`->config-set_hostname ran successfully @11.85300s +00.00800s
|`->config-update_hostname ran successfully @11.86100s +00.00200s
|`->config-update_etc_hosts ran successfully @11.86300s +00.00100s
|`->config-ca-certs ran successfully @11.86400s +00.00100s
|`->config-rsyslog ran successfully @11.86500s +00.00100s
|`->config-users-groups ran successfully @11.86700s +00.29500s
|`->config-ssh ran successfully @12.16300s +00.31900s
Finished stage: (init-network) 08.70300 seconds 

Starting stage: modules-config
|`->config-emit_upstart ran successfully @43.60300s +00.00100s
|`->config-snap ran successfully @43.60400s +00.00100s
|`->config-snap_config ran successfully @43.60600s +00.00100s
|`->config-ssh-import-id ran successfully @43.60700s +01.11100s
|`->config-locale ran successfully @44.71900s +00.00100s
|`->config-set-passwords ran successfully @44.72100s +00.00400s
|`->config-grub-dpkg ran successfully @44.72500s +06.59200s
|`->config-apt-pipelining ran successfully @51.31900s +00.00100s
|`->config-apt-configure ran successfully @51.32100s +00.09100s
|`->config-ubuntu-advantage ran successfully @51.41300s +00.00100s
|`->config-ntp ran successfully @51.41500s +00.00000s
|`->config-timezone ran successfully @51.41600s +00.00100s
|`->config-disable-ec2-metadata ran successfully @51.41700s +00.00100s
|`->config-runcmd ran successfully @51.41800s +00.00100s
|`->config-byobu ran successfully @51.41900s +00.00100s
Finished stage: (modules-config) 07.84500 seconds 

Starting stage: modules-final
|`->config-snappy ran successfully @52.08000s +00.00200s
|`->config-package-update-upgrade-install ran successfully @52.08300s +00.00000s
|`->config-fan ran successfully @52.08400s +00.00100s
|`->config-landscape ran successfully @52.08500s +00.00100s
|`->config-lxd ran successfully @52.08600s +00.00100s
|`->config-ubuntu-drivers ran successfully @52.08800s +00.00100s
|`->config-puppet ran successfully @52.08900s +00.00100s
|`->config-chef ran successfully @52.09000s +00.00100s
|`->config-mcollective ran successfully @52.09200s +00.00100s
|`->config-salt-minion ran successfully @52.09300s +00.00100s
|`->config-rightscale_userdata ran successfully @52.09400s +00.00100s
|`->config-scripts-vendor ran successfully @52.09600s +00.00100s
|`->config-scripts-per-once ran successfully @52.09700s +00.00100s
|`->config-scripts-per-boot ran successfully @52.09800s +00.00100s
|`->config-scripts-per-instance ran successfully @52.09900s +00.00100s
|`->config-scripts-user ran successfully @52.10000s +00.00100s
|`->config-ssh-authkey-fingerprints ran successfully @52.10200s +00.04400s
|`->config-keys-to-console ran successfully @52.14700s +00.08200s
|`->config-phone-home ran successfully @52.23000s +00.00100s
|`->config-final-message ran successfully @52.23200s +00.00500s
|`->config-power-state-change ran successfully @52.23700s +00.00100s
Finished stage: (modules-final) 00.17600 seconds 

Total Time: 36.18800 seconds

1 boot records analyzed
-- Boot Record 01 --
     06.59200s (modules-config/config-grub-dpkg)
     02.72500s (azure-ds/_report_ready)
     02.44800s (init-network/config-disk_setup)
     01.11100s (modules-config/config-ssh-import-id)
     01.07700s (init-network/config-resizefs)
     00.83100s (init-network/config-growpart)
     00.33900s (init-network/config-mounts)
     00.31900s (init-network/config-ssh)
     00.29500s (init-network/config-users-groups)
     00.15700s (azure-ds/generate_certificate)
     00.12400s (azure-ds/_has_ntfs_filesystem)
     00.10000s (azure-ds/_get_metadata_from_imds)
     00.09100s (modules-config/config-apt-configure)
     00.08200s (modules-final/config-keys-to-console)
     00.04400s (modules-final/config-ssh-authkey-fingerprints)
     00.03900s (azure-ds/list_possible_azure_ds_devs)
     00.02200s (init-network/check-cache)
     00.01800s (init-network/consume-user-data)
     00.01100s (azure-ds/_decrypt_certs_from_xml)
     00.01000s (azure-ds/check-platform-viability)
     00.00900s (azure-ds/write_files)
     00.00800s (init-network/config-set_hostname)
     00.00600s (azure-ds/_run_x509_action)
     00.00600s (azure-ds/_run_x509_action)
     00.00500s (modules-final/config-final-message)
     00.00400s (modules-config/config-set-passwords)
     00.00200s (modules-final/config-snappy)
     00.00200s (init-network/config-update_hostname)
     00.00200s (init-network/config-seed_random)
     00.00100s (modules-final/config-ubuntu-drivers)
     00.00100s (modules-final/config-scripts-vendor)
     00.00100s (modules-final/config-scripts-user)
     00.00100s (modules-final/config-scripts-per-once)
     00.00100s (modules-final/config-scripts-per-instance)
     00.00100s (modules-final/config-scripts-per-boot)
     00.00100s (modules-final/config-salt-minion)
     00.00100s (modules-final/config-rightscale_userdata)
     00.00100s (modules-final/config-puppet)
     00.00100s (modules-final/config-power-state-change)
     00.00100s (modules-final/config-phone-home)
     00.00100s (modules-final/config-mcollective)
     00.00100s (modules-final/config-lxd)
     00.00100s (modules-final/config-landscape)
     00.00100s (modules-final/config-fan)
     00.00100s (modules-final/config-chef)
     00.00100s (modules-config/config-ubuntu-advantage)
     00.00100s (modules-config/config-timezone)
     00.00100s (modules-config/config-snap_config)
     00.00100s (modules-config/config-snap)
     00.00100s (modules-config/config-runcmd)
     00.00100s (modules-config/config-locale)
     00.00100s (modules-config/config-emit_upstart)
     00.00100s (modules-config/config-disable-ec2-metadata)
     00.00100s (modules-config/config-byobu)
     00.00100s (modules-config/config-apt-pipelining)
     00.00100s (init-network/config-write-files)
     00.00100s (init-network/config-update_etc_hosts)
     00.00100s (init-network/config-rsyslog)
     00.00100s (init-network/config-migrator)
     00.00100s (init-network/config-ca-certs)
     00.00100s (azure-ds/parse_network_config)
     00.00100s (azure-ds/parse_network_config)
     00.00100s (azure-ds/maybe_remove_ubuntu_network_config_scripts)
     00.00100s (azure-ds/count_files)
     00.00100s (azure-ds/_networkd_get_value_from_leases)
     00.00100s (azure-ds/_extract_preprovisioned_vm_setting)
     00.00000s (modules-final/config-package-update-upgrade-install)
     00.00000s (modules-config/config-ntp)
     00.00000s (init-network/consume-vendor-data)
     00.00000s (init-network/config-bootcmd)
     00.00000s (init-local/check-cache)
     00.00000s (azure-ds/wait-for-ephemeral-disk)
     00.00000s (azure-ds/temporary_hostname)
     00.00000s (azure-ds/load_azure_ovf_pubkeys)
     00.00000s (azure-ds/load_azure_ds_dir)
     00.00000s (azure-ds/_get_random_seed)

1 boot records analyzed
Networking config
# This file is generated from information provided by
# the datasource.  Changes to it will not persist across an instance.
# To disable cloud-init's network configuration capabilities, write a file
# /etc/cloud/cloud.cfg.d/99-disable-network-config.cfg with the following:
# network: {config: disabled}
network:
    ethernets:
        eth0:
            dhcp4: true
            match:
                macaddress: 00:0d:3a:7b:2e:4e
            set-name: eth0
    version: 2
  cloud-init
Get:1 http://archive.ubuntu.com/ubuntu disco-proposed/main amd64 cloud-init all 19.2-36-g059d049c-0ubuntu1~19.04.1 [401 kB]
Preparing to unpack .../cloud-init_19.2-36-g059d049c-0ubuntu1~19.04.1_all.deb ...
Unpacking cloud-init (19.2-36-g059d049c-0ubuntu1~19.04.1) over (19.1-1-gbaa47854-0ubuntu1~19.04.1) ...
Setting up cloud-init (19.2-36-g059d049c-0ubuntu1~19.04.1) ...
cloud-init	19.2-36-g059d049c-0ubuntu1~19.04.1
Connection to 40.84.39.31 closed by remote host.

status: done
time: Fri, 20 Sep 2019 07:59:21 +0000
detail:
DataSourceAzure [seed=/var/lib/waagent]
{
 "v1": {
  "datasource": "DataSourceAzure [seed=/var/lib/waagent]",
  "errors": []
 }
}
          3.174s cloud-config.service
          2.814s cloud-init.service
          2.504s dev-sda1.device
          2.383s lvm2-monitor.service
          2.198s snapd.service
          2.135s cloud-init-local.service
          2.072s snap.lxd.activate.service
          1.810s systemd-udev-settle.service
          1.223s systemd-networkd-wait-online.service
          1.210s systemd-logind.service
           985ms grub-common.service
           863ms networkd-dispatcher.service
           834ms systemd-timesyncd.service
           777ms apport.service
           758ms cloud-final.service
           758ms accounts-daemon.service
           597ms systemd-journald.service
           450ms rsyslog.service
           434ms systemd-udev-trigger.service
           409ms systemd-user-sessions.service
           307ms grub-initrd-fallback.service
           303ms systemd-resolved.service
           266ms systemd-networkd.service
           254ms systemd-modules-load.service
           245ms atd.service
           232ms keyboard-setup.service
           228ms apparmor.service
           227ms dev-hugepages.mount
           209ms ssh.service
           197ms systemd-update-utmp.service
           182ms kmod-static-nodes.service
           171ms ufw.service
           165ms user@1000.service
           158ms snapd.socket
           157ms systemd-remount-fs.service
           130ms dev-mqueue.mount
           120ms sys-kernel-debug.mount
           116ms snapd.seeded.service
            93ms console-setup.service
            88ms systemd-sysctl.service
            83ms finalrd.service
            83ms systemd-sysusers.service
            79ms sys-fs-fuse-connections.mount
            78ms systemd-random-seed.service
            76ms systemd-tmpfiles-setup.service
            74ms sys-kernel-config.mount
            68ms systemd-journal-flush.service
            65ms boot-efi.mount
            62ms systemd-fsck@dev-disk-cloud-azure_resource\x2dpart1.service
            59ms dev-loop0.device
            59ms blk-availability.service
            58ms plymouth-read-write.service
            58ms snap-core-7396.mount
            55ms setvtrgb.service
            51ms snap-lxd-11684.mount
            49ms dev-loop1.device
            47ms multipathd.service
            47ms plymouth-quit.service
            46ms systemd-udevd.service
            33ms systemd-update-utmp-runlevel.service
            31ms plymouth-quit-wait.service
            29ms systemd-tmpfiles-setup-dev.service
            20ms user-runtime-dir@1000.service
            16ms ephemeral-disk-warning.service
-- Boot Record 01 --
The total time elapsed since completing an event is printed after the "@" character.
The time the event takes is printed after the "+" character.

Starting stage: init-local
|`->no cache found @00.00500s +00.00000s
Starting stage: init-local/search-Azure
Starting stage: azure-ds/_get_data
|`->found azure asset tag @00.03400s +00.00900s
|`->get_boot_telemetry @00.04300s +00.01800s
|`->get_system_info @00.06100s +00.00100s
Starting stage: azure-ds/crawl_metadata
|`->list_possible_azure_ds_devs @00.06200s +00.22500s
|`->load_azure_ds_dir @00.28700s +00.00100s
Starting stage: azure-ds/load_azure_ds_dir
Starting stage: azure-ds/read_azure_ovf
|`->load_azure_ovf_pubkeys @00.29200s +00.00000s
|`->_extract_preprovisioned_vm_setting @00.29200s +00.00000s
Finished stage: (azure-ds/read_azure_ovf) 00.00400 seconds 

Finished stage: (azure-ds/load_azure_ds_dir) 00.00400 seconds 

Starting stage: azure-ds/get_metadata_from_imds
|`->obtain dhcp lease @00.31800s +00.37600s
|`->_get_metadata_from_imds @00.69500s +00.01000s
Finished stage: (azure-ds/get_metadata_from_imds) 00.40900 seconds 

|`->_get_random_seed @00.72800s +00.00100s
Finished stage: (azure-ds/crawl_metadata) 00.67600 seconds 

|`->maybe_remove_ubuntu_network_config_scripts @00.73900s +00.00000s
|`->write_files @00.73900s +00.00300s
Finished stage: (azure-ds/_get_data) 00.70800 seconds 

Finished stage: (init-local/search-Azure) 00.71100 seconds 

|`->network config from imds @00.81000s +00.00100s
Finished stage: (init-local) 00.93400 seconds 

Starting stage: init-network
|`->restored from cache with run check: DataSourceAzure [seed=/var/lib/waagent] @02.93100s +00.02200s
|`->network config from imds @02.99900s +00.00100s
Starting stage: init-network/setup-datasource
Starting stage: azure-ds/setup
Starting stage: azure-ds/_negotiate
Starting stage: azure-ds/bounce_network_with_azure_hostname
|`->temporary_hostname @03.00900s +00.00000s
Finished stage: (azure-ds/bounce_network_with_azure_hostname) 00.00300 seconds 

Starting stage: azure-ds/get_metadata_from_fabric
Starting stage: azure-ds/register_with_azure_and_fetch_data
|`->generate_certificate @03.01300s +00.09400s
Starting stage: azure-ds/find_endpoint
|`->_networkd_get_value_from_leases @03.10700s +00.00100s
Finished stage: (azure-ds/find_endpoint) 00.00200 seconds 

Starting stage: azure-ds/parse_certificates
|`->_decrypt_certs_from_xml @03.13700s +00.01100s
Starting stage: azure-ds/_get_ssh_key_from_cert
|`->_run_x509_action @03.14900s +00.00600s
Finished stage: (azure-ds/_get_ssh_key_from_cert) 00.01400 seconds 

Starting stage: azure-ds/_get_fingerprint_from_cert
|`->_run_x509_action @03.16300s +00.00600s
Finished stage: (azure-ds/_get_fingerprint_from_cert) 00.00600 seconds 

Finished stage: (azure-ds/parse_certificates) 00.03200 seconds 

|`->_report_ready @03.17000s +00.00500s
Finished stage: (azure-ds/register_with_azure_and_fetch_data) 00.16200 seconds 

Finished stage: (azure-ds/get_metadata_from_fabric) 00.16300 seconds 

Finished stage: (azure-ds/_negotiate) 00.16700 seconds 

Finished stage: (azure-ds/setup) 00.16800 seconds 

Finished stage: (init-network/setup-datasource) 00.16800 seconds 

|`->reading and applying user-data @03.18300s +00.00700s
|`->reading and applying vendor-data @03.19000s +00.00100s
Starting stage: init-network/activate-datasource
Starting stage: azure-ds/activate
Starting stage: azure-ds/address_ephemeral_resize
|`->wait for ephemeral disk @03.22300s +00.00000s
Starting stage: azure-ds/can_dev_be_reformatted
|`->_has_ntfs_filesystem @03.22300s +00.11600s
Finished stage: (azure-ds/can_dev_be_reformatted) 00.11600 seconds 

Finished stage: (azure-ds/address_ephemeral_resize) 00.11600 seconds 

Finished stage: (azure-ds/activate) 00.11600 seconds 

Finished stage: (init-network/activate-datasource) 00.11900 seconds 

|`->config-migrator ran successfully @03.37300s +00.00000s
|`->config-seed_random ran successfully @03.37400s +00.00100s
|`->config-bootcmd ran successfully @03.37800s +00.00100s
|`->config-write-files ran successfully @03.37900s +00.00100s
|`->config-growpart ran successfully @03.38300s +00.09100s
|`->config-resizefs ran successfully @03.47500s +00.25400s
|`->config-disk_setup ran successfully @03.73000s +00.66900s
|`->config-mounts ran successfully @04.40100s +00.31300s
|`->config-set_hostname ran successfully @04.71500s +00.01700s
|`->config-update_hostname ran successfully @04.73300s +00.00100s
|`->config-update_etc_hosts ran successfully @04.73500s +00.00000s
|`->config-ca-certs ran successfully @04.73600s +00.00500s
|`->config-rsyslog ran successfully @04.74200s +00.00100s
|`->config-users-groups ran successfully @04.74300s +00.03000s
|`->config-ssh ran successfully @04.77400s +00.46200s
Finished stage: (init-network) 02.32100 seconds 

Starting stage: modules-config
|`->config-emit_upstart ran successfully @09.42500s +00.00100s
|`->config-snap ran successfully @09.43200s +00.00100s
|`->config-snap_config ran successfully @09.43400s +00.00100s
|`->config-ssh-import-id ran successfully @09.43600s +00.96200s
|`->config-locale ran successfully @10.39900s +00.00200s
|`->config-set-passwords ran successfully @10.40100s +00.00300s
|`->config-grub-dpkg ran successfully @10.40400s +01.02000s
|`->config-apt-pipelining ran successfully @11.42500s +00.00100s
|`->config-apt-configure ran successfully @11.42700s +00.10900s
|`->config-ubuntu-advantage ran successfully @11.53700s +00.00200s
|`->config-ntp ran successfully @11.54000s +00.00100s
|`->config-timezone ran successfully @11.54100s +00.00100s
|`->config-disable-ec2-metadata ran successfully @11.54200s +00.00100s
|`->config-runcmd ran successfully @11.54300s +00.00100s
|`->config-byobu ran successfully @11.54500s +00.00100s
Finished stage: (modules-config) 02.15200 seconds 

Starting stage: modules-final
|`->config-snappy ran successfully @12.14900s +00.00200s
|`->config-package-update-upgrade-install ran successfully @12.15100s +00.00100s
|`->config-fan ran successfully @12.15200s +00.00100s
|`->config-landscape ran successfully @12.15400s +00.00000s
|`->config-lxd ran successfully @12.15500s +00.00100s
|`->config-ubuntu-drivers ran successfully @12.15600s +00.00100s
|`->config-puppet ran successfully @12.15700s +00.00100s
|`->config-chef ran successfully @12.15900s +00.00000s
|`->config-mcollective ran successfully @12.16000s +00.00100s
|`->config-salt-minion ran successfully @12.16100s +00.00100s
|`->config-rightscale_userdata ran successfully @12.16200s +00.00100s
|`->config-scripts-vendor ran successfully @12.16400s +00.00000s
|`->config-scripts-per-once ran successfully @12.16500s +00.00100s
|`->config-scripts-per-boot ran successfully @12.16600s +00.00000s
|`->config-scripts-per-instance ran successfully @12.16700s +00.00100s
|`->config-scripts-user ran successfully @12.16800s +00.00100s
|`->config-ssh-authkey-fingerprints ran successfully @12.16900s +00.05100s
|`->config-keys-to-console ran successfully @12.22100s +00.08700s
|`->config-phone-home ran successfully @12.30900s +00.00100s
|`->config-final-message ran successfully @12.31100s +00.00400s
|`->config-power-state-change ran successfully @12.31600s +00.00100s
Finished stage: (modules-final) 00.18500 seconds 

Total Time: 9.45600 seconds

1 boot records analyzed
-- Boot Record 01 --
     01.02000s (modules-config/config-grub-dpkg)
     00.96200s (modules-config/config-ssh-import-id)
     00.66900s (init-network/config-disk_setup)
     00.46200s (init-network/config-ssh)
     00.37600s (azure-ds/obtain-dhcp-lease)
     00.31300s (init-network/config-mounts)
     00.25400s (init-network/config-resizefs)
     00.22500s (azure-ds/list_possible_azure_ds_devs)
     00.11600s (azure-ds/_has_ntfs_filesystem)
     00.10900s (modules-config/config-apt-configure)
     00.09400s (azure-ds/generate_certificate)
     00.09100s (init-network/config-growpart)
     00.08700s (modules-final/config-keys-to-console)
     00.05100s (modules-final/config-ssh-authkey-fingerprints)
     00.03000s (init-network/config-users-groups)
     00.02200s (init-network/check-cache)
     00.01800s (azure-ds/get_boot_telemetry)
     00.01700s (init-network/config-set_hostname)
     00.01100s (azure-ds/_decrypt_certs_from_xml)
     00.01000s (azure-ds/_get_metadata_from_imds)
     00.00900s (azure-ds/check-platform-viability)
     00.00700s (init-network/consume-user-data)
     00.00600s (azure-ds/_run_x509_action)
     00.00600s (azure-ds/_run_x509_action)
     00.00500s (init-network/config-ca-certs)
     00.00500s (azure-ds/_report_ready)
     00.00400s (modules-final/config-final-message)
     00.00300s (modules-config/config-set-passwords)
     00.00300s (azure-ds/write_files)
     00.00200s (modules-final/config-snappy)
     00.00200s (modules-config/config-ubuntu-advantage)
     00.00200s (modules-config/config-locale)
     00.00100s (modules-final/config-ubuntu-drivers)
     00.00100s (modules-final/config-scripts-user)
     00.00100s (modules-final/config-scripts-per-once)
     00.00100s (modules-final/config-scripts-per-instance)
     00.00100s (modules-final/config-salt-minion)
     00.00100s (modules-final/config-rightscale_userdata)
     00.00100s (modules-final/config-puppet)
     00.00100s (modules-final/config-power-state-change)
     00.00100s (modules-final/config-phone-home)
     00.00100s (modules-final/config-package-update-upgrade-install)
     00.00100s (modules-final/config-mcollective)
     00.00100s (modules-final/config-lxd)
     00.00100s (modules-final/config-fan)
     00.00100s (modules-config/config-timezone)
     00.00100s (modules-config/config-snap_config)
     00.00100s (modules-config/config-snap)
     00.00100s (modules-config/config-runcmd)
     00.00100s (modules-config/config-ntp)
     00.00100s (modules-config/config-emit_upstart)
     00.00100s (modules-config/config-disable-ec2-metadata)
     00.00100s (modules-config/config-byobu)
     00.00100s (modules-config/config-apt-pipelining)
     00.00100s (init-network/consume-vendor-data)
     00.00100s (init-network/config-write-files)
     00.00100s (init-network/config-update_hostname)
     00.00100s (init-network/config-seed_random)
     00.00100s (init-network/config-rsyslog)
     00.00100s (init-network/config-bootcmd)
     00.00100s (azure-ds/parse_network_config)
     00.00100s (azure-ds/parse_network_config)
     00.00100s (azure-ds/load_azure_ds_dir)
     00.00100s (azure-ds/get_system_info)
     00.00100s (azure-ds/_networkd_get_value_from_leases)
     00.00100s (azure-ds/_get_random_seed)
     00.00000s (modules-final/config-scripts-vendor)
     00.00000s (modules-final/config-scripts-per-boot)
     00.00000s (modules-final/config-landscape)
     00.00000s (modules-final/config-chef)
     00.00000s (init-network/config-update_etc_hosts)
     00.00000s (init-network/config-migrator)
     00.00000s (init-local/check-cache)
     00.00000s (azure-ds/wait-for-ephemeral-disk)
     00.00000s (azure-ds/temporary_hostname)
     00.00000s (azure-ds/maybe_remove_ubuntu_network_config_scripts)
     00.00000s (azure-ds/load_azure_ovf_pubkeys)
     00.00000s (azure-ds/_extract_preprovisioned_vm_setting)

1 boot records analyzed
After upgrade Networking config
# This file is generated from information provided by
# the datasource.  Changes to it will not persist across an instance.
# To disable cloud-init's network configuration capabilities, write a file
# /etc/cloud/cloud.cfg.d/99-disable-network-config.cfg with the following:
# network: {config: disabled}
network:
    ethernets:
        eth0:
            dhcp4: true
            dhcp4-overrides:
                route-metric: 100
            match:
                macaddress: 00:0d:3a:7b:2e:4e
            set-name: eth0
    version: 2
cloud-region: azure-eastus2
Get cloud-id
azure
cloud-region: azure-eastus2
Validating whether metadata is being updated per boot LP:1819913
2019-09-20 07:59:09,184 - __init__.py[DEBUG]: Update datasource metadata and network config due to events: New instance first boot
After reboot
2019-09-20 07:59:09,184 - __init__.py[DEBUG]: Update datasource metadata and network config due to events: New instance first boot
2019-09-20 08:00:20,541 - __init__.py[DEBUG]: Update datasource metadata and network config due to events: New instance first boot
2019-09-20 08:00:20,961 - __init__.py[DEBUG]: Update datasource metadata and network config due to events: System boot
Creating advanced network vm
{
  "publicIp": {
    "dnsSettings": null,
    "etag": "W/\"8fdb17b1-202d-4019-a0d3-8da261b93f43\"",
    "id": "/subscriptions/12aad61c-6de4-4e53-a6c6-5aff52a83777/resourceGroups/srugroup1/providers/Microsoft.Network/publicIPAddresses/sruPublicIp-disco",
    "idleTimeoutInMinutes": 4,
    "ipAddress": null,
    "ipConfiguration": null,
    "ipTags": [],
    "location": "eastus2",
    "name": "sruPublicIp-disco",
    "provisioningState": "Succeeded",
    "publicIpAddressVersion": "IPv4",
    "publicIpAllocationMethod": "Dynamic",
    "resourceGroup": "srugroup1",
    "resourceGuid": "6ce763f3-9b49-4bed-8a75-9e24bc872a90",
    "sku": {
      "name": "Basic",
      "tier": "Regional"
    },
    "tags": null,
    "type": "Microsoft.Network/publicIPAddresses",
    "zones": null
  }
}
{
  "NewNIC": {
    "dnsSettings": {
      "appliedDnsServers": [],
      "dnsServers": [],
      "internalDnsNameLabel": null,
      "internalDomainNameSuffix": "5x2bho5cdvuufcvyufj4g1exbe.cx.internal.cloudapp.net",
      "internalFqdn": null
    },
    "enableAcceleratedNetworking": true,
    "enableIpForwarding": false,
    "etag": "W/\"dbad286b-c75f-4b4d-9c16-7156b88bc42e\"",
    "id": "/subscriptions/12aad61c-6de4-4e53-a6c6-5aff52a83777/resourceGroups/srugroup1/providers/Microsoft.Network/networkInterfaces/sruNic-disco",
    "ipConfigurations": [
      {
        "applicationGatewayBackendAddressPools": null,
        "applicationSecurityGroups": null,
        "etag": "W/\"dbad286b-c75f-4b4d-9c16-7156b88bc42e\"",
        "id": "/subscriptions/12aad61c-6de4-4e53-a6c6-5aff52a83777/resourceGroups/srugroup1/providers/Microsoft.Network/networkInterfaces/sruNic-disco/ipConfigurations/ipconfig1",
        "loadBalancerBackendAddressPools": null,
        "loadBalancerInboundNatRules": null,
        "name": "ipconfig1",
        "primary": true,
        "privateIpAddress": "192.168.1.7",
        "privateIpAddressVersion": "IPv4",
        "privateIpAllocationMethod": "Dynamic",
        "provisioningState": "Succeeded",
        "publicIpAddress": {
          "dnsSettings": null,
          "etag": null,
          "id": "/subscriptions/12aad61c-6de4-4e53-a6c6-5aff52a83777/resourceGroups/srugroup1/providers/Microsoft.Network/publicIPAddresses/sruPublicIp-disco",
          "idleTimeoutInMinutes": null,
          "ipAddress": null,
          "ipConfiguration": null,
          "ipTags": null,
          "location": null,
          "name": null,
          "provisioningState": null,
          "publicIpAddressVersion": null,
          "publicIpAllocationMethod": null,
          "resourceGroup": "srugroup1",
          "resourceGuid": null,
          "sku": null,
          "tags": null,
          "type": null,
          "zones": null
        },
        "resourceGroup": "srugroup1",
        "subnet": {
          "addressPrefix": null,
          "etag": null,
          "id": "/subscriptions/12aad61c-6de4-4e53-a6c6-5aff52a83777/resourceGroups/srugroup1/providers/Microsoft.Network/virtualNetworks/sruVnet/subnets/sruSubnet",
          "ipConfigurations": null,
          "name": null,
          "networkSecurityGroup": null,
          "provisioningState": null,
          "resourceGroup": "srugroup1",
          "resourceNavigationLinks": null,
          "routeTable": null,
          "serviceEndpoints": null
        },
        "type": "Microsoft.Network/networkInterfaces/ipConfigurations"
      }
    ],
    "location": "eastus2",
    "macAddress": null,
    "name": "sruNic-disco",
    "networkSecurityGroup": {
      "defaultSecurityRules": null,
      "etag": null,
      "id": "/subscriptions/12aad61c-6de4-4e53-a6c6-5aff52a83777/resourceGroups/srugroup1/providers/Microsoft.Network/networkSecurityGroups/sruNetSecGroup",
      "location": null,
      "name": null,
      "networkInterfaces": null,
      "provisioningState": null,
      "resourceGroup": "srugroup1",
      "resourceGuid": null,
      "securityRules": null,
      "subnets": null,
      "tags": null,
      "type": null
    },
    "primary": null,
    "provisioningState": "Succeeded",
    "resourceGroup": "srugroup1",
    "resourceGuid": "e85f6e1e-ecdb-4f15-8b7b-3f8b294a3c42",
    "tags": null,
    "type": "Microsoft.Network/networkInterfaces",
    "virtualMachine": null
  }
}
{
  "fqdns": "",
  "id": "/subscriptions/12aad61c-6de4-4e53-a6c6-5aff52a83777/resourceGroups/srugroup1/providers/Microsoft.Compute/virtualMachines/test-sru-disco-advanced",
  "location": "eastus2",
  "macAddress": "00-0D-3A-04-AC-82",
  "powerState": "VM running",
  "privateIpAddress": "192.168.1.7",
  "publicIpAddress": "52.177.126.208",
  "resourceGroup": "srugroup1",
  "zones": ""
}

status: done
time: Fri, 20 Sep 2019 08:03:51 +0000
detail:
DataSourceAzure [seed=/dev/sr0]
cloud-init	19.1-1-gbaa47854-0ubuntu1~19.04.1
{
 "v1": {
  "datasource": "DataSourceAzure [seed=/dev/sr0]",
  "errors": []
 }
}
Startup finished in 3.348s (kernel) + 49.569s (userspace) = 52.918s 
graphical.target reached after 48.904s in userspace
         21.998s snapd.seeded.service
         10.483s cloud-init.service
          4.126s cloud-init-local.service
          2.613s cloud-config.service
          2.269s lvm2-monitor.service
          2.182s dev-sda1.device
          1.979s systemd-networkd-wait-online.service
          1.864s systemd-udev-settle.service
          1.780s pollinate.service
          1.231s accounts-daemon.service
          1.161s snapd.service
           656ms cloud-final.service
           643ms networkd-dispatcher.service
           565ms apparmor.service
           520ms systemd-timesyncd.service
           494ms systemd-logind.service
           483ms systemd-resolved.service
           384ms snap.lxd.activate.service
           351ms systemd-journald.service
           349ms atd.service
           335ms systemd-networkd.service
           317ms rsyslog.service
           295ms grub-common.service
           279ms systemd-modules-load.service
           206ms systemd-sysusers.service
           197ms keyboard-setup.service
           189ms ufw.service
           189ms multipathd.service
           187ms dev-hugepages.mount
           166ms apport.service
           162ms user@1000.service
           153ms kmod-static-nodes.service
           150ms systemd-remount-fs.service
           134ms systemd-udev-trigger.service
           123ms systemd-udevd.service
           122ms dev-mqueue.mount
           117ms systemd-user-sessions.service
           102ms ssh.service
            96ms sys-kernel-debug.mount
            89ms grub-initrd-fallback.service
            81ms systemd-journal-flush.service
            66ms plymouth-read-write.service
            62ms finalrd.service
            61ms systemd-tmpfiles-setup-dev.service
            60ms systemd-tmpfiles-setup.service
            57ms console-setup.service
            53ms systemd-machine-id-commit.service
            52ms systemd-sysctl.service
            40ms setvtrgb.service
            40ms systemd-random-seed.service
            32ms blk-availability.service
            32ms snap-core-7396.mount
            30ms snap-lxd-11684.mount
            26ms sys-fs-fuse-connections.mount
            25ms boot-efi.mount
            23ms sys-kernel-config.mount
            22ms ephemeral-disk-warning.service
            21ms systemd-update-utmp.service
            16ms plymouth-quit-wait.service
            15ms user-runtime-dir@1000.service
            13ms systemd-update-utmp-runlevel.service
            12ms plymouth-quit.service
             8ms dev-loop0.device
             6ms dev-loop1.device
             3ms snapd.socket
-- Boot Record 01 --
The total time elapsed since completing an event is printed after the "@" character.
The time the event takes is printed after the "+" character.

Starting stage: init-local
|`->no cache found @00.00400s +00.00100s
Starting stage: init-local/search-Azure
Starting stage: azure-ds/_get_data
|`->found azure asset tag @00.07900s +00.00900s
Starting stage: azure-ds/crawl_metadata
|`->list_possible_azure_ds_devs @00.08900s +00.06900s
|`->load_azure_ds_dir @00.15800s +00.00000s
Starting stage: azure-ds/load_azure_ds_dir
Starting stage: azure-ds/read_azure_ovf
|`->load_azure_ovf_pubkeys @00.29300s +00.00000s
|`->_extract_preprovisioned_vm_setting @00.29300s +00.00100s
Finished stage: (azure-ds/read_azure_ovf) 00.01000 seconds 

Finished stage: (azure-ds/load_azure_ds_dir) 00.01500 seconds 

Starting stage: azure-ds/get_metadata_from_imds
|`->_get_metadata_from_imds @00.63500s +00.01200s
Finished stage: (azure-ds/get_metadata_from_imds) 00.38300 seconds 

|`->_get_random_seed @00.70300s +00.00000s
Finished stage: (azure-ds/crawl_metadata) 00.62500 seconds 

|`->maybe_remove_ubuntu_network_config_scripts @00.71300s +00.00100s
|`->write_files @00.71400s +00.01200s
Finished stage: (azure-ds/_get_data) 00.64700 seconds 

Finished stage: (init-local/search-Azure) 00.64900 seconds 

|`->network config from imds @00.80400s +00.00000s
Finished stage: (init-local) 00.96800 seconds 

Starting stage: init-network
|`->restored from cache with run check: DataSourceAzure [seed=/dev/sr0] @03.75600s +00.02000s
|`->network config from imds @03.81900s +00.00000s
Starting stage: init-network/setup-datasource
Starting stage: azure-ds/setup
Starting stage: azure-ds/_negotiate
Starting stage: azure-ds/bounce_network_with_azure_hostname
|`->temporary_hostname @03.82900s +00.00000s
Finished stage: (azure-ds/bounce_network_with_azure_hostname) 00.00400 seconds 

Starting stage: azure-ds/get_metadata_from_fabric
Starting stage: azure-ds/register_with_azure_and_fetch_data
|`->generate_certificate @03.83300s +00.10300s
Starting stage: azure-ds/find_endpoint
|`->_networkd_get_value_from_leases @03.93600s +00.00100s
Finished stage: (azure-ds/find_endpoint) 00.00200 seconds 

Starting stage: azure-ds/parse_certificates
|`->_decrypt_certs_from_xml @03.95800s +00.01000s
Starting stage: azure-ds/_get_ssh_key_from_cert
|`->_run_x509_action @03.96900s +00.00500s
Finished stage: (azure-ds/_get_ssh_key_from_cert) 00.04200 seconds 

Starting stage: azure-ds/_get_fingerprint_from_cert
|`->_run_x509_action @04.01100s +00.00500s
Finished stage: (azure-ds/_get_fingerprint_from_cert) 00.00500 seconds 

Finished stage: (azure-ds/parse_certificates) 00.05900 seconds 

|`->_report_ready @04.01700s +04.98000s
Finished stage: (azure-ds/register_with_azure_and_fetch_data) 05.16600 seconds 

Finished stage: (azure-ds/get_metadata_from_fabric) 05.16600 seconds 

Finished stage: (azure-ds/_negotiate) 05.17100 seconds 

Finished stage: (azure-ds/setup) 05.17100 seconds 

Finished stage: (init-network/setup-datasource) 05.17100 seconds 

|`->reading and applying user-data @09.00600s +00.01800s
|`->reading and applying vendor-data @09.02400s +00.00100s
Starting stage: init-network/activate-datasource
Starting stage: azure-ds/activate
Starting stage: azure-ds/address_ephemeral_resize
|`->wait for ephemeral disk @09.05400s +00.00000s
Starting stage: azure-ds/can_dev_be_reformatted
|`->_has_ntfs_filesystem @09.05400s +00.25900s
Starting stage: azure-ds/mount-ntfs-and-count
|`->count_files @09.37400s +00.00100s
Finished stage: (azure-ds/mount-ntfs-and-count) 00.06800 seconds 

Finished stage: (azure-ds/can_dev_be_reformatted) 00.32700 seconds 

Finished stage: (azure-ds/address_ephemeral_resize) 00.32900 seconds 

Finished stage: (azure-ds/activate) 00.32900 seconds 

Finished stage: (init-network/activate-datasource) 00.33200 seconds 

|`->config-migrator ran successfully @09.43000s +00.00100s
|`->config-seed_random ran successfully @09.43100s +00.00100s
|`->config-bootcmd ran successfully @09.43300s +00.00000s
|`->config-write-files ran successfully @09.43300s +00.00200s
|`->config-growpart ran successfully @09.43500s +00.88800s
|`->config-resizefs ran successfully @10.32300s +01.12900s
|`->config-disk_setup ran successfully @11.45200s +01.40200s
|`->config-mounts ran successfully @12.85500s +00.32700s
|`->config-set_hostname ran successfully @13.18300s +00.00500s
|`->config-update_hostname ran successfully @13.18900s +00.00200s
|`->config-update_etc_hosts ran successfully @13.19100s +00.00000s
|`->config-ca-certs ran successfully @13.19100s +00.00200s
|`->config-rsyslog ran successfully @13.19300s +00.00100s
|`->config-users-groups ran successfully @13.19400s +00.32900s
|`->config-ssh ran successfully @13.52400s +00.28600s
Finished stage: (init-network) 10.06700 seconds 

Starting stage: modules-config
|`->config-emit_upstart ran successfully @38.39600s +00.00100s
|`->config-snap ran successfully @38.39700s +00.00100s
|`->config-snap_config ran successfully @38.39900s +00.00100s
|`->config-ssh-import-id ran successfully @38.40000s +00.88000s
|`->config-locale ran successfully @39.28000s +00.00200s
|`->config-set-passwords ran successfully @39.28300s +00.00200s
|`->config-grub-dpkg ran successfully @39.28500s +01.11700s
|`->config-apt-pipelining ran successfully @40.40300s +00.00100s
|`->config-apt-configure ran successfully @40.40400s +00.11800s
|`->config-ubuntu-advantage ran successfully @40.52300s +00.00100s
|`->config-ntp ran successfully @40.52500s +00.00100s
|`->config-timezone ran successfully @40.52600s +00.00100s
|`->config-disable-ec2-metadata ran successfully @40.52700s +00.00100s
|`->config-runcmd ran successfully @40.52800s +00.00100s
|`->config-byobu ran successfully @40.52900s +00.00100s
Finished stage: (modules-config) 02.15000 seconds 

Starting stage: modules-final
|`->config-snappy ran successfully @41.03300s +00.00100s
|`->config-package-update-upgrade-install ran successfully @41.03500s +00.00100s
|`->config-fan ran successfully @41.03600s +00.00100s
|`->config-landscape ran successfully @41.03800s +00.00100s
|`->config-lxd ran successfully @41.03900s +00.00100s
|`->config-ubuntu-drivers ran successfully @41.04000s +00.00100s
|`->config-puppet ran successfully @41.04200s +00.00100s
|`->config-chef ran successfully @41.04300s +00.00100s
|`->config-mcollective ran successfully @41.04400s +00.00200s
|`->config-salt-minion ran successfully @41.04600s +00.00100s
|`->config-rightscale_userdata ran successfully @41.04700s +00.00200s
|`->config-scripts-vendor ran successfully @41.04900s +00.00100s
|`->config-scripts-per-once ran successfully @41.05100s +00.00100s
|`->config-scripts-per-boot ran successfully @41.05300s +00.00000s
|`->config-scripts-per-instance ran successfully @41.05300s +00.00100s
|`->config-scripts-user ran successfully @41.05500s +00.00100s
|`->config-ssh-authkey-fingerprints ran successfully @41.05600s +00.06100s
|`->config-keys-to-console ran successfully @41.11800s +00.10200s
|`->config-phone-home ran successfully @41.22200s +00.00100s
|`->config-final-message ran successfully @41.22300s +00.00500s
|`->config-power-state-change ran successfully @41.22800s +00.00100s
Finished stage: (modules-final) 00.21200 seconds 

Total Time: 43.06800 seconds

1 boot records analyzed
-- Boot Record 01 --
     04.98000s (azure-ds/_report_ready)
     01.40200s (init-network/config-disk_setup)
     01.12900s (init-network/config-resizefs)
     01.11700s (modules-config/config-grub-dpkg)
     00.88800s (init-network/config-growpart)
     00.88000s (modules-config/config-ssh-import-id)
     00.32900s (init-network/config-users-groups)
     00.32700s (init-network/config-mounts)
     00.28600s (init-network/config-ssh)
     00.25900s (azure-ds/_has_ntfs_filesystem)
     00.11800s (modules-config/config-apt-configure)
     00.10300s (azure-ds/generate_certificate)
     00.10200s (modules-final/config-keys-to-console)
     00.06900s (azure-ds/list_possible_azure_ds_devs)
     00.06100s (modules-final/config-ssh-authkey-fingerprints)
     00.02000s (init-network/check-cache)
     00.01800s (init-network/consume-user-data)
     00.01200s (azure-ds/write_files)
     00.01200s (azure-ds/_get_metadata_from_imds)
     00.01000s (azure-ds/_decrypt_certs_from_xml)
     00.00900s (azure-ds/check-platform-viability)
     00.00500s (modules-final/config-final-message)
     00.00500s (init-network/config-set_hostname)
     00.00500s (azure-ds/_run_x509_action)
     00.00500s (azure-ds/_run_x509_action)
     00.00200s (modules-final/config-rightscale_userdata)
     00.00200s (modules-final/config-mcollective)
     00.00200s (modules-config/config-set-passwords)
     00.00200s (modules-config/config-locale)
     00.00200s (init-network/config-write-files)
     00.00200s (init-network/config-update_hostname)
     00.00200s (init-network/config-ca-certs)
     00.00100s (modules-final/config-ubuntu-drivers)
     00.00100s (modules-final/config-snappy)
     00.00100s (modules-final/config-scripts-vendor)
     00.00100s (modules-final/config-scripts-user)
     00.00100s (modules-final/config-scripts-per-once)
     00.00100s (modules-final/config-scripts-per-instance)
     00.00100s (modules-final/config-salt-minion)
     00.00100s (modules-final/config-puppet)
     00.00100s (modules-final/config-power-state-change)
     00.00100s (modules-final/config-phone-home)
     00.00100s (modules-final/config-package-update-upgrade-install)
     00.00100s (modules-final/config-lxd)
     00.00100s (modules-final/config-landscape)
     00.00100s (modules-final/config-fan)
     00.00100s (modules-final/config-chef)
     00.00100s (modules-config/config-ubuntu-advantage)
     00.00100s (modules-config/config-timezone)
     00.00100s (modules-config/config-snap_config)
     00.00100s (modules-config/config-snap)
     00.00100s (modules-config/config-runcmd)
     00.00100s (modules-config/config-ntp)
     00.00100s (modules-config/config-emit_upstart)
     00.00100s (modules-config/config-disable-ec2-metadata)
     00.00100s (modules-config/config-byobu)
     00.00100s (modules-config/config-apt-pipelining)
     00.00100s (init-network/consume-vendor-data)
     00.00100s (init-network/config-seed_random)
     00.00100s (init-network/config-rsyslog)
     00.00100s (init-network/config-migrator)
     00.00100s (init-local/check-cache)
     00.00100s (azure-ds/maybe_remove_ubuntu_network_config_scripts)
     00.00100s (azure-ds/count_files)
     00.00100s (azure-ds/_networkd_get_value_from_leases)
     00.00100s (azure-ds/_extract_preprovisioned_vm_setting)
     00.00000s (modules-final/config-scripts-per-boot)
     00.00000s (init-network/config-update_etc_hosts)
     00.00000s (init-network/config-bootcmd)
     00.00000s (azure-ds/wait-for-ephemeral-disk)
     00.00000s (azure-ds/temporary_hostname)
     00.00000s (azure-ds/parse_network_config)
     00.00000s (azure-ds/parse_network_config)
     00.00000s (azure-ds/load_azure_ovf_pubkeys)
     00.00000s (azure-ds/load_azure_ds_dir)
     00.00000s (azure-ds/_get_random_seed)

1 boot records analyzed
Networking config
# This file is generated from information provided by
# the datasource.  Changes to it will not persist across an instance.
# To disable cloud-init's network configuration capabilities, write a file
# /etc/cloud/cloud.cfg.d/99-disable-network-config.cfg with the following:
# network: {config: disabled}
network:
    ethernets:
        eth0:
            dhcp4: true
            match:
                macaddress: 00:0d:3a:04:ac:82
            set-name: eth0
    version: 2
  cloud-init
Get:1 http://archive.ubuntu.com/ubuntu disco-proposed/main amd64 cloud-init all 19.2-36-g059d049c-0ubuntu1~19.04.1 [401 kB]
Preparing to unpack .../cloud-init_19.2-36-g059d049c-0ubuntu1~19.04.1_all.deb ...
Unpacking cloud-init (19.2-36-g059d049c-0ubuntu1~19.04.1) over (19.1-1-gbaa47854-0ubuntu1~19.04.1) ...
Setting up cloud-init (19.2-36-g059d049c-0ubuntu1~19.04.1) ...
cloud-init	19.2-36-g059d049c-0ubuntu1~19.04.1
Connection to 52.177.126.208 closed by remote host.

status: done
time: Fri, 20 Sep 2019 08:05:20 +0000
detail:
DataSourceAzure [seed=/var/lib/waagent]
{
 "v1": {
  "datasource": "DataSourceAzure [seed=/var/lib/waagent]",
  "errors": []
 }
}
          2.301s cloud-init.service
          1.818s cloud-config.service
          1.681s cloud-init-local.service
          1.608s snap.lxd.activate.service
          1.408s lvm2-monitor.service
          1.392s dev-sda1.device
          1.361s snapd.service
          1.130s systemd-networkd-wait-online.service
          1.011s systemd-logind.service
           990ms systemd-udev-settle.service
           703ms cloud-final.service
           581ms accounts-daemon.service
           573ms systemd-timesyncd.service
           499ms rsyslog.service
           464ms ssh.service
           455ms grub-common.service
           433ms networkd-dispatcher.service
           415ms systemd-journald.service
           384ms systemd-user-sessions.service
           267ms systemd-resolved.service
           251ms apport.service
           233ms grub-initrd-fallback.service
           223ms systemd-networkd.service
           203ms systemd-udev-trigger.service
           192ms atd.service
           176ms systemd-remount-fs.service
           170ms systemd-modules-load.service
           168ms keyboard-setup.service
           154ms dev-loop0.device
           142ms dev-loop1.device
           135ms apparmor.service
           128ms dev-hugepages.mount
           128ms sys-kernel-debug.mount
           125ms kmod-static-nodes.service
           117ms dev-mqueue.mount
           109ms ufw.service
           108ms plymouth-quit-wait.service
            86ms sys-kernel-config.mount
            80ms console-setup.service
            78ms sys-fs-fuse-connections.mount
            73ms finalrd.service
            71ms snap-lxd-11684.mount
            68ms systemd-tmpfiles-setup.service
            67ms user@1000.service
            63ms systemd-sysctl.service
            53ms snap-core-7396.mount
            45ms systemd-random-seed.service
            43ms multipathd.service
            43ms systemd-journal-flush.service
            43ms blk-availability.service
            41ms systemd-update-utmp.service
            41ms systemd-sysusers.service
            40ms snapd.seeded.service
            39ms systemd-udevd.service
            37ms boot-efi.mount
            34ms systemd-fsck@dev-disk-cloud-azure_resource\x2dpart1.service
            33ms plymouth-quit.service
            18ms systemd-tmpfiles-setup-dev.service
            17ms systemd-update-utmp-runlevel.service
            16ms setvtrgb.service
            15ms user-runtime-dir@1000.service
            14ms plymouth-read-write.service
            13ms snapd.socket
            11ms ephemeral-disk-warning.service
-- Boot Record 01 --
The total time elapsed since completing an event is printed after the "@" character.
The time the event takes is printed after the "+" character.

Starting stage: init-local
|`->no cache found @00.00400s +00.00100s
Starting stage: init-local/search-Azure
Starting stage: azure-ds/_get_data
|`->found azure asset tag @00.04000s +00.01000s
|`->get_boot_telemetry @00.05000s +00.02000s
|`->get_system_info @00.07000s +00.00100s
Starting stage: azure-ds/crawl_metadata
|`->list_possible_azure_ds_devs @00.07200s +00.22700s
|`->load_azure_ds_dir @00.30000s +00.00000s
Starting stage: azure-ds/load_azure_ds_dir
Starting stage: azure-ds/read_azure_ovf
|`->load_azure_ovf_pubkeys @00.30300s +00.00100s
|`->_extract_preprovisioned_vm_setting @00.30400s +00.00000s
Finished stage: (azure-ds/read_azure_ovf) 00.00300 seconds 

Finished stage: (azure-ds/load_azure_ds_dir) 00.00500 seconds 

Starting stage: azure-ds/get_metadata_from_imds
|`->obtain dhcp lease @00.31800s +00.14200s
|`->_get_metadata_from_imds @00.46000s +00.00900s
Finished stage: (azure-ds/get_metadata_from_imds) 00.20700 seconds 

|`->_get_random_seed @00.52500s +00.00100s
Finished stage: (azure-ds/crawl_metadata) 00.46400 seconds 

|`->maybe_remove_ubuntu_network_config_scripts @00.53600s +00.00000s
|`->write_files @00.53700s +00.00200s
Finished stage: (azure-ds/_get_data) 00.50000 seconds 

Finished stage: (init-local/search-Azure) 00.50300 seconds 

|`->network config from imds @00.61200s +00.00000s
Finished stage: (init-local) 00.73900 seconds 

Starting stage: init-network
|`->restored from cache with run check: DataSourceAzure [seed=/var/lib/waagent] @02.56400s +00.02300s
|`->network config from imds @02.64000s +00.00000s
Starting stage: init-network/setup-datasource
Starting stage: azure-ds/setup
Starting stage: azure-ds/_negotiate
Starting stage: azure-ds/bounce_network_with_azure_hostname
|`->temporary_hostname @02.65100s +00.00000s
Finished stage: (azure-ds/bounce_network_with_azure_hostname) 00.00300 seconds 

Starting stage: azure-ds/get_metadata_from_fabric
Starting stage: azure-ds/register_with_azure_and_fetch_data
|`->generate_certificate @02.65600s +00.04000s
Starting stage: azure-ds/find_endpoint
|`->_networkd_get_value_from_leases @02.69600s +00.00100s
Finished stage: (azure-ds/find_endpoint) 00.00200 seconds 

Starting stage: azure-ds/parse_certificates
|`->_decrypt_certs_from_xml @02.72600s +00.00800s
Starting stage: azure-ds/_get_ssh_key_from_cert
|`->_run_x509_action @02.73500s +00.00500s
Finished stage: (azure-ds/_get_ssh_key_from_cert) 00.01200 seconds 

Starting stage: azure-ds/_get_fingerprint_from_cert
|`->_run_x509_action @02.74800s +00.00500s
Finished stage: (azure-ds/_get_fingerprint_from_cert) 00.00600 seconds 

Finished stage: (azure-ds/parse_certificates) 00.02700 seconds 

|`->_report_ready @02.75300s +00.00600s
Finished stage: (azure-ds/register_with_azure_and_fetch_data) 00.10500 seconds 

Finished stage: (azure-ds/get_metadata_from_fabric) 00.10600 seconds 

Finished stage: (azure-ds/_negotiate) 00.10900 seconds 

Finished stage: (azure-ds/setup) 00.11100 seconds 

Finished stage: (init-network/setup-datasource) 00.11100 seconds 

|`->reading and applying user-data @02.76800s +00.00600s
|`->reading and applying vendor-data @02.77500s +00.00000s
Starting stage: init-network/activate-datasource
Starting stage: azure-ds/activate
Starting stage: azure-ds/address_ephemeral_resize
|`->wait for ephemeral disk @02.80400s +00.00100s
Starting stage: azure-ds/can_dev_be_reformatted
|`->_has_ntfs_filesystem @02.80500s +00.18600s
Finished stage: (azure-ds/can_dev_be_reformatted) 00.18600 seconds 

Finished stage: (azure-ds/address_ephemeral_resize) 00.18800 seconds 

Finished stage: (azure-ds/activate) 00.18800 seconds 

Finished stage: (init-network/activate-datasource) 00.19000 seconds 

|`->config-migrator ran successfully @03.01300s +00.00100s
|`->config-seed_random ran successfully @03.01500s +00.00100s
|`->config-bootcmd ran successfully @03.01700s +00.00000s
|`->config-write-files ran successfully @03.01700s +00.00100s
|`->config-growpart ran successfully @03.01900s +00.05500s
|`->config-resizefs ran successfully @03.07400s +00.32700s
|`->config-disk_setup ran successfully @03.40100s +00.49600s
|`->config-mounts ran successfully @03.89800s +00.19700s
|`->config-set_hostname ran successfully @04.09500s +00.00700s
|`->config-update_hostname ran successfully @04.10200s +00.00200s
|`->config-update_etc_hosts ran successfully @04.10400s +00.00100s
|`->config-ca-certs ran successfully @04.10500s +00.00100s
|`->config-rsyslog ran successfully @04.10600s +00.00100s
|`->config-users-groups ran successfully @04.10800s +00.03400s
|`->config-ssh ran successfully @04.14300s +00.30200s
Finished stage: (init-network) 01.89500 seconds 

Starting stage: modules-config
|`->config-emit_upstart ran successfully @06.81300s +00.00100s
|`->config-snap ran successfully @06.81400s +00.00100s
|`->config-snap_config ran successfully @06.81600s +00.00100s
|`->config-ssh-import-id ran successfully @06.81700s +00.63500s
|`->config-locale ran successfully @07.45300s +00.00200s
|`->config-set-passwords ran successfully @07.45500s +00.00300s
|`->config-grub-dpkg ran successfully @07.45900s +00.55500s
|`->config-apt-pipelining ran successfully @08.01500s +00.00200s
|`->config-apt-configure ran successfully @08.01700s +00.11700s
|`->config-ubuntu-advantage ran successfully @08.13500s +00.00100s
|`->config-ntp ran successfully @08.13700s +00.00100s
|`->config-timezone ran successfully @08.13800s +00.00100s
|`->config-disable-ec2-metadata ran successfully @08.14000s +00.00000s
|`->config-runcmd ran successfully @08.14000s +00.00100s
|`->config-byobu ran successfully @08.14200s +00.00100s
Finished stage: (modules-config) 01.34800 seconds 

Starting stage: modules-final
|`->config-snappy ran successfully @08.68400s +00.00200s
|`->config-package-update-upgrade-install ran successfully @08.68600s +00.00100s
|`->config-fan ran successfully @08.68800s +00.00100s
|`->config-landscape ran successfully @08.68900s +00.00100s
|`->config-lxd ran successfully @08.69100s +00.00100s
|`->config-ubuntu-drivers ran successfully @08.69200s +00.00100s
|`->config-puppet ran successfully @08.69300s +00.00100s
|`->config-chef ran successfully @08.69500s +00.00100s
|`->config-mcollective ran successfully @08.69600s +00.00100s
|`->config-salt-minion ran successfully @08.69800s +00.00100s
|`->config-rightscale_userdata ran successfully @08.69900s +00.00100s
|`->config-scripts-vendor ran successfully @08.70100s +00.00100s
|`->config-scripts-per-once ran successfully @08.70200s +00.00100s
|`->config-scripts-per-boot ran successfully @08.70400s +00.00000s
|`->config-scripts-per-instance ran successfully @08.70500s +00.00100s
|`->config-scripts-user ran successfully @08.70600s +00.00100s
|`->config-ssh-authkey-fingerprints ran successfully @08.70700s +00.06200s
|`->config-keys-to-console ran successfully @08.76900s +00.10000s
|`->config-phone-home ran successfully @08.87000s +00.00100s
|`->config-final-message ran successfully @08.87200s +00.00400s
|`->config-power-state-change ran successfully @08.87700s +00.00100s
Finished stage: (modules-final) 00.21200 seconds 

Total Time: 7.22000 seconds

1 boot records analyzed
-- Boot Record 01 --
     00.63500s (modules-config/config-ssh-import-id)
     00.55500s (modules-config/config-grub-dpkg)
     00.49600s (init-network/config-disk_setup)
     00.32700s (init-network/config-resizefs)
     00.30200s (init-network/config-ssh)
     00.22700s (azure-ds/list_possible_azure_ds_devs)
     00.19700s (init-network/config-mounts)
     00.18600s (azure-ds/_has_ntfs_filesystem)
     00.14200s (azure-ds/obtain-dhcp-lease)
     00.11700s (modules-config/config-apt-configure)
     00.10000s (modules-final/config-keys-to-console)
     00.06200s (modules-final/config-ssh-authkey-fingerprints)
     00.05500s (init-network/config-growpart)
     00.04000s (azure-ds/generate_certificate)
     00.03400s (init-network/config-users-groups)
     00.02300s (init-network/check-cache)
     00.02000s (azure-ds/get_boot_telemetry)
     00.01000s (azure-ds/check-platform-viability)
     00.00900s (azure-ds/_get_metadata_from_imds)
     00.00800s (azure-ds/_decrypt_certs_from_xml)
     00.00700s (init-network/config-set_hostname)
     00.00600s (init-network/consume-user-data)
     00.00600s (azure-ds/_report_ready)
     00.00500s (azure-ds/_run_x509_action)
     00.00500s (azure-ds/_run_x509_action)
     00.00400s (modules-final/config-final-message)
     00.00300s (modules-config/config-set-passwords)
     00.00200s (modules-final/config-snappy)
     00.00200s (modules-config/config-locale)
     00.00200s (modules-config/config-apt-pipelining)
     00.00200s (init-network/config-update_hostname)
     00.00200s (azure-ds/write_files)
     00.00100s (modules-final/config-ubuntu-drivers)
     00.00100s (modules-final/config-scripts-vendor)
     00.00100s (modules-final/config-scripts-user)
     00.00100s (modules-final/config-scripts-per-once)
     00.00100s (modules-final/config-scripts-per-instance)
     00.00100s (modules-final/config-salt-minion)
     00.00100s (modules-final/config-rightscale_userdata)
     00.00100s (modules-final/config-puppet)
     00.00100s (modules-final/config-power-state-change)
     00.00100s (modules-final/config-phone-home)
     00.00100s (modules-final/config-package-update-upgrade-install)
     00.00100s (modules-final/config-mcollective)
     00.00100s (modules-final/config-lxd)
     00.00100s (modules-final/config-landscape)
     00.00100s (modules-final/config-fan)
     00.00100s (modules-final/config-chef)
     00.00100s (modules-config/config-ubuntu-advantage)
     00.00100s (modules-config/config-timezone)
     00.00100s (modules-config/config-snap_config)
     00.00100s (modules-config/config-snap)
     00.00100s (modules-config/config-runcmd)
     00.00100s (modules-config/config-ntp)
     00.00100s (modules-config/config-emit_upstart)
     00.00100s (modules-config/config-byobu)
     00.00100s (init-network/config-write-files)
     00.00100s (init-network/config-update_etc_hosts)
     00.00100s (init-network/config-seed_random)
     00.00100s (init-network/config-rsyslog)
     00.00100s (init-network/config-migrator)
     00.00100s (init-network/config-ca-certs)
     00.00100s (init-local/check-cache)
     00.00100s (azure-ds/wait-for-ephemeral-disk)
     00.00100s (azure-ds/load_azure_ovf_pubkeys)
     00.00100s (azure-ds/get_system_info)
     00.00100s (azure-ds/_networkd_get_value_from_leases)
     00.00100s (azure-ds/_get_random_seed)
     00.00000s (modules-final/config-scripts-per-boot)
     00.00000s (modules-config/config-disable-ec2-metadata)
     00.00000s (init-network/consume-vendor-data)
     00.00000s (init-network/config-bootcmd)
     00.00000s (azure-ds/temporary_hostname)
     00.00000s (azure-ds/parse_network_config)
     00.00000s (azure-ds/parse_network_config)
     00.00000s (azure-ds/maybe_remove_ubuntu_network_config_scripts)
     00.00000s (azure-ds/load_azure_ds_dir)
     00.00000s (azure-ds/_extract_preprovisioned_vm_setting)

1 boot records analyzed
After upgrade Networking config
# This file is generated from information provided by
# the datasource.  Changes to it will not persist across an instance.
# To disable cloud-init's network configuration capabilities, write a file
# /etc/cloud/cloud.cfg.d/99-disable-network-config.cfg with the following:
# network: {config: disabled}
network:
    ethernets:
        eth0:
            dhcp4: true
            dhcp4-overrides:
                route-metric: 100
            match:
                macaddress: 00:0d:3a:04:ac:82
            set-name: eth0
    version: 2
cloud-region: azure-eastus2
Get cloud-id
azure
cloud-region: azure-eastus2
Validating whether metadata is being updated per boot LP:1819913
2019-09-20 08:05:11,839 - __init__.py[DEBUG]: Update datasource metadata and network config due to events: New instance first boot
Connection to 52.177.126.208 closed by remote host.
After reboot
2019-09-20 07:59:09,184 - __init__.py[DEBUG]: Update datasource metadata and network config due to events: New instance first boot
2019-09-20 08:00:20,541 - __init__.py[DEBUG]: Update datasource metadata and network config due to events: New instance first boot
2019-09-20 08:00:20,961 - __init__.py[DEBUG]: Update datasource metadata and network config due to events: System boot
### END disco





=== END SRU Validation ===
